"use strict";(self.webpackChunkemporium=self.webpackChunkemporium||[]).push([[417],{8417:(X,w,s)=>{s.r(w),s.d(w,{PaymentsModule:()=>O,routes:()=>$});var u=s(6895),l=s(2340),F=s(5783),f=s(8910),N=s(2887),v=s(4459),e=s(4650),_=s(1182),p=s(5412),D=s(9132),E=s(7465),I=s(5298),R=s(8959),b=s(3081),M=s(7009),T=s(4333),g=s(1576),P=s(4859),q=s(811),y=s(3546),J=s(7392),B=s(4850),H=s(1572),j=s(266);function z(a,t){if(1&a){const i=e.EpF();e.TgZ(0,"mat-button-toggle",17),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.gotoNewDocument())}),e.TgZ(1,"mat-icon"),e._uU(2,"note_add"),e.qZA()()}}const ee=function(a){return["/payments/receivable-add/",a]};function te(a,t){if(1&a&&(e.TgZ(0,"a",23),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA()()),2&a){const i=e.oxw().$implicit;e.s9C("matTooltip",e.lcZ(1,2,"BTN.EDIT")),e.Q6J("routerLink",e.VKq(4,ee,i.id))}}function ie(a,t){if(1&a){const i=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit,r=e.oxw();return e.KtG(r.removeDocument(n.id))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()}2&a&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.REMOVE"))}function ae(a,t){if(1&a&&(e.TgZ(0,"div",18)(1,"div",19),e._uU(2),e.qZA(),e.TgZ(3,"div",19),e._uU(4),e.qZA(),e.TgZ(5,"div",19),e._uU(6),e.qZA(),e.TgZ(7,"div",19),e._uU(8),e.qZA(),e.TgZ(9,"div",19),e._uU(10),e.qZA(),e.TgZ(11,"div",19),e._uU(12),e.qZA(),e.TgZ(13,"div",19),e._uU(14),e.qZA(),e.TgZ(15,"div",19),e._uU(16),e.qZA(),e.TgZ(17,"div",19)(18,"div",20),e.YNc(19,te,4,6,"a",21),e.YNc(20,ie,4,3,"button",22),e.qZA()()()),2&a){const i=t.$implicit,o=e.oxw();e.xp6(2),e.Oqu(i.branch_ArbName),e.xp6(2),e.Oqu(i.build_Name),e.xp6(2),e.Oqu(i.unit_UnitNumber),e.xp6(2),e.hij(" ",i.customer_Name," "),e.xp6(2),e.hij(" ",i.PDODocDate," "),e.xp6(2),e.hij(" ",i.PDOValue," "),e.xp6(2),e.hij(" ",i.PDOPrintedCode," "),e.xp6(2),e.hij(" ",i.contract_EjarCode," "),e.xp6(3),e.Q6J("ngIf",o.can("view_onereceivable")),e.xp6(1),e.Q6J("ngIf",o.can("delete_onereceivable"))}}function oe(a,t){if(1&a){const i=e.EpF();e.TgZ(0,"div",25)(1,"div",26)(2,"mat-card",27)(3,"pagination-controls",28),e.NdJ("pageChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onPageChanged(n))}),e.qZA()()()()}}function ne(a,t){1&a&&(e.TgZ(0,"div",29),e._UZ(1,"mat-spinner",30),e.qZA())}const se=function(a,t){return{itemsPerPage:a,currentPage:t}};class C{constructor(t,i,o,n,r,d,m,h,U){this.appSettings=t,this.dialog=i,this.paymentService=o,this.router=n,this.global=r,this.localStore=d,this.contractService=m,this.translateService=h,this.snackBar=U,this.curCOMId=l.N.comid,this.account=new F.n,this.count=4,this.userPerm=[],this.settings=this.appSettings.settings}ngOnInit(){if(this.securityForApp=(new v.$).getSecurityType(),this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.prepareMsgLanguage(),this.getDocuments()}else this.router.navigate(["/sign-in"])}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getDocuments(){this.documentsAll=null,this.curUserData.is_superuser?this.paymentService.getAllReceivableDocuments(this.curCOMId,this.account.periorty).subscribe(t=>this.documentsAll=t):1==this.curUserData.periorty&&("N"==this.securityForApp&&this.paymentService.getAllReceivableDocumentsPerBranch(this.curCOMId,this.account.periorty,this.curUserData.branch_KeyField).subscribe(t=>this.documentsAll=t),"D"==this.securityForApp&&this.paymentService.getAllReceivableDocumentsPerEmp(this.curCOMId,this.account.periorty,this.curUserData.id).subscribe(t=>this.documentsAll=t))}removeDocument(t){this.dialog.open(N.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(o=>{o&&(this.paymentService.getOneDocs(t).subscribe(n=>{null!=n.installment_KeyField&&(this.oneDocValue=n.PDOValue,this.contractService.getOneInstallment(n.installment_KeyField).subscribe(r=>{this.curInstallmentValue=r.INSValue,this.curInstallmentPayedValue=r.INSPayedValue,null==this.curInstallmentValue&&(this.curInstallmentValue=0),null==this.curInstallmentPayedValue&&(this.curInstallmentPayedValue=0),this.manageInstallmetPayedValue(n.installment_KeyField,this.curInstallmentValue,this.curInstallmentPayedValue,this.oneDocValue)}))}),this.paymentService.deleteDocument(t).subscribe(n=>this.getDocuments()))})}manageInstallmetPayedValue(t,i,o,n){null==o&&(o=0),null==n&&(n=0),null==i&&(i=0);let r=+o-+n;r<=0&&(r=0),this.insStatus=0==r?"N":"T";let d={id:t,INSStatus:this.insStatus,INSPayedValue:r};console.log("===installData:: "+d),this.contractService.editInstallments(d).subscribe(m=>{console.log("==installment after Update:: "+m)},m=>{console.log(m)})}onPageChanged(t){this.page=t,this.getDocuments(),window.scrollTo(0,0)}gotoNewDocument(){this.router.navigate(["/payments/receivable-add/"])}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(t=>{this.errorRetrieveMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(t=>{this.deletedTitleMsg=t})}}C.\u0275fac=function(t){return new(t||C)(e.Y36(_.d),e.Y36(p.uw),e.Y36(f.c),e.Y36(D.F0),e.Y36(E.U),e.Y36(I.C),e.Y36(R.W),e.Y36(b.sK),e.Y36(M.ux))},C.\u0275cmp=e.Xpm({type:C,selectors:[["app-receivable-doc-list"]],features:[e._Bn([f.c])],decls:60,vars:37,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","list"],["viewType","matButtonToggleGroup"],["value","list"],["value","grid"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],["value","add",3,"click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip",4,"ngIf"],["mat-mini-fab","","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100",1,"p-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-button-toggle-group",2,3),e.YNc(4,z,3,0,"mat-button-toggle",4),e.qZA()(),e.TgZ(5,"div",5)(6,"mat-button-toggle-group",6,7)(8,"mat-button-toggle",8)(9,"mat-icon"),e._uU(10,"view_list"),e.qZA()(),e.TgZ(11,"mat-button-toggle",9)(12,"mat-icon"),e._uU(13,"view_module"),e.qZA()()()()(),e._UZ(14,"mat-divider"),e.TgZ(15,"mat-card")(16,"div",10)(17,"h2"),e._uU(18),e.ALo(19,"translate"),e.qZA()(),e._UZ(20,"mat-divider"),e.TgZ(21,"div",11)(22,"div",12)(23,"div",13)(24,"h2"),e._uU(25),e.ALo(26,"translate"),e.qZA()(),e.TgZ(27,"div",13)(28,"h2"),e._uU(29),e.ALo(30,"translate"),e.qZA()(),e.TgZ(31,"div",13)(32,"h2"),e._uU(33),e.ALo(34,"translate"),e.qZA()(),e.TgZ(35,"div",13)(36,"h2"),e._uU(37),e.ALo(38,"translate"),e.qZA()(),e.TgZ(39,"div",13)(40,"h2"),e._uU(41),e.ALo(42,"translate"),e.qZA()(),e.TgZ(43,"div",13)(44,"h2"),e._uU(45),e.ALo(46,"translate"),e.qZA()(),e.TgZ(47,"div",13)(48,"h2"),e._uU(49),e.ALo(50,"translate"),e.qZA()(),e.TgZ(51,"div",13)(52,"h2"),e._uU(53),e.ALo(54,"translate"),e.qZA()(),e._UZ(55,"div",13),e.qZA(),e.YNc(56,ae,21,10,"div",14),e.ALo(57,"paginate"),e.qZA()(),e.YNc(58,oe,4,0,"div",15),e.YNc(59,ne,2,0,"div",16)),2&t&&(e.xp6(4),e.Q6J("ngIf",i.can("add_onereceivable")),e.xp6(14),e.Oqu(e.lcZ(19,13,"HTML.ReceivableDoc_List")),e.xp6(7),e.hij(" ",e.lcZ(26,15,"HTML.BRANCH")," "),e.xp6(4),e.hij(" ",e.lcZ(30,17,"HTML.BUILDING")," "),e.xp6(4),e.hij(" ",e.lcZ(34,19,"HTML.UnitNumber")," "),e.xp6(4),e.hij(" ",e.lcZ(38,21,"HTML.TENANT")," "),e.xp6(4),e.hij(" ",e.lcZ(42,23,"HTML.DocDate")," "),e.xp6(4),e.hij(" ",e.lcZ(46,25,"HTML.DocValue")," "),e.xp6(4),e.hij(" ",e.lcZ(50,27,"HTML.DocPrintedNo")," "),e.xp6(4),e.hij(" ",e.lcZ(54,29,"HTML.ContractEjarCode")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(57,31,i.documentsAll,e.WLB(34,se,i.count,i.page))),e.xp6(2),e.Q6J("ngIf",i.documentsAll),e.xp6(1),e.Q6J("ngIf",!i.documentsAll))},dependencies:[T.LS,u.sg,u.O5,D.rH,g.xw,g.Wh,g.yH,P.Tq,P.nh,q.A9,q.Yi,y.a8,J.Hw,B.d,H.Ou,j.gM,T._s,b.X$],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}\n"],encapsulation:2});class Q{}var k=s(6381),G=s(5726),c=s(4006),x=s(9602),W=s(4144),Z=s(9549),L=s(8796);function le(a,t){1&a&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.ADD")))}function re(a,t){1&a&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function ce(a,t){if(1&a&&(e.TgZ(0,"ng-option",25),e._uU(1),e.qZA()),2&a){const i=t.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.CUSName,"")}}function ue(a,t){if(1&a&&(e.TgZ(0,"div",26)(1,"button",27),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&a){const i=e.oxw();e.xp6(1),e.Q6J("disabled",!i.docData_Form.valid),e.xp6(1),e.Oqu(e.lcZ(3,2,"BTN.SAVE"))}}class A{constructor(t,i,o,n,r,d,m,h,U,V,Y,Ze){this.activatedRoute=t,this.localStore=i,this._companyService=o,this.global=n,this.router=r,this.snackBar=d,this.docsService=m,this.tenantsService=h,this.contractService=U,this.translateService=V,this.fb=Y,this._formBuilder=Ze,this.curCOMId=l.N.comid,this.account=new F.n,this.userPerm=[],this.curDocValue=0,this.curDocPayedValue=0,this.AllNotPayedInstallments=[],this.AllTenants=[]}ngOnInit(){if(this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.getTenants(),this.sub=this.activatedRoute.params.subscribe(t=>{t.id?(this.id=+t.id,this.getDocById(this.id)):this.payDocForDisplay=new Q}),this.docData_Form=this.fb.group({id:null,PDOCode:null,PDOValue:{value:null,disabled:this.id},PDODocDate:null,PDODocType:"R",PDODocClassType:"A",PDOPrintedCode:null,PDODocSecondPerson:null,PDONotes:null,contract_KeyField:null,branch_KeyField:null,owner_KeyField:null,build_KeyField:null,unit_KeyField:null,installment_KeyField:null,customer_KeyField:null})}else this.router.navigate(["/sign-in"])}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getDocById(t){this.docsService.getOneDocs(t).subscribe(i=>{this.fillForm(i),this.payDocForDisplay=i})}fillForm(t){null!=t.PDODocDate&&(this.s_docDate=t.PDODocDate),this.docData_Form.patchValue({id:t.id,contract_KeyField:t.contract_KeyField,branch_KeyField:t.branch_KeyField,owner_KeyField:t.owner_KeyField,build_KeyField:t.build_KeyField,unit_KeyField:t.unit_KeyField,installment_KeyField:t.installment_KeyField,customer_KeyField:t.customer_KeyField,PDOCode:t.PDOCode,PDOValue:t.PDOValue,PDODocType:t.PDODocType,PDODocDate:t.PDODocDate,PDODocClassType:t.PDODocClassType,PDOPrintedCode:t.PDOPrintedCode,PDODocSecondPerson:t.PDODocSecondPerson,PDONotes:t.PDONotes})}readCustumer(t){console.log("====Selected readCustumer:: "+t),this.tenantsService.getOneCustomer(t).subscribe(i=>{console.log("==tenantName:: "+i.CUSName),this.docData_Form.patchValue({contract_KeyField:i.current_contract,PDODocSecondPerson:i.CUSName})}),this.getCustomerInstallmentsNotPayed(this.curCOMId,this.account.periorty,t)}getCustomerInstallmentsNotPayed(t,i,o){this.contractService.getInstallmentsPerCustomer_Payed(t,i,o,"F").subscribe(n=>{this.AllNotPayedInstallments=n,this.curOwnerId=n[0].owner_KeyField,this.curContract=n[0].contract_KeyField,this.curBranch=n[0].branch_KeyField,this.curBuild=n[0].build_KeyField,this.curUnit=n[0].unit_KeyField,this.curInstallment=n[0].id,this.curDocValue=n[0].INSValue,this.curDocPayedValue=n[0].INSPayedValue,null==this.curDocValue&&(this.curDocValue=0),null==this.curDocPayedValue&&(this.curDocPayedValue=0),this.docData_Form.patchValue({contract_KeyField:this.curContract,branch_KeyField:this.curBranch,build_KeyField:this.curBuild,unit_KeyField:this.curUnit,owner_KeyField:this.curOwnerId,installment_KeyField:this.curInstallment,PDOValue:this.curDocValue-this.curDocPayedValue})},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0623\u0642\u0633\u0627\u0637","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getTenants(){this.AllTenants=null,this.tenantsService.getCustomers(this.curCOMId,this.account.periorty).subscribe(t=>{this.AllTenants=t})}mappingFormValue_ToPayDocClass(){const t=new u.uU("en-GB").transform(this.docData_Form.value.PDODocDate,"dd/MM/yyyy");this.payDocForDisplay.id=this.docData_Form.value.id,this.payDocForDisplay.contract_KeyField=this.docData_Form.value.contract_KeyField,this.payDocForDisplay.branch_KeyField=this.docData_Form.value.branch_KeyField,this.payDocForDisplay.owner_KeyField=this.docData_Form.value.owner_KeyField,this.payDocForDisplay.build_KeyField=this.docData_Form.value.build_KeyField,this.payDocForDisplay.unit_KeyField=this.docData_Form.value.unit_KeyField,this.payDocForDisplay.installment_KeyField=this.docData_Form.value.installment_KeyField,this.payDocForDisplay.customer_KeyField=this.docData_Form.value.customer_KeyField,null!=this.docData_Form.value.PDODocDate&&(this.payDocForDisplay.PDODocDate=t),this.payDocForDisplay.PDOCode=this.docData_Form.value.PDOCode,this.payDocForDisplay.PDOValue=this.docData_Form.value.PDOValue,this.payDocForDisplay.PDODocType=this.docData_Form.value.PDODocType,this.payDocForDisplay.PDODocClassType=this.docData_Form.value.PDODocClassType,this.payDocForDisplay.PDOPrintedCode=this.docData_Form.value.PDOPrintedCode,this.payDocForDisplay.PDODocSecondPerson=this.docData_Form.value.PDODocSecondPerson,this.payDocForDisplay.PDONotes=this.docData_Form.value.PDONotes}manageInstallmetPayedValue(t,i,o,n,r){null==o&&(o=0),null==n&&(n=0),null==i&&(i=0);let d=+o+ +n;this.insStatus=d<i?"T":"P";let m={id:t,INSStatus:this.insStatus,INSPayedValue:d,INSPayDate:r,INSPersonPayName:this.payDocForDisplay.PDODocSecondPerson};console.log("===installData:: "+m),this.contractService.editInstallments(m).subscribe(h=>{console.log("==installment after Update:: "+h)},h=>{console.log(h)})}saveEditDocData(t){const i=new u.uU("en-GB").transform(this.docData_Form.value.PDODocDate,"dd/MM/yyyy");this.mappingFormValue_ToPayDocClass(),t?this.docsService.editDoc(this.payDocForDisplay).subscribe(o=>{let n={contract_KeyField:o.contract_KeyField,branch_KeyField:o.branch_KeyField,owner_KeyField:o.owner_KeyField,build_KeyField:o.build_KeyField,unit_KeyField:o.unit_KeyField,installment_KeyField:o.installment_KeyField,customer_KeyField:o.customer_KeyField,TSTCreditValue:o.PDOValue,TSTDebitValue:0,TSTDate:o.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0642\u0628\u0636 \u0631\u0642\u0645 "+o.PDOCode,TSTSubject:"RECEIVABLE",TSTSubjectID:o.ID};this.contractService.deleteStatementForSubjectID(this.curCOMId,this.account.periorty,"RECEIVABLE",o.id).subscribe(r=>{this.contractService.addStatement(n).subscribe(d=>{})}),this.snackBar.open("\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/receivable-list"])},o=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}):this.docsService.addDoc(this.payDocForDisplay).subscribe(o=>{this.contractService.addStatement({contract_KeyField:o.contract_KeyField,branch_KeyField:o.branch_KeyField,owner_KeyField:o.owner_KeyField,build_KeyField:o.build_KeyField,unit_KeyField:o.unit_KeyField,installment_KeyField:o.installment_KeyField,customer_KeyField:o.customer_KeyField,TSTCreditValue:o.PDOValue,TSTDebitValue:0,TSTDate:o.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0642\u0628\u0636 \u0631\u0642\u0645 "+o.PDOCode,TSTSubject:"RECEIVABLE",TSTSubjectID:o.ID}).subscribe(r=>{}),this.manageInstallmetPayedValue(this.curInstallment,this.curDocValue,this.curDocPayedValue,this.payDocForDisplay.PDOValue,i),this.snackBar.open("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/receivable-list"])},o=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u0627\u0636\u0627\u0641\u0647 \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(t=>{this.errorRetrieveMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t})}}A.\u0275fac=function(t){return new(t||A)(e.Y36(D.gz),e.Y36(I.C),e.Y36(k.J),e.Y36(E.U),e.Y36(D.F0),e.Y36(M.ux),e.Y36(f.c),e.Y36(G.v),e.Y36(R.W),e.Y36(b.sK),e.Y36(c.qu),e.Y36(c.qu))},A.\u0275cmp=e.Xpm({type:A,selectors:[["app-receivable-doc-dialog"]],decls:62,vars:35,consts:[[1,"p-2"],[4,"ngIf"],[1,"pt-3"],["autocomplete","off","fxLayout","row wrap",3,"formGroup","ngSubmit"],["fxFlex","100","fxFlex.gt-sm","40",1,"px-2"],["width","400","height","300","id","campanyLogo",3,"src"],["fxFlex","100","fxFlex.gt-sm","60",1,"px-2"],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-sm","25",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","PDOCode"],["fxFlex","100","fxFlex.gt-sm","75",1,"px-1"],["appearance","outline","formControlName","customer_KeyField",1,"w-100",3,"placeholder","change"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","PDODocDate","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["pdoDocDate",""],["fxFlex","100","fxFlex.gt-sm","50",1,"px-1"],["matInput","","formControlName","PDOValue","required",""],["matInput","","formControlName","PDOPrintedCode"],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","PDODocSecondPerson","required",""],["fxFlex","100",1,"px-1"],["matInput","","formControlName","PDONotes","rows","3"],["fxFlex","100","class","mt-2 text-center w-100",4,"ngIf"],[3,"value"],["fxFlex","100",1,"mt-2","text-center","w-100"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"h1"),e.YNc(5,le,3,3,"span",1),e.YNc(6,re,3,3,"span",1),e._uU(7),e.ALo(8,"translate"),e.qZA()()(),e.TgZ(9,"mat-card-content",2)(10,"form",3),e.NdJ("ngSubmit",function(){return i.saveEditDocData(i.payDocForDisplay.id)}),e.TgZ(11,"div",4),e._UZ(12,"img",5),e.qZA(),e.TgZ(13,"div",6)(14,"div",7)(15,"div",8)(16,"mat-form-field",9)(17,"mat-label"),e._uU(18),e.ALo(19,"translate"),e.qZA(),e._UZ(20,"input",10),e.qZA()(),e.TgZ(21,"div",11)(22,"label"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"ng-select",12),e.NdJ("change",function(n){return i.readCustumer(n)}),e.ALo(26,"translate"),e.YNc(27,ce,2,2,"ng-option",13),e.qZA()(),e.TgZ(28,"div",8)(29,"mat-form-field",9)(30,"mat-label"),e._uU(31),e.ALo(32,"translate"),e.qZA(),e._UZ(33,"input",14)(34,"mat-datepicker-toggle",15)(35,"mat-datepicker",null,16),e.qZA()(),e.TgZ(37,"div",17)(38,"mat-form-field",9)(39,"mat-label"),e._uU(40),e.ALo(41,"translate"),e.qZA(),e._UZ(42,"input",18),e.qZA()(),e.TgZ(43,"div",8)(44,"mat-form-field",9)(45,"mat-label"),e._uU(46),e.ALo(47,"translate"),e.qZA(),e._UZ(48,"input",19),e.qZA()(),e.TgZ(49,"div",20)(50,"mat-form-field",9)(51,"mat-label"),e._uU(52),e.ALo(53,"translate"),e.qZA(),e._UZ(54,"input",21),e.qZA()(),e.TgZ(55,"div",22)(56,"mat-form-field",9)(57,"mat-label"),e._uU(58),e.ALo(59,"translate"),e.qZA(),e._UZ(60,"textarea",23),e.qZA()(),e.YNc(61,ue,4,4,"div",24),e.qZA()()()()()()),2&t){const o=e.MAs(36);e.xp6(5),e.Q6J("ngIf",!i.payDocForDisplay.id),e.xp6(1),e.Q6J("ngIf",i.payDocForDisplay.id),e.xp6(1),e.hij(" ",e.lcZ(8,17,"HTML.ReceivableDoc"),""),e.xp6(3),e.Q6J("formGroup",i.docData_Form),e.xp6(2),e.Q6J("src","assets/images/paymentDocs/receivable.png",e.LSH),e.xp6(6),e.Oqu(e.lcZ(19,19,"HTML.CODE")),e.xp6(5),e.hij(" ",e.lcZ(24,21,"HTML.TENANT"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(26,23,"HTML.TENANT")),e.xp6(2),e.Q6J("ngForOf",i.AllTenants),e.xp6(4),e.Oqu(e.lcZ(32,25,"HTML.DocDate")),e.xp6(2),e.Q6J("matDatepicker",o),e.xp6(1),e.Q6J("for",o),e.xp6(6),e.Oqu(e.lcZ(41,27,"HTML.DocValue")),e.xp6(6),e.Oqu(e.lcZ(47,29,"HTML.DocPrintedNo")),e.xp6(6),e.Oqu(e.lcZ(53,31,"HTML.DocSecondPart_ReceivableDoc")),e.xp6(6),e.Oqu(e.lcZ(59,33,"HTML.Notes")),e.xp6(3),e.Q6J("ngIf",i.can("change_onereceivable"))}},dependencies:[c._Y,c.Fj,c.JJ,c.JL,c.Q7,u.sg,u.O5,c.sg,c.u,g.xw,g.yH,P.lW,y.a8,y.dn,y.dk,y.n5,x.Mq,x.hl,x.nW,W.Nt,Z.KE,Z.hX,Z.R9,L.w9,L.jq,b.X$]});var de=s(529),me=s(589),pe=s(9045);function De(a,t){if(1&a){const i=e.EpF();e.TgZ(0,"mat-button-toggle",17),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.gotoNewDocument())}),e.TgZ(1,"mat-icon"),e._uU(2,"note_add"),e.qZA()()}}const he=function(a){return["/payments/payable-add/",a]};function ge(a,t){if(1&a&&(e.TgZ(0,"a",23),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA()()),2&a){const i=e.oxw().$implicit;e.s9C("matTooltip",e.lcZ(1,2,"BTN.EDIT")),e.Q6J("routerLink",e.VKq(4,he,i.id))}}function ye(a,t){if(1&a){const i=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit,r=e.oxw();return e.KtG(r.removeDocument(n.id))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()}2&a&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.REMOVE"))}function _e(a,t){if(1&a&&(e.TgZ(0,"div",18)(1,"div",19),e._uU(2),e.qZA(),e.TgZ(3,"div",19),e._uU(4),e.qZA(),e.TgZ(5,"div",19),e._uU(6),e.qZA(),e.TgZ(7,"div",19),e._uU(8),e.qZA(),e.TgZ(9,"div",19)(10,"div",20),e.YNc(11,ge,4,6,"a",21),e.YNc(12,ye,4,3,"button",22),e.qZA()()()),2&a){const i=t.$implicit,o=e.oxw();e.xp6(2),e.hij(" ",i.customer_Name," "),e.xp6(2),e.hij(" ",i.PDODocDate," "),e.xp6(2),e.hij(" ",i.PDOValue," "),e.xp6(2),e.hij(" ",i.PDOPrintedCode," "),e.xp6(3),e.Q6J("ngIf",o.can("view_onepayable")),e.xp6(1),e.Q6J("ngIf",o.can("delete_onepayable"))}}function fe(a,t){if(1&a){const i=e.EpF();e.TgZ(0,"div",25)(1,"div",26)(2,"mat-card",27)(3,"pagination-controls",28),e.NdJ("pageChange",function(n){e.CHM(i);const r=e.oxw();return e.KtG(r.onPageChanged(n))}),e.qZA()()()()}}function ve(a,t){1&a&&(e.TgZ(0,"div",29),e._UZ(1,"mat-spinner",30),e.qZA())}const be=function(a,t){return{itemsPerPage:a,currentPage:t}};class K{constructor(t,i,o,n,r,d,m,h){this.appSettings=t,this.dialog=i,this.paymentService=o,this.router=n,this.global=r,this.localStore=d,this.translateService=m,this.snackBar=h,this.curCOMId=l.N.comid,this.account=new F.n,this.count=4,this.userPerm=[],this.settings=this.appSettings.settings}ngOnInit(){if(this.securityForApp=(new v.$).getSecurityType(),this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.prepareMsgLanguage(),this.getDocuments()}else this.router.navigate(["/sign-in"])}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getDocuments(){this.documentsAll=null,this.curUserData.is_superuser?this.paymentService.getAllPayableDocuments(this.curCOMId,this.account.periorty).subscribe(t=>this.documentsAll=t):1==this.curUserData.periorty&&("N"==this.securityForApp&&this.paymentService.getAllPayableDocumentsPerBranch(this.curCOMId,this.account.periorty,this.curUserData.branch_KeyField).subscribe(t=>this.documentsAll=t),"D"==this.securityForApp&&this.paymentService.getAllPayableDocumentsPerEmp(this.curCOMId,this.account.periorty,this.curUserData.id).subscribe(t=>this.documentsAll=t))}removeDocument(t){this.dialog.open(N.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(o=>{o&&this.paymentService.deleteDocument(t).subscribe(n=>this.getDocuments())})}onPageChanged(t){this.page=t,this.getDocuments(),window.scrollTo(0,0)}gotoNewDocument(){this.router.navigate(["/payments/payable-add/"])}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(t=>{this.errorRetrieveMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(t=>{this.deletedTitleMsg=t})}}function Fe(a,t){1&a&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.ADD")))}function Te(a,t){1&a&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function Pe(a,t){if(1&a&&(e.TgZ(0,"ng-option",25),e._uU(1),e.qZA()),2&a){const i=t.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.CUSName,"")}}function xe(a,t){if(1&a&&(e.TgZ(0,"div",26)(1,"button",27),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&a){const i=e.oxw();e.xp6(1),e.Q6J("disabled",!i.docData_Form.valid),e.xp6(1),e.Oqu(e.lcZ(3,2,"BTN.SAVE"))}}K.\u0275fac=function(t){return new(t||K)(e.Y36(_.d),e.Y36(p.uw),e.Y36(f.c),e.Y36(D.F0),e.Y36(E.U),e.Y36(I.C),e.Y36(b.sK),e.Y36(M.ux))},K.\u0275cmp=e.Xpm({type:K,selectors:[["app-payable-doc-list"]],features:[e._Bn([f.c])],decls:44,vars:25,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","list"],["viewType","matButtonToggleGroup"],["value","list"],["value","grid"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],["value","add",3,"click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip",4,"ngIf"],["mat-mini-fab","","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100",1,"p-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-button-toggle-group",2,3),e.YNc(4,De,3,0,"mat-button-toggle",4),e.qZA()(),e.TgZ(5,"div",5)(6,"mat-button-toggle-group",6,7)(8,"mat-button-toggle",8)(9,"mat-icon"),e._uU(10,"view_list"),e.qZA()(),e.TgZ(11,"mat-button-toggle",9)(12,"mat-icon"),e._uU(13,"view_module"),e.qZA()()()()(),e._UZ(14,"mat-divider"),e.TgZ(15,"mat-card")(16,"div",10)(17,"h2"),e._uU(18),e.ALo(19,"translate"),e.qZA()(),e._UZ(20,"mat-divider"),e.TgZ(21,"div",11)(22,"div",12)(23,"div",13)(24,"h2"),e._uU(25),e.ALo(26,"translate"),e.qZA()(),e.TgZ(27,"div",13)(28,"h2"),e._uU(29),e.ALo(30,"translate"),e.qZA()(),e.TgZ(31,"div",13)(32,"h2"),e._uU(33),e.ALo(34,"translate"),e.qZA()(),e.TgZ(35,"div",13)(36,"h2"),e._uU(37),e.ALo(38,"translate"),e.qZA()(),e._UZ(39,"div",13),e.qZA(),e.YNc(40,_e,13,6,"div",14),e.ALo(41,"paginate"),e.qZA()(),e.YNc(42,fe,4,0,"div",15),e.YNc(43,ve,2,0,"div",16)),2&t&&(e.xp6(4),e.Q6J("ngIf",i.can("add_onepayable")),e.xp6(14),e.Oqu(e.lcZ(19,9,"HTML.PayableDoc_List")),e.xp6(7),e.hij(" ",e.lcZ(26,11,"HTML.TENANT")," "),e.xp6(4),e.hij(" ",e.lcZ(30,13,"HTML.DocDate")," "),e.xp6(4),e.hij(" ",e.lcZ(34,15,"HTML.DocValue")," "),e.xp6(4),e.hij(" ",e.lcZ(38,17,"HTML.DocPrintedNo")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(41,19,i.documentsAll,e.WLB(22,be,i.count,i.page))),e.xp6(2),e.Q6J("ngIf",i.documentsAll),e.xp6(1),e.Q6J("ngIf",!i.documentsAll))},dependencies:[T.LS,u.sg,u.O5,D.rH,g.xw,g.Wh,g.yH,P.Tq,P.nh,q.A9,q.Yi,y.a8,J.Hw,B.d,H.Ou,j.gM,T._s,b.X$],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}\n"],encapsulation:2});class S{constructor(t,i,o,n,r,d,m,h,U,V,Y){this.activatedRoute=t,this.localStore=i,this._companyService=o,this.global=n,this.router=r,this.snackBar=d,this.docsService=m,this.tenantsService=h,this.contractService=U,this.translateService=V,this.fb=Y,this.curCOMId=l.N.comid,this.account=new F.n,this.userPerm=[],this.AllTenants=[]}ngOnInit(){if(this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.getTenants(),this.sub=this.activatedRoute.params.subscribe(t=>{t.id?(this.id=+t.id,this.getDocById(this.id)):this.payDocForDisplay=new Q}),this.docData_Form=this.fb.group({id:null,PDOCode:null,PDOValue:{value:null,disabled:this.id},PDODocDate:null,PDODocType:"P",PDODocClassType:"H",PDOPrintedCode:null,PDODocSecondPerson:null,PDONotes:null,contract_KeyField:null,branch_KeyField:null,owner_KeyField:null,build_KeyField:null,unit_KeyField:null,installment_KeyField:null,customer_KeyField:null})}else this.router.navigate(["/sign-in"])}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getDocById(t){this.docsService.getOneDocs(t).subscribe(i=>{this.fillForm(i),this.payDocForDisplay=i})}fillForm(t){null!=t.PDODocDate&&(this.s_docDate=t.PDODocDate),this.docData_Form.patchValue({id:t.id,contract_KeyField:t.contract_KeyField,branch_KeyField:t.branch_KeyField,owner_KeyField:t.owner_KeyField,build_KeyField:t.build_KeyField,unit_KeyField:t.unit_KeyField,installment_KeyField:t.installment_KeyField,customer_KeyField:t.customer_KeyField,PDOCode:t.PDOCode,PDOValue:t.PDOValue,PDODocType:t.PDODocType,PDODocDate:t.PDODocDate,PDODocClassType:t.PDODocClassType,PDOPrintedCode:t.PDOPrintedCode,PDODocSecondPerson:t.PDODocSecondPerson,PDONotes:t.PDONotes})}readCustumer(t){this.tenantsService.getOneCustomer(t).subscribe(i=>{this.docData_Form.patchValue({PDODocSecondPerson:i.CUSName,contract_KeyField:i.current_contract,branch_KeyField:i.current_branch,build_KeyField:i.current_building,unit_KeyField:i.current_unit,owner_KeyField:i.current_owner})})}getTenants(){this.AllTenants=null,this.tenantsService.getCustomers(this.curCOMId,this.account.periorty).subscribe(t=>this.AllTenants=t)}mappingFormValue_ToPayDocClass(){const t=new u.uU("en-GB").transform(this.docData_Form.value.PDODocDate,"dd/MM/yyyy");this.payDocForDisplay.id=this.docData_Form.value.id,this.payDocForDisplay.contract_KeyField=this.docData_Form.value.contract_KeyField,this.payDocForDisplay.branch_KeyField=this.docData_Form.value.branch_KeyField,this.payDocForDisplay.owner_KeyField=this.docData_Form.value.owner_KeyField,this.payDocForDisplay.build_KeyField=this.docData_Form.value.build_KeyField,this.payDocForDisplay.unit_KeyField=this.docData_Form.value.unit_KeyField,this.payDocForDisplay.installment_KeyField=this.docData_Form.value.installment_KeyField,this.payDocForDisplay.customer_KeyField=this.docData_Form.value.customer_KeyField,null!=this.docData_Form.value.PDODocDate&&(this.payDocForDisplay.PDODocDate=t),this.payDocForDisplay.PDOCode=this.docData_Form.value.PDOCode,this.payDocForDisplay.PDOValue=this.docData_Form.value.PDOValue,this.payDocForDisplay.PDODocType=this.docData_Form.value.PDODocType,this.payDocForDisplay.PDODocClassType=this.docData_Form.value.PDODocClassType,this.payDocForDisplay.PDOPrintedCode=this.docData_Form.value.PDOPrintedCode,this.payDocForDisplay.PDODocSecondPerson=this.docData_Form.value.PDODocSecondPerson,this.payDocForDisplay.PDONotes=this.docData_Form.value.PDONotes}saveEditDocData(t){this.mappingFormValue_ToPayDocClass(),t?this.docsService.editDoc(this.payDocForDisplay).subscribe(i=>{let o={contract_KeyField:i.contract_KeyField,branch_KeyField:i.branch_KeyField,owner_KeyField:i.owner_KeyField,build_KeyField:i.build_KeyField,unit_KeyField:i.unit_KeyField,installment_KeyField:null,customer_KeyField:i.customer_KeyField,TSTCreditValue:0,TSTDebitValue:i.PDOValue,TSTDate:i.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0635\u0631\u0641 \u0631\u0642\u0645 "+i.PDOCode,TSTSubject:"PAYABLE",TSTSubjectID:i.ID};this.contractService.deleteStatementForSubjectID(this.curCOMId,this.account.periorty,"PAYABLE",i.id).subscribe(n=>{this.contractService.addStatement(o).subscribe(r=>{})}),this.snackBar.open("\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/payable-list"])},i=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}):this.docsService.addDoc(this.payDocForDisplay).subscribe(i=>{this.contractService.addStatement({contract_KeyField:i.contract_KeyField,branch_KeyField:i.branch_KeyField,owner_KeyField:i.owner_KeyField,build_KeyField:i.build_KeyField,unit_KeyField:i.unit_KeyField,installment_KeyField:null,customer_KeyField:i.customer_KeyField,TSTCreditValue:0,TSTDebitValue:i.PDOValue,TSTDate:i.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0635\u0631\u0641 \u0631\u0642\u0645 "+i.PDOCode,TSTSubject:"PAYABLE",TSTSubjectID:i.ID}).subscribe(n=>{}),this.snackBar.open("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/payable-list"])},i=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u0627\u0636\u0627\u0641\u0647 \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(t=>{this.errorRetrieveMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t})}}S.\u0275fac=function(t){return new(t||S)(e.Y36(D.gz),e.Y36(I.C),e.Y36(k.J),e.Y36(E.U),e.Y36(D.F0),e.Y36(M.ux),e.Y36(f.c),e.Y36(G.v),e.Y36(R.W),e.Y36(b.sK),e.Y36(c.qu))},S.\u0275cmp=e.Xpm({type:S,selectors:[["app-payable-doc-dialog"]],decls:62,vars:35,consts:[[1,"p-2"],[4,"ngIf"],[1,"pt-3"],["autocomplete","off","fxLayout","row wrap",3,"formGroup","ngSubmit"],["fxFlex","100","fxFlex.gt-sm","40",1,"px-2"],["width","400","height","300","id","campanyLogo",3,"src"],["fxFlex","100","fxFlex.gt-sm","60",1,"px-2"],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-sm","25",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","PDOCode"],["fxFlex","100","fxFlex.gt-sm","75",1,"px-1"],["appearance","outline","formControlName","customer_KeyField",1,"w-100",3,"placeholder","change"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","PDODocDate","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["pdoDocDate",""],["fxFlex","100","fxFlex.gt-sm","50",1,"px-1"],["matInput","","formControlName","PDOValue","required",""],["matInput","","formControlName","PDOPrintedCode"],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","PDODocSecondPerson","required",""],["fxFlex","100",1,"px-1"],["matInput","","formControlName","PDONotes","rows","3"],["fxFlex","100","class","mt-2 text-center w-100",4,"ngIf"],[3,"value"],["fxFlex","100",1,"mt-2","text-center","w-100"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"h1"),e.YNc(5,Fe,3,3,"span",1),e.YNc(6,Te,3,3,"span",1),e._uU(7),e.ALo(8,"translate"),e.qZA()()(),e.TgZ(9,"mat-card-content",2)(10,"form",3),e.NdJ("ngSubmit",function(){return i.saveEditDocData(i.payDocForDisplay.id)}),e.TgZ(11,"div",4),e._UZ(12,"img",5),e.qZA(),e.TgZ(13,"div",6)(14,"div",7)(15,"div",8)(16,"mat-form-field",9)(17,"mat-label"),e._uU(18),e.ALo(19,"translate"),e.qZA(),e._UZ(20,"input",10),e.qZA()(),e.TgZ(21,"div",11)(22,"label"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"ng-select",12),e.NdJ("change",function(n){return i.readCustumer(n)}),e.ALo(26,"translate"),e.YNc(27,Pe,2,2,"ng-option",13),e.qZA()(),e.TgZ(28,"div",8)(29,"mat-form-field",9)(30,"mat-label"),e._uU(31),e.ALo(32,"translate"),e.qZA(),e._UZ(33,"input",14)(34,"mat-datepicker-toggle",15)(35,"mat-datepicker",null,16),e.qZA()(),e.TgZ(37,"div",17)(38,"mat-form-field",9)(39,"mat-label"),e._uU(40),e.ALo(41,"translate"),e.qZA(),e._UZ(42,"input",18),e.qZA()(),e.TgZ(43,"div",8)(44,"mat-form-field",9)(45,"mat-label"),e._uU(46),e.ALo(47,"translate"),e.qZA(),e._UZ(48,"input",19),e.qZA()(),e.TgZ(49,"div",20)(50,"mat-form-field",9)(51,"mat-label"),e._uU(52),e.ALo(53,"translate"),e.qZA(),e._UZ(54,"input",21),e.qZA()(),e.TgZ(55,"div",22)(56,"mat-form-field",9)(57,"mat-label"),e._uU(58),e.ALo(59,"translate"),e.qZA(),e._UZ(60,"textarea",23),e.qZA()(),e.YNc(61,xe,4,4,"div",24),e.qZA()()()()()()),2&t){const o=e.MAs(36);e.xp6(5),e.Q6J("ngIf",!i.payDocForDisplay.id),e.xp6(1),e.Q6J("ngIf",i.payDocForDisplay.id),e.xp6(1),e.hij(" ",e.lcZ(8,17,"HTML.PayableDoc"),""),e.xp6(3),e.Q6J("formGroup",i.docData_Form),e.xp6(2),e.Q6J("src","assets/images/paymentDocs/payable.png",e.LSH),e.xp6(6),e.Oqu(e.lcZ(19,19,"HTML.CODE")),e.xp6(5),e.hij(" ",e.lcZ(24,21,"HTML.TENANT"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(26,23,"HTML.TENANT")),e.xp6(2),e.Q6J("ngForOf",i.AllTenants),e.xp6(4),e.Oqu(e.lcZ(32,25,"HTML.DocDate")),e.xp6(2),e.Q6J("matDatepicker",o),e.xp6(1),e.Q6J("for",o),e.xp6(6),e.Oqu(e.lcZ(41,27,"HTML.DocValue")),e.xp6(6),e.Oqu(e.lcZ(47,29,"HTML.DocPrintedNo")),e.xp6(6),e.Oqu(e.lcZ(53,31,"HTML.DocSecondPart_PayableDoc")),e.xp6(6),e.Oqu(e.lcZ(59,33,"HTML.Notes")),e.xp6(3),e.Q6J("ngIf",i.can("change_onepayable"))}},dependencies:[c._Y,c.Fj,c.JJ,c.JL,c.Q7,u.sg,u.O5,c.sg,c.u,g.xw,g.yH,P.lW,y.a8,y.dn,y.dk,y.n5,x.Mq,x.hl,x.nW,W.Nt,Z.KE,Z.hX,Z.R9,L.w9,L.jq,b.X$]});const $=[{path:"",redirectTo:"receivable-list",pathMatch:"full"},{path:"receivable-list",component:C,data:{breadcrumb:"ReceiptVouchers"}},{path:"receivable-add/:id",component:A,data:{breadcrumb:"EditReceiptVoucher"}},{path:"receivable-add",component:A,data:{breadcrumb:"AddReceiptVoucher"}},{path:"payable-list",component:K,data:{breadcrumb:"PaymentVouchers"}},{path:"payable-add/:id",component:S,data:{breadcrumb:"EditPaymentVoucher"}},{path:"payable-add",component:S,data:{breadcrumb:"AddPaymentVoucher"}}];class O{}O.\u0275fac=function(t){return new(t||O)},O.\u0275mod=e.oAB({type:O}),O.\u0275inj=e.cJS({imports:[de.JF,c.u5,T.JX,pe.D,u.ez,D.Bz.forChild($),c.UX,me.m,T.JX,L.A0]})},2887:(X,w,s)=>{s.d(w,{$:()=>v});var u=s(5412),l=s(4650),F=s(1576),f=s(4859),N=s(3081);class v{constructor(_,p){this.dialogRef=_,this.data=p}ngOnInit(){}onConfirm(){this.dialogRef.close(!0)}onDismiss(){this.dialogRef.close(!1)}}v.\u0275fac=function(_){return new(_||v)(l.Y36(u.so),l.Y36(u.WI))},v.\u0275cmp=l.Xpm({type:v,selectors:[["app-confirm-dialog"]],decls:13,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(_,p){1&_&&(l.TgZ(0,"h1",0),l._uU(1),l.qZA(),l.TgZ(2,"div",1)(3,"p"),l._uU(4),l.qZA()(),l.TgZ(5,"div",2)(6,"div",3)(7,"button",4),l.NdJ("click",function(){return p.onDismiss()}),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.TgZ(10,"button",5),l.NdJ("click",function(){return p.onConfirm()}),l._uU(11),l.ALo(12,"translate"),l.qZA()()()),2&_&&(l.xp6(1),l.Oqu(null==p.data?null:p.data.title),l.xp6(3),l.Oqu(null==p.data?null:p.data.message),l.xp6(4),l.Oqu(l.lcZ(9,4,"BTN.NO")),l.xp6(3),l.Oqu(l.lcZ(12,6,"BTN.YES")))},dependencies:[F.xw,F.Wh,f.lW,u.uh,u.xY,u.H8,N.X$]})}}]);