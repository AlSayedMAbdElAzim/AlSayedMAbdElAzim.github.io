"use strict";(self.webpackChunkemporium=self.webpackChunkemporium||[]).push([[809],{3809:(X,N,s)=>{s.r(N),s.d(N,{EmployeesModule:()=>C,routes:()=>W});var c=s(6895),m=s(3071),u=s(5412),l=s(4006);class O{}var h=s(5521),e=s(4650),g=s(6002),d=s(5298),L=s(7009),H=s(1182),f=s(1576),P=s(3238),z=s(445),y=s(4859),V=s(6709),b=s(9602),w=s(7392),S=s(4144),_=s(9549),Y=s(1948),J=s(4385),k=s(3848),U=s(3081);function ee(o,t){1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.ADD")))}function te(o,t){1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function ie(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.REQUIRED_USERNAME")," "))}function oe(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.MIN_LENGTH_USERNAME")," "))}function ne(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.REQUIRED_PASSWORD")," "))}function ae(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.MIN_LENGTH_PASSWORD")," "))}function se(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"mat-form-field",12)(1,"mat-label")(2,"mat-icon"),e._uU(3,"vpn_key"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"input",46),e.TgZ(7,"mat-icon",47),e.NdJ("click",function(){e.CHM(i);const a=e.oxw();return e.KtG(a.passwordHide=!a.passwordHide)}),e._uU(8),e.qZA(),e.YNc(9,ne,3,3,"mat-error",1),e.YNc(10,ae,3,3,"mat-error",1),e.qZA()}if(2&o){const i=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,5,"HTML.PASSWORD")," "),e.xp6(2),e.Q6J("type",i.passwordHide?"password":"text"),e.xp6(2),e.hij(" ",i.passwordHide?"visibility":"visibility_off"," "),e.xp6(1),e.Q6J("ngIf",null==i.form.controls.password.errors?null:i.form.controls.password.errors.required),e.xp6(1),e.Q6J("ngIf",i.form.controls.password.hasError("minlength"))}}function re(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.REQUIRED_FIRST_NAME")," "))}function le(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.REQUIRED_LAST_NAME")," "))}function me(o,t){if(1&o&&(e.TgZ(0,"mat-option",26),e._uU(1),e.qZA()),2&o){const i=t.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.BRAArbName," ")}}function ce(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.REQUIRED_BRANCH")," "))}function pe(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.INVALID_EMAIL")," "))}function ue(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.INVALID_MOBILE")," "))}function de(o,t){if(1&o&&(e.TgZ(0,"p")(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"i"),e._uU(5),e.ALo(6,"date"),e.qZA()()),2&o){const i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"HTML.RegisterDate")),e.xp6(3),e.hij("(",e.xi3(6,4,i.user.EntryDate,"dd-MM-yyyy"),")")}}function _e(o,t){if(1&o&&(e.TgZ(0,"p")(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"i"),e._uU(5),e.ALo(6,"date"),e.qZA()()),2&o){const i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"HTML.LastSeen")),e.xp6(3),e.hij("(",e.xi3(6,4,i.user.joinDate,"dd-MM-yyyy"),")")}}function ge(o,t){1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.SAVE")))}function fe(o,t){1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function he(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){e.CHM(i);const a=e.oxw();return e.KtG(a.onSave())}),e.YNc(1,ge,3,3,"span",1),e.YNc(2,fe,3,3,"span",1),e.qZA()}if(2&o){const i=e.oxw();e.Q6J("mat-dialog-close",i.form.value)("disabled",!i.form.valid),e.xp6(1),e.Q6J("ngIf",!i.user.id),e.xp6(1),e.Q6J("ngIf",i.user.id)}}class E{constructor(t,i,n,a,r,p,x){this.dialogRef=t,this.user=i,this.atlasService=n,this.localStore=a,this.snackBar=r,this.fb=p,this.appSettings=x,this.passwordHide=!0,this.defaultCusImage=this.noImageUrl,this.CusImageToUpload=null,this.userPerm=[],this.AllBranches=[],this.allowedChar="1234567890",this.lengthOfCode=6,this.baseUrl=this.appSettings.settings.url,this.secondPartUrl=new h.P(this.baseUrl).api_constant,this.noImageUrl=new h.P(this.baseUrl).noImage}handelEmpImgInput(t){this.CusImageToUpload=t.item(0);var i=new FileReader;i.onload=n=>{this.defaultCusImage=n.target.result},i.readAsDataURL(this.CusImageToUpload)}ngOnInit(){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curCOMId=this.curUserData.COMId,this.appSetup=JSON.parse(this.localStore.getItem("appsetup")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.form=this.fb.group({id:null,username:[null,l.kI.compose([l.kI.required,l.kI.minLength(3)])],password:null,UserCode:null,first_name:null,last_name:null,UserBirthDate:null,gender:"M",userPicture:null,work:this.fb.group({userJobName:null,branch_KeyField:null,is_superuser:!1,is_staff:!1,is_active:!0,is_employee:!0}),contacts:this.fb.group({email:[null,l.kI.required],UserMobile:[null,l.kI.required],userAddress:null}),social:this.fb.group({userFacebook:null,userTwitter:null,userGoogle:null}),settings:this.fb.group({isActive:!1,isDeleted:!1,EntryDate:null,joinedDate:null})}),this.user?(this.curPeriority=this.user.periorty,this.action="Patch",this.fillForm(this.user)):(this.curPeriority=0,this.action="Post",this.user=new O,this.getMaxCodeForCustomers()),this.getAllBranches(this.curCOMId,this.curPeriority)}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}fillForm(t){this.defaultCusImage=null!=t.userPicture?t.userPicture:this.noImageUrl,this.is_delete=1==t.RowDelete,this.is_Employee="T"==t.is_employee,this.form.patchValue({id:t.id,username:t.username,password:t.password,UserCode:t.UserCode,first_name:t.first_name,last_name:t.last_name,UserBirthDate:t.UserBirthDate,gender:t.gender,userPicture:t.userPicture,work:{userJobName:t.userJobName,branch_KeyField:t.branch_KeyField,is_superuser:t.is_superuser,is_staff:t.is_staff,is_active:t.is_active,is_employee:this.is_Employee},contacts:{email:t.email,UserMobile:t.UserMobile,userAddress:t.userAddress},settings:{isDeleted:this.is_delete,EntryDate:t.EntryDate,joinedDate:t.joinedDate}})}getAllBranches(t,i){this.atlasService.getAllBranch(t,i).subscribe(n=>{this.AllBranches=n},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0641\u0631\u0648\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}onChangeActive(){console.log(this.form.value)}onSave(){console.log("===***Press Save button***==="),this.form.valid&&this.dialogRef.close({event:this.action,data:this.form.value,empPic:this.CusImageToUpload})}close(){this.action="Cancel",console.log("===***Press Close button***==="),this.dialogRef.close({event:this.action})}createRandomString(t,i){let n="";for(let a=0;a<t;a++)n+=i.charAt(Math.floor(Math.random()*i.length));return n}getMaxCodeForCustomers(){let t=this.createRandomString(this.lengthOfCode,this.allowedChar);console.log(t),this.form.patchValue({username:t,password:t,contacts:{email:"E"+t+"@changeit.com"}})}}E.\u0275fac=function(t){return new(t||E)(e.Y36(u.so),e.Y36(u.WI),e.Y36(g.Z),e.Y36(d.C),e.Y36(L.ux),e.Y36(l.QS),e.Y36(H.d))},E.\u0275cmp=e.Xpm({type:E,selectors:[["app-employee-dialog"]],decls:140,vars:90,consts:[["mat-dialog-title","","dir","rtl"],[4,"ngIf"],["mat-dialog-content","","dir","rtl"],[1,"user-form",3,"formGroup"],["dir","rtl",1,"vertical-tabs","tab-content-wrapped"],[3,"label"],["fxLayout","column","fxLayoutGap","16px",1,"form-field-outer"],["fxLayout","row","fxLayoutGap","16px","fxLayoutAlign","end center",1,"w-100"],["appearance","outline",1,"w-50"],["matInput","","formControlName","username","required","","aria-required","true"],["appearance","outline","class","w-45",4,"ngIf"],["matInput","","formControlName","first_name","required","","aria-required","true"],["appearance","outline",1,"w-45"],["matInput","","formControlName","last_name","required","","aria-required","true"],["formControlName","gender","fxLayout","row","fxLayoutGap","16px"],["value","M","labelPosition","before"],["value","F","labelPosition","before"],["matInput","","formControlName","UserBirthDate",3,"matDatepicker"],["matSuffix","",3,"for"],["birthday",""],[1,"image-upload-container","p-2"],["alt","Employee Image",2,"width","150px","height","200px","object-fit","cover","border-radius","8px",3,"src"],["formControlName","userPicture","name","userPicture","id","EmpPicupload","type","file","accept","image/*","aria-label","Upload employee image",1,"user-img",3,"change"],["for","EmpPicupload",1,"upload-label"],["formGroupName","work",3,"label"],["formControlName","branch_KeyField","id","emp_branchContOpSel","required","","aria-required","true"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","userJobName"],["formControlName","is_superuser"],["formControlName","is_staff"],["formControlName","is_active",3,"change"],["formControlName","is_employee"],["formGroupName","contacts",3,"label"],["appearance","outline",1,"w-100"],["matInput","","formControlName","email","type","email"],["matInput","","formControlName","UserMobile","type","tel"],["matInput","","formControlName","userAddress"],["formGroupName","social",3,"label"],["matInput","","formControlName","userFacebook"],["matInput","","formControlName","userTwitter"],["matInput","","formControlName","userGoogle"],["formGroupName","settings",3,"label"],["mat-dialog-actions","","dir","rtl"],["mat-raised-button","","color","primary","aria-label","Save or Edit Employee",3,"mat-dialog-close","disabled","click",4,"ngIf"],["mat-raised-button","","color","warn","aria-label","Cancel",3,"click"],["matInput","","formControlName","password","required","","aria-required","true",3,"type"],["matSuffix","","aria-label","Toggle password visibility",3,"click"],["mat-raised-button","","color","primary","aria-label","Save or Edit Employee",3,"mat-dialog-close","disabled","click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"h1",0),e.YNc(1,ee,3,3,"span",1),e.YNc(2,te,3,3,"span",1),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2)(6,"form",3)(7,"mat-tab-group",4)(8,"mat-tab",5),e.ALo(9,"translate"),e.TgZ(10,"div",6)(11,"div",7)(12,"mat-form-field",8)(13,"mat-label")(14,"mat-icon"),e._uU(15,"person"),e.qZA(),e._uU(16),e.ALo(17,"translate"),e.qZA(),e._UZ(18,"input",9),e.YNc(19,ie,3,3,"mat-error",1),e.YNc(20,oe,3,3,"mat-error",1),e.qZA(),e.YNc(21,se,11,7,"mat-form-field",10),e.qZA(),e.TgZ(22,"div",7)(23,"mat-form-field",8)(24,"mat-label")(25,"mat-icon"),e._uU(26,"person"),e.qZA(),e._uU(27),e.ALo(28,"translate"),e.qZA(),e._UZ(29,"input",11),e.YNc(30,re,3,3,"mat-error",1),e.qZA(),e.TgZ(31,"mat-form-field",12)(32,"mat-label")(33,"mat-icon"),e._uU(34,"person"),e.qZA(),e._uU(35),e.ALo(36,"translate"),e.qZA(),e._UZ(37,"input",13),e.YNc(38,le,3,3,"mat-error",1),e.qZA()(),e.TgZ(39,"div",7)(40,"mat-radio-group",14)(41,"mat-radio-button",15),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"mat-radio-button",16),e._uU(45),e.ALo(46,"translate"),e.qZA()(),e.TgZ(47,"mat-form-field",12)(48,"mat-label"),e._uU(49),e.ALo(50,"translate"),e.qZA(),e._UZ(51,"input",17)(52,"mat-datepicker-toggle",18)(53,"mat-datepicker",null,19),e.qZA()(),e.TgZ(55,"div",20),e._UZ(56,"img",21),e.TgZ(57,"input",22),e.NdJ("change",function(a){return i.handelEmpImgInput(a.target.files)}),e.qZA(),e.TgZ(58,"label",23),e._uU(59),e.ALo(60,"translate"),e.qZA()()()(),e.TgZ(61,"mat-tab",24),e.ALo(62,"translate"),e.TgZ(63,"div",6)(64,"div",7)(65,"mat-form-field",8)(66,"mat-label"),e._uU(67),e.ALo(68,"translate"),e.qZA(),e.TgZ(69,"mat-select",25)(70,"mat-option",26),e._uU(71),e.ALo(72,"translate"),e.qZA(),e.YNc(73,me,2,2,"mat-option",27),e.qZA(),e.YNc(74,ce,3,3,"mat-error",1),e.qZA(),e.TgZ(75,"mat-form-field",12)(76,"mat-label"),e._uU(77),e.ALo(78,"translate"),e.qZA(),e._UZ(79,"input",28),e.qZA()(),e.TgZ(80,"div",7)(81,"mat-checkbox",29),e._uU(82),e.ALo(83,"translate"),e.qZA(),e.TgZ(84,"mat-checkbox",30),e._uU(85),e.ALo(86,"translate"),e.qZA()(),e.TgZ(87,"div",7)(88,"mat-checkbox",31),e.NdJ("change",function(){return i.onChangeActive()}),e._uU(89),e.ALo(90,"translate"),e.qZA(),e.TgZ(91,"mat-checkbox",32),e._uU(92),e.ALo(93,"translate"),e.qZA()()()(),e.TgZ(94,"mat-tab",33),e.ALo(95,"translate"),e.TgZ(96,"div",6)(97,"mat-form-field",34)(98,"mat-label"),e._uU(99),e.ALo(100,"translate"),e.qZA(),e._UZ(101,"input",35),e.YNc(102,pe,3,3,"mat-error",1),e.qZA(),e.TgZ(103,"mat-form-field",34)(104,"mat-label"),e._uU(105),e.ALo(106,"translate"),e.qZA(),e._UZ(107,"input",36),e.YNc(108,ue,3,3,"mat-error",1),e.qZA(),e.TgZ(109,"mat-form-field",34)(110,"mat-label"),e._uU(111),e.ALo(112,"translate"),e.qZA(),e._UZ(113,"input",37),e.qZA()()(),e.TgZ(114,"mat-tab",38),e.ALo(115,"translate"),e.TgZ(116,"div",6)(117,"mat-form-field",34)(118,"mat-label"),e._uU(119,"Facebook"),e.qZA(),e._UZ(120,"input",39),e.qZA(),e.TgZ(121,"mat-form-field",34)(122,"mat-label"),e._uU(123,"Twitter"),e.qZA(),e._UZ(124,"input",40),e.qZA(),e.TgZ(125,"mat-form-field",34)(126,"mat-label"),e._uU(127,"Google"),e.qZA(),e._UZ(128,"input",41),e.qZA()()(),e.TgZ(129,"mat-tab",42),e.ALo(130,"translate"),e.TgZ(131,"div",6),e.YNc(132,de,7,7,"p",1),e.YNc(133,_e,7,7,"p",1),e.qZA()()()()(),e.TgZ(134,"div",43)(135,"div",7),e.YNc(136,he,3,4,"button",44),e.TgZ(137,"button",45),e.NdJ("click",function(){return i.close()}),e._uU(138),e.ALo(139,"translate"),e.qZA()()()),2&t){const n=e.MAs(54);let a,r,p;e.xp6(1),e.Q6J("ngIf",!i.user.id),e.xp6(1),e.Q6J("ngIf",i.user.id),e.xp6(1),e.hij(" ",e.lcZ(4,42,"HTML.EMPLOYEE"),"\n"),e.xp6(3),e.Q6J("formGroup",i.form),e.xp6(2),e.s9C("label",e.lcZ(9,44,"HTML.TAB_BASIC")),e.xp6(8),e.hij(" ",e.lcZ(17,46,"HTML.USERNAME")," "),e.xp6(3),e.Q6J("ngIf",null==i.form.controls.username.errors?null:i.form.controls.username.errors.required),e.xp6(1),e.Q6J("ngIf",i.form.controls.username.hasError("minlength")),e.xp6(1),e.Q6J("ngIf",!i.user.id),e.xp6(6),e.hij(" ",e.lcZ(28,48,"HTML.FIRST_NAME")," "),e.xp6(3),e.Q6J("ngIf",null==i.form.controls.first_name.errors?null:i.form.controls.first_name.errors.required),e.xp6(5),e.hij(" ",e.lcZ(36,50,"HTML.LAST_NAME")," "),e.xp6(3),e.Q6J("ngIf",null==i.form.controls.last_name.errors?null:i.form.controls.last_name.errors.required),e.xp6(4),e.hij(" ",e.lcZ(43,52,"HTML.MALE")," "),e.xp6(3),e.hij(" ",e.lcZ(46,54,"HTML.FEMALE")," "),e.xp6(4),e.Oqu(e.lcZ(50,56,"HTML.BIRTH_DATE")),e.xp6(2),e.Q6J("matDatepicker",n),e.xp6(1),e.Q6J("for",n),e.xp6(4),e.Q6J("src",i.defaultCusImage,e.LSH),e.xp6(3),e.Oqu(e.lcZ(60,58,"HTML.UPLOAD_IMAGE")),e.xp6(2),e.s9C("label",e.lcZ(62,60,"HTML.TAB_WORK")),e.xp6(6),e.Oqu(e.lcZ(68,62,"HTML.BRANCH")),e.xp6(4),e.Oqu(e.lcZ(72,64,"HTML.SELECT_BRANCH")),e.xp6(2),e.Q6J("ngForOf",i.AllBranches),e.xp6(1),e.Q6J("ngIf",null==(a=i.form.get("work.branch_KeyField"))||null==a.errors?null:a.errors.required),e.xp6(3),e.Oqu(e.lcZ(78,66,"HTML.Job")),e.xp6(5),e.hij(" ",e.lcZ(83,68,"HTML.IsSUPERUSER")," "),e.xp6(3),e.hij(" ",e.lcZ(86,70,"HTML.IsSTAFF")," "),e.xp6(4),e.hij(" ",e.lcZ(90,72,"HTML.ACTIVE")," "),e.xp6(3),e.hij(" ",e.lcZ(93,74,"HTML.IsEMPLOYEE")," "),e.xp6(2),e.s9C("label",e.lcZ(95,76,"HTML.TAB_CONTACTS")),e.xp6(5),e.Oqu(e.lcZ(100,78,"HTML.EMAIL")),e.xp6(3),e.Q6J("ngIf",null==(r=i.form.get("contacts.email"))||null==r.errors?null:r.errors.email),e.xp6(3),e.Oqu(e.lcZ(106,80,"HTML.MOBILE")),e.xp6(3),e.Q6J("ngIf",null==(p=i.form.get("contacts.UserMobile"))||null==p.errors?null:p.errors.pattern),e.xp6(3),e.Oqu(e.lcZ(112,82,"HTML.ADDRESS")),e.xp6(3),e.s9C("label",e.lcZ(115,84,"HTML.TAB_SOCIAL_LIFE")),e.xp6(15),e.s9C("label",e.lcZ(130,86,"HTML.TAB_SETTINGS")),e.xp6(3),e.Q6J("ngIf",i.user.id),e.xp6(1),e.Q6J("ngIf",i.user.id),e.xp6(3),e.Q6J("ngIf",i.user.id&&i.can("change_employee")||!i.user.id&&i.can("add_employee")),e.xp6(2),e.hij(" ",e.lcZ(139,88,"BTN.CANCEL")," ")}},dependencies:[c.sg,c.O5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.sg,l.u,l.x0,f.xw,f.SQ,f.Wh,P.ey,z.Lv,y.lW,V.oG,b.Mq,b.hl,b.nW,u.ZT,u.uh,u.xY,u.H8,w.Hw,S.Nt,_.KE,_.hX,_.TO,_.R9,Y.VQ,Y.U0,J.gD,k.uX,k.SP,c.uU,U.X$],styles:[".user-form[_ngcontent-%COMP%]{min-width:600px;max-width:800px;padding:16px}.user-form[_ngcontent-%COMP%]   .form-field-outer[_ngcontent-%COMP%]{width:480px}.mat-tab-group[_ngcontent-%COMP%]{text-align:right}.mat-form-field[_ngcontent-%COMP%]{width:100%;text-align:right}.w-50[_ngcontent-%COMP%]{width:50%!important}.w-45[_ngcontent-%COMP%]{width:45%!important}.form-field-outer[_ngcontent-%COMP%]{padding:16px}.image-upload-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:8px}.user-img[_ngcontent-%COMP%]{display:none}.upload-label[_ngcontent-%COMP%]{cursor:pointer;padding:8px 16px;background-color:#f5f5f5;border-radius:4px;text-align:center}"]});var Ze=s(2887),xe=s(7288),Te=s(3705),Z=s(3546),Q=s(4850),Ae=s(266);function ve(o,t){if(1&o&&(e.TgZ(0,"mat-option",7),e._uU(1),e.qZA()),2&o){const i=t.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.BRAArbName," ")}}function ye(o,t){if(1&o&&(e.TgZ(0,"mat-option",7),e._uU(1),e.qZA()),2&o){const i=t.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.BUIName," ")}}function be(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(i);const a=e.oxw();return e.KtG(a.onSave())}),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()}if(2&o){const i=e.oxw();e.Q6J("disabled",!i.dataForm.valid),e.xp6(2),e.Oqu(e.lcZ(3,2,"BTN.SAVE"))}}function Ce(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(i);const a=e.oxw().$implicit,r=e.oxw();return e.KtG(r.remove(a.id))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()}2&o&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.REMOVE"))}function Le(o,t){if(1&o&&(e.TgZ(0,"div",20)(1,"div",21),e._uU(2),e.qZA(),e.TgZ(3,"div",21),e._uU(4),e.qZA(),e.TgZ(5,"div",21)(6,"div",22),e.YNc(7,Ce,4,3,"button",23),e.qZA()()()),2&o){const i=t.$implicit,n=e.oxw();e.xp6(2),e.Oqu(i.branch_Name),e.xp6(2),e.hij("",i.build_Name," "),e.xp6(3),e.Q6J("ngIf",n.can("delete_emp_security_onebuilding"))}}class M{constructor(t,i,n,a,r,p,x,T,D){this.dialogRef=t,this.user=i,this.atlasService=n,this.unitsService=a,this.translateService=r,this.localStore=p,this.dialog=x,this.snackBar=T,this.fb=D,this.passwordHide=!0,this.userPerm=[],this.AllBranches=[],this.AllBuilding=[]}ngOnInit(){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curCOMId=this.curUserData.COMId,this.appSetup=JSON.parse(this.localStore.getItem("appsetup")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.dataForm=this.fb.group({branch_KeyField:[null,l.kI.required],build_KeyField:[null,l.kI.required]}),this.Builds=new xe.j,this.curPeriority=this.user.periorty,this.action="Patch",this.getAllBranches(this.curCOMId,this.curPeriority),this.getEmpBuilds(),this.prepareMsgLanguage()}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getEmpBuilds(){this.empBuildings=null,this.unitsService.getAllBuildingForUser(this.curCOMId,this.curPeriority,this.user.id).subscribe(t=>this.empBuildings=t)}getAllBranches(t,i){this.atlasService.getAllBranch(t,i).subscribe(n=>{this.AllBranches=n},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0641\u0631\u0648\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getBuildings(t){this.getBuildingPerBranch(this.curCOMId,this.curPeriority,t.value)}getBuildingPerBranch(t,i,n){null==n?(console.log("-----related:: "+n),this.AllBuilding=[]):this.unitsService.getBuildingsPerBranch(t,i,n).subscribe(a=>{this.AllBuilding=a},a=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0639\u0642\u0627\u0631\u0627\u062a \u0644\u0644\u0641\u0631\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}mapFormValue_toTable(){this.Builds.user_KeyField=this.user.id,this.Builds.build_KeyField=this.dataForm.value.build_KeyField}onSave(){this.mapFormValue_toTable(),this.unitsService.addBuildForEmployee(this.Builds).subscribe(()=>{this.snackBar.open(this.dataSavedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getEmpBuilds()})}close(){this.action="Cancel",console.log("===***Press Close button***==="),this.dialogRef.close({event:this.action})}remove(t){this.dialog.open(Ze.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(n=>{n&&this.unitsService.deleteBuildingForUser(t).subscribe(()=>{this.snackBar.open(this.deletedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getEmpBuilds()})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.DataSaved").subscribe(t=>{this.dataSavedMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(t=>{this.deletedTitleMsg=t})}}M.\u0275fac=function(t){return new(t||M)(e.Y36(u.so),e.Y36(u.WI),e.Y36(g.Z),e.Y36(Te.X),e.Y36(U.sK),e.Y36(d.C),e.Y36(u.uw),e.Y36(L.ux),e.Y36(l.QS))},M.\u0275cmp=e.Xpm({type:M,selectors:[["app-emp-builds-dialog"]],decls:51,vars:29,consts:[["autocomplete","off",3,"formGroup"],["mat-dialog-content",""],["fxLayout","row wrap"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["fxFlex","100","fxFlex.gt-sm","49.8",1,"px-1"],["appearance","outline",1,"w-100"],["formControlName","branch_KeyField","id","branchContOpSel",3,"placeholder","selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["formControlName","build_KeyField","id","build_OneOpSel",3,"placeholder"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],[1,"p-2"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","warn","class","mx-1",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","warn",1,"mx-1",3,"matTooltip","click"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"mat-select",6),e.NdJ("selectionChange",function(a){return i.getBuildings(a)}),e.ALo(10,"translate"),e.TgZ(11,"mat-option",7),e._uU(12,"-"),e.qZA(),e.YNc(13,ve,2,2,"mat-option",8),e.qZA()()(),e.TgZ(14,"div",4)(15,"mat-form-field",5)(16,"mat-label"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"mat-select",9),e.ALo(20,"translate"),e.TgZ(21,"mat-option",7),e._uU(22,"-"),e.qZA(),e.YNc(23,ye,2,2,"mat-option",8),e.qZA()()()()()(),e.TgZ(24,"div",10)(25,"div",3),e.YNc(26,be,4,4,"button",11),e.TgZ(27,"button",12),e.NdJ("click",function(){return i.close()}),e._uU(28),e.ALo(29,"translate"),e.qZA()()(),e._UZ(30,"mat-divider"),e.TgZ(31,"div",13)(32,"mat-dialog-content")(33,"mat-card")(34,"div",14)(35,"h2"),e._uU(36),e.ALo(37,"translate"),e.qZA()(),e._UZ(38,"mat-divider"),e.TgZ(39,"div",15)(40,"div",16)(41,"div",17)(42,"h2"),e._uU(43),e.ALo(44,"translate"),e.qZA()(),e.TgZ(45,"div",17)(46,"h2"),e._uU(47),e.ALo(48,"translate"),e.qZA()(),e._UZ(49,"div",17),e.qZA(),e.YNc(50,Le,8,3,"div",18),e.qZA()()()()()),2&t&&(e.Q6J("formGroup",i.dataForm),e.xp6(7),e.hij(" ",e.lcZ(8,13,"HTML.BRANCH"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(10,15,"HTML.BRANCH")),e.xp6(4),e.Q6J("ngForOf",i.AllBranches),e.xp6(4),e.hij(" ",e.lcZ(18,17,"HTML.BUILDING"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(20,19,"HTML.BUILDING")),e.xp6(4),e.Q6J("ngForOf",i.AllBuilding),e.xp6(3),e.Q6J("ngIf",i.can("add_emp_security_onebuilding")),e.xp6(2),e.Oqu(e.lcZ(29,21,"BTN.CANCEL")),e.xp6(8),e.Oqu(e.lcZ(37,23,"HTML.EmpBuildings")),e.xp6(7),e.hij(" ",e.lcZ(44,25,"HTML.BRANCH")," "),e.xp6(4),e.hij(" ",e.lcZ(48,27,"HTML.BUILDING")," "),e.xp6(3),e.Q6J("ngForOf",i.empBuildings))},dependencies:[c.sg,c.O5,l._Y,l.JJ,l.JL,l.sg,l.u,f.xw,f.Wh,f.yH,P.ey,y.lW,y.nh,Z.a8,u.xY,u.H8,w.Hw,_.KE,_.hX,Q.d,J.gD,Ae.gM,U.X$],styles:[".user-form[_ngcontent-%COMP%]   .form-field-outer[_ngcontent-%COMP%]{width:680px}.user-form[_ngcontent-%COMP%]   .mat-mdc-radio-button[_ngcontent-%COMP%]{margin-right:12px}.auth[_ngcontent-%COMP%]{white-space:nowrap;padding:7px 14px;font-weight:500}"]});var Ue=s(3221),Ee=s(5783),Me=s(6331),F=s(9132),j=s(7465),B=s(4333),K=s(811),R=s(8255),G=s(1572),Ie=s(455),qe=s(1419);function De(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"mat-button-toggle",16),e.NdJ("click",function(){e.CHM(i);const a=e.oxw();return e.KtG(a.openUserDialog(null))}),e.TgZ(1,"mat-icon"),e._uU(2,"person_add"),e.qZA()()}}function Ne(o,t){if(1&o&&(e.TgZ(0,"h3",39),e._uU(1),e.qZA()),2&o){const i=e.oxw().$implicit;e.xp6(1),e.AsE("",i.first_name," ",i.last_name,"")}}function we(o,t){if(1&o&&(e.TgZ(0,"h3",39),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const i=e.oxw().$implicit;e.xp6(1),e.lnq("",i.first_name," ",i.last_name," (",e.lcZ(2,3,"HTML.BLOCKED"),")")}}function Fe(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const a=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.openUserDialog(a))}),e.TgZ(1,"mat-icon"),e._uU(2,"mode_edit"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.VIEW")))}function Oe(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const a=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.deleteUser(a))}),e.TgZ(1,"mat-icon"),e._uU(2,"delete"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.REMOVE")))}function Pe(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const a=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.changePassword(a))}),e.TgZ(1,"mat-icon"),e._uU(2,"key"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.PasswordChange")))}function Se(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const a=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.openBuildingDialog(a))}),e.TgZ(1,"mat-icon"),e._uU(2,"business"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.Building")))}function Je(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const a=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.openUserPermission(a.id))}),e.TgZ(1,"mat-icon"),e._uU(2,"security"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.Security")))}function Be(o,t){if(1&o&&e._UZ(0,"img",41),2&o){const i=e.oxw().$implicit;e.ekj("blocked",!i.is_active),e.Q6J("src",i.userPicture,e.LSH)}}function Re(o,t){if(1&o&&e._UZ(0,"img",42),2&o){const i=e.oxw().$implicit;e.ekj("blocked",!i.is_active)}}function He(o,t){1&o&&(e.TgZ(0,"mat-icon",43),e._uU(1,"block"),e.qZA())}function Ye(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",19)(1,"mat-card")(2,"div",20),e.YNc(3,Ne,2,2,"h3",21),e.YNc(4,we,3,5,"h3",21),e.TgZ(5,"button",22,23)(7,"mat-icon"),e._uU(8,"more_vert"),e.qZA()()(),e.TgZ(9,"mat-menu",24,25)(11,"span",26),e.NdJ("mouseleave",function(){e.CHM(i);const a=e.MAs(6);return e.KtG(a.closeMenu())}),e.YNc(12,Fe,6,3,"button",27),e.YNc(13,Oe,6,3,"button",27),e._UZ(14,"mat-divider"),e.YNc(15,Pe,6,3,"button",27),e._UZ(16,"mat-divider"),e.YNc(17,Se,6,3,"button",27),e.YNc(18,Je,6,3,"button",27),e.qZA()(),e.TgZ(19,"div",28)(20,"div",29)(21,"div",30),e.YNc(22,Be,1,3,"img",31),e.YNc(23,Re,1,2,"img",32),e.YNc(24,He,2,0,"mat-icon",33),e.qZA(),e.TgZ(25,"div",34)(26,"mat-slide-toggle",35),e.NdJ("change",function(){const r=e.CHM(i).$implicit;return e.KtG(r.is_active=!r.is_active)}),e.qZA()()(),e.TgZ(27,"div",36)(28,"p",37)(29,"mat-icon",38),e._uU(30,"card_membership"),e.qZA(),e.TgZ(31,"span"),e._uU(32),e.qZA()(),e.TgZ(33,"p",37)(34,"mat-icon",38),e._uU(35,"mail_outline"),e.qZA(),e.TgZ(36,"span"),e._uU(37),e.qZA()(),e.TgZ(38,"p",37)(39,"mat-icon",38),e._uU(40,"call"),e.qZA(),e.TgZ(41,"span"),e._uU(42),e.qZA()(),e.TgZ(43,"p",37)(44,"mat-icon",38),e._uU(45,"location_on"),e.qZA(),e.TgZ(46,"span"),e._uU(47),e.qZA()(),e.TgZ(48,"p",37)(49,"mat-icon",38),e._uU(50,"date_range"),e.qZA(),e.TgZ(51,"span"),e._uU(52),e.ALo(53,"translate"),e.qZA()()()()()()}if(2&o){const i=t.$implicit,n=e.MAs(10),a=e.oxw(2);e.xp6(3),e.Q6J("ngIf",i.is_active),e.xp6(1),e.Q6J("ngIf",!i.is_active),e.xp6(1),e.Q6J("matMenuTriggerFor",n),e.xp6(7),e.Q6J("ngIf",a.can("view_oneemployee")),e.xp6(1),e.Q6J("ngIf",a.can("delete_employee")),e.xp6(2),e.Q6J("ngIf",a.can("change_emp_password")),e.xp6(2),e.Q6J("ngIf",a.can("view_emp_securitybuildings")),e.xp6(1),e.Q6J("ngIf",a.can("view_emp_securitypermissions")),e.xp6(4),e.Q6J("ngIf",i.userPicture),e.xp6(1),e.Q6J("ngIf",!i.userPicture),e.xp6(1),e.Q6J("ngIf",!i.is_active),e.xp6(2),e.Q6J("checked",i.is_active),e.xp6(1),e.ekj("blocked",!i.is_active),e.xp6(5),e.Oqu(i.userJobName),e.xp6(5),e.Oqu(i.email),e.xp6(5),e.Oqu(i.UserMobile),e.xp6(5),e.Oqu(i.userAddress),e.xp6(5),e.AsE("",e.lcZ(53,20,"HTML.LastSeen")," (",i.joinDate,")")}}const $=function(o,t){return{itemsPerPage:o,currentPage:t}};function ke(o,t){if(1&o&&(e.TgZ(0,"div",17),e.YNc(1,Ye,54,22,"div",18),e.ALo(2,"paginate"),e.ALo(3,"EmpSearchPipe"),e.qZA()),2&o){const i=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,e.xi3(3,4,i.users,i.searchText),e.WLB(7,$,i.count,i.page)))}}function Qe(o,t){if(1&o&&(e.TgZ(0,"h3",39),e._uU(1),e.qZA()),2&o){const i=e.oxw().$implicit;e.xp6(1),e.AsE("",i.first_name," ",i.last_name,"")}}function je(o,t){1&o&&(e.TgZ(0,"h3",39),e._uU(1,"User blocked"),e.qZA())}function Ke(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const a=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.openUserDialog(a))}),e.TgZ(1,"mat-icon"),e._uU(2,"mode_edit"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.VIEW")))}function Ge(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const a=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.deleteUser(a))}),e.TgZ(1,"mat-icon"),e._uU(2,"delete"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.REMOVE")))}function $e(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const a=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.openBuildingDialog(a))}),e.TgZ(1,"mat-icon"),e._uU(2,"business"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.Building")))}function We(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const a=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.openUserPermission(a.id))}),e.TgZ(1,"mat-icon"),e._uU(2,"security"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.Security")))}function Xe(o,t){if(1&o&&e._UZ(0,"img",41),2&o){const i=e.oxw().$implicit;e.ekj("blocked",1==i.RowDelete),e.Q6J("src",i.userPicture,e.LSH)}}function ze(o,t){if(1&o&&e._UZ(0,"img",52),2&o){const i=e.oxw().$implicit;e.ekj("blocked",1==i.RowDelete)}}function Ve(o,t){1&o&&(e.TgZ(0,"mat-icon",43),e._uU(1,"block"),e.qZA())}function et(o,t){1&o&&(e.TgZ(0,"mat-icon",38),e._uU(1,"person_outline"),e.qZA())}function tt(o,t){1&o&&(e.TgZ(0,"mat-icon",38),e._uU(1,"person"),e.qZA())}function it(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",45)(1,"mat-card")(2,"div",20),e.YNc(3,Qe,2,2,"h3",21),e.YNc(4,je,2,0,"h3",21),e.TgZ(5,"button",22,23)(7,"mat-icon"),e._uU(8,"more_vert"),e.qZA()()(),e.TgZ(9,"mat-menu",24,25)(11,"span",26),e.NdJ("mouseleave",function(){e.CHM(i);const a=e.MAs(6);return e.KtG(a.closeMenu())}),e.YNc(12,Ke,6,3,"button",27),e.YNc(13,Ge,6,3,"button",27),e._UZ(14,"mat-divider"),e.YNc(15,$e,6,3,"button",27),e.YNc(16,We,6,3,"button",27),e.qZA()(),e.TgZ(17,"div",28)(18,"div",46)(19,"div",30),e.YNc(20,Xe,1,3,"img",31),e.YNc(21,ze,1,2,"img",47),e.YNc(22,Ve,2,0,"mat-icon",33),e.qZA(),e.TgZ(23,"div",34)(24,"mat-slide-toggle",35),e.NdJ("change",function(){const r=e.CHM(i).$implicit;return e.KtG(r.RowDelete=!r.RowDelete)}),e.qZA()()(),e.TgZ(25,"div",48)(26,"div",49)(27,"p",37)(28,"mat-icon",38),e._uU(29,"card_membership"),e.qZA(),e.TgZ(30,"span"),e._uU(31),e.qZA()()(),e.TgZ(32,"div",49)(33,"p",37)(34,"mat-icon",38),e._uU(35,"mail_outline"),e.qZA(),e.TgZ(36,"span"),e._uU(37),e.qZA()(),e.TgZ(38,"p",37)(39,"mat-icon",38),e._uU(40,"call"),e.qZA(),e.TgZ(41,"span"),e._uU(42),e.qZA()(),e.TgZ(43,"p",37)(44,"mat-icon",38),e._uU(45,"location_on"),e.qZA(),e.TgZ(46,"span"),e._uU(47),e.qZA()()(),e.TgZ(48,"div",50)(49,"p",37)(50,"mat-icon",38),e._uU(51,"event_available"),e.qZA(),e.TgZ(52,"span"),e._uU(53),e.ALo(54,"date"),e.qZA()(),e.TgZ(55,"p",37)(56,"mat-icon",38),e._uU(57,"date_range"),e.qZA(),e.TgZ(58,"span"),e._uU(59),e.ALo(60,"date"),e.qZA()(),e.TgZ(61,"p",37),e.YNc(62,et,2,0,"mat-icon",51),e.YNc(63,tt,2,0,"mat-icon",51),e.TgZ(64,"span"),e._uU(65),e.qZA()()()()()()()}if(2&o){const i=t.$implicit,n=e.MAs(10),a=e.oxw(2);e.xp6(3),e.Q6J("ngIf",0==i.RowDelete),e.xp6(1),e.Q6J("ngIf",1==i.RowDelete),e.xp6(1),e.Q6J("matMenuTriggerFor",n),e.xp6(7),e.Q6J("ngIf",a.can("view_oneemployee")),e.xp6(1),e.Q6J("ngIf",a.can("delete_employee")),e.xp6(2),e.Q6J("ngIf",a.can("view_emp_securitybuildings")),e.xp6(1),e.Q6J("ngIf",a.can("view_emp_securitypermissions")),e.xp6(4),e.Q6J("ngIf",i.userPicture),e.xp6(1),e.Q6J("ngIf",!i.userPicture),e.xp6(1),e.Q6J("ngIf",1==i.RowDelete),e.xp6(2),e.Q6J("checked",1==i.RowDelete),e.xp6(1),e.ekj("blocked",1==i.RowDelete),e.xp6(6),e.Oqu(i.userJobName),e.xp6(6),e.Oqu(i.email),e.xp6(5),e.Oqu(i.UserMobile),e.xp6(5),e.Oqu(i.userAddress),e.xp6(6),e.hij("Registration ",e.xi3(54,22,i.EntryDate,"dd MMMM, yyyy 'at' HH:mm"),""),e.xp6(6),e.hij("Joined ",e.xi3(60,25,i.joinedDate,"dd MMMM, yyyy 'at' HH:mm"),""),e.xp6(3),e.Q6J("ngIf",1==i.RowDelete),e.xp6(1),e.Q6J("ngIf",0==i.RowDelete),e.xp6(2),e.Oqu(1==i.RowDelete?"Blocked":"Active")}}function ot(o,t){if(1&o&&(e.TgZ(0,"div",17),e.YNc(1,it,66,28,"div",44),e.ALo(2,"paginate"),e.ALo(3,"EmpSearchPipe"),e.qZA()),2&o){const i=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,e.xi3(3,4,i.users,i.searchText),e.WLB(7,$,i.count,i.page)))}}function nt(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",17)(1,"div",45)(2,"mat-card",53)(3,"pagination-controls",54),e.NdJ("pageChange",function(a){e.CHM(i);const r=e.oxw();return e.KtG(r.onPageChanged(a))}),e.qZA()()()()}}function at(o,t){1&o&&(e.TgZ(0,"div",55),e._UZ(1,"mat-spinner",56),e.qZA())}class I{constructor(t,i,n,a,r,p){this.appSettings=t,this.dialog=i,this.router=n,this.global=a,this.localStore=r,this.usersService=p,this.count=9,this.account=new Ee.n,this.userPerm=[],this.employeesForDisplay={id:void 0,username:void 0,password:void 0,UserCode:void 0,first_name:void 0,last_name:void 0,UserBirthDate:void 0,EntryDate:void 0,joinedDate:void 0,joinDate:void 0,UserMobile:void 0,email:void 0,is_superuser:void 0,is_staff:void 0,is_active:void 0,is_employee:void 0,is_teacher:void 0,is_owner:void 0,is_customer:void 0,periorty:void 0,COMId:void 0,branch_KeyField:void 0,userPicture:void 0,gender:void 0,RowDelete:void 0,LoginFrom:void 0,userJobName:void 0,userFacebook:void 0,userTwitter:void 0,userGoogle:void 0,userAddress:void 0,is_from_customer_table:void 0,customer_KeyField:void 0},this.settings=this.appSettings.settings}ngOnDestroy(){this.userSUb&&this.userSUb.unsubscribe()}ngOnInit(){if(this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curCOMId=this.curUserData.COMId,this.appSetup=JSON.parse(this.localStore.getItem("appsetup")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.getUsers()}}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getUsers(){this.users=null,this.curUserData.is_superuser?this.usersService.getAllStaff(this.curCOMId).subscribe(t=>{this.users=t}):this.usersService.getStaffPerBranch(this.curCOMId,this.account.periorty,this.curUserData.branch_KeyField).subscribe(t=>{this.users=t})}addUser(t,i){console.log("====inside addUser== ==="),this.usersService.addEmployee(t,i).subscribe(n=>this.getUsers())}updateUser(t,i){console.log("====inside updateTenant====="),console.log(t),this.usersService.editEmployee(t,i).subscribe(n=>{console.log("/*-/*-/*-"+n.is_active+"-*/-*/-*/"),this.getUsers()})}changePassword(t){this.dialog.open(Me.p,{data:{dataRow:t,curUserData:this.curUserData,userPerm:this.userPerm,pk:t.id},panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr"}).afterClosed().subscribe(n=>{})}deleteUser(t){this.usersService.deleteOneUser(t.id).subscribe(i=>this.getUsers())}onPageChanged(t){this.page=t,this.getUsers(),window.scrollTo(0,0)}openUserDialog(t){this.dialog.open(E,{data:t}).afterClosed().subscribe(n=>{"Cancel"==n.event||("Patch"==n.event?(this.mapFormvalue_to_EmpClass(n.data,"Patch"),this.updateUser(this.employeesForDisplay,n.empPic)):"Post"==n.event&&(this.mapFormvalue_to_EmpClass(n.data,"Post"),this.addUser(this.employeesForDisplay,n.empPic)))})}openBuildingDialog(t){this.dialog.open(M,{data:t,panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr"}).afterClosed().subscribe(n=>{})}openSecurityDialog(t){this.dialog.open(Ue.y,{data:t}).afterClosed().subscribe(n=>{})}openUserPermission(t){this.router.navigate(["/settings/permissions-all/"+t+"/"])}toDateString(t){return t.getFullYear().toString()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)+"T"+t.toTimeString().slice(0,5)}formatDate(t){const i=new Date;let n=""+(i.getMonth()+1),a=""+i.getDate();const r=i.getFullYear();return n.length<2&&(n="0"+n),a.length<2&&(a="0"+a),[r,n,a].join("-")}mapFormvalue_to_EmpClass(t,i){console.log(t),console.log("=================formValue==========================");const n=new c.uU("en-GB").transform(t.UserBirthDate,"dd/MM/yyyy");this.is_Employee=t.work.is_employee?"T":"F",this.empDeleted=t.settings.isDeleted?1:0,this.employeesForDisplay.id=t.id,this.employeesForDisplay.username=t.username,this.employeesForDisplay.password=t.password,this.employeesForDisplay.UserCode=t.UserCode,this.employeesForDisplay.first_name=t.first_name,this.employeesForDisplay.last_name=t.last_name,this.employeesForDisplay.userPicture=t.userPicture,this.employeesForDisplay.gender=t.gender,null!=t.UserBirthDate&&(this.employeesForDisplay.UserBirthDate=n),this.employeesForDisplay.userJobName=t.work.userJobName,this.employeesForDisplay.branch_KeyField=t.work.branch_KeyField,this.employeesForDisplay.is_superuser=t.work.is_superuser,this.employeesForDisplay.is_staff=t.work.is_staff,this.employeesForDisplay.is_active=t.work.is_active,this.employeesForDisplay.is_employee=this.is_Employee,this.employeesForDisplay.email=t.contacts.email,this.employeesForDisplay.UserMobile=t.contacts.UserMobile,this.employeesForDisplay.userAddress=t.contacts.userAddress,this.employeesForDisplay.RowDelete=this.empDeleted}}I.\u0275fac=function(t){return new(t||I)(e.Y36(H.d),e.Y36(u.uw),e.Y36(F.F0),e.Y36(j.U),e.Y36(d.C),e.Y36(m.K))},I.\u0275cmp=e.Xpm({type:I,selectors:[["app-employee-list"]],features:[e._Bn([m.K])],decls:25,vars:11,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click",4,"ngIf"],["value","search"],[1,"user-search"],[1,"user-search-input"],["matInput","","name","search","autocomplete","off",3,"placeholder","ngModel","ngModelChange"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","grid"],["viewType","matButtonToggleGroup"],["value","grid"],["value","list"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],["value","add",3,"click"],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-md","33.3","fxFlex.md","50","class","p-2",4,"ngFor","ngForOf"],["fxFlex","100","fxFlex.gt-md","33.3","fxFlex.md","50",1,"p-2"],["fxLayout","row","fxLayoutAlign","space-between center",1,"bg-primary"],["class","user-name",4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["menuTrigger","matMenuTrigger"],["xPosition","before","overlapTrigger","true"],["menu","matMenu"],[3,"mouseleave"],["mat-menu-item","",3,"click",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-around center",1,"user-content"],["fxFlex","30","fxLayout","column","fxLayoutAlign","center center"],[1,"user-img"],["class","transition-2",3,"src","blocked",4,"ngIf"],["src","assets/images/others/user.jpg","class","transition-2",3,"blocked",4,"ngIf"],["color","warn",4,"ngIf"],[1,"user-social"],["color","primary",3,"checked","change"],["fxFlex","70","fxLayout","column",1,"user-details","transition-2"],["fxLayout","row","fxLayoutAlign","start center"],[1,"text-muted"],[1,"user-name"],["mat-menu-item","",3,"click"],[1,"transition-2",3,"src"],["src","assets/images/others/user.jpg",1,"transition-2"],["color","warn"],["fxFlex","100","class","p-2",4,"ngFor","ngForOf"],["fxFlex","100",1,"p-2"],["fxFlex","20","fxFlex.xs","30","fxLayout","column","fxLayoutAlign","center center"],["src","assets/img/users/default-user.jpg","class","transition-2",3,"blocked",4,"ngIf"],["fxFlex","80","fxFlex.xs","70","fxLayout","row","fxLayout.xs","column",1,"user-details","transition-2"],["fxFlex","30","fxFlex.xs","100","fxLayout","column"],["fxFlex","40","fxFlex.xs","100","fxLayout","column"],["class","text-muted",4,"ngIf"],["src","assets/img/users/default-user.jpg",1,"transition-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-button-toggle-group",2,3),e.YNc(4,De,3,0,"mat-button-toggle",4),e.TgZ(5,"mat-button-toggle",5)(6,"mat-icon"),e._uU(7,"search"),e.qZA()()()(),e.TgZ(8,"form",6)(9,"mat-form-field",7)(10,"input",8),e.NdJ("ngModelChange",function(a){return i.searchText=a}),e.ALo(11,"translate"),e.qZA()()(),e.TgZ(12,"div",9)(13,"mat-button-toggle-group",10,11)(15,"mat-button-toggle",12)(16,"mat-icon"),e._uU(17,"view_module"),e.qZA()(),e.TgZ(18,"mat-button-toggle",13)(19,"mat-icon"),e._uU(20,"view_list"),e.qZA()()()()(),e.YNc(21,ke,4,10,"div",14),e.YNc(22,ot,4,10,"div",14),e.YNc(23,nt,4,0,"div",14),e.YNc(24,at,2,0,"div",15)),2&t){const n=e.MAs(3),a=e.MAs(14);e.xp6(4),e.Q6J("ngIf",i.can("add_employee")),e.xp6(4),e.ekj("show","search"==n.value),e.xp6(2),e.s9C("placeholder",e.lcZ(11,9,"HTML.SEARCH_Employee")),e.Q6J("ngModel",i.searchText),e.xp6(11),e.Q6J("ngIf","grid"==a.value),e.xp6(1),e.Q6J("ngIf","list"==a.value),e.xp6(1),e.Q6J("ngIf",i.users),e.xp6(1),e.Q6J("ngIf",!i.users)}},dependencies:[c.sg,c.O5,l._Y,l.Fj,l.JJ,l.JL,l.On,l.F,B.LS,f.xw,f.Wh,f.yH,y.RK,K.A9,K.Yi,Z.a8,w.Hw,S.Nt,_.KE,Q.d,R.VK,R.OP,R.p6,G.Ou,Ie.Rr,c.uU,B._s,U.X$,qe.mo],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}\n"],encapsulation:2});var st=s(529),rt=s(7781),lt=s(9045),mt=s(8746),ct=s(3162);function pt(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(i);const a=e.MAs(4);return e.KtG(a.click())}),e.TgZ(1,"mat-icon"),e._uU(2,"photo_camera"),e.qZA(),e.TgZ(3,"input",32,33),e.NdJ("change",function(a){e.CHM(i);const r=e.oxw(2);return e.KtG(r.onFileSelected(a))}),e.qZA()()}}function ut(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Please enter a valid email"),e.qZA())}function dt(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"ERROR.REQUIRED_FIRST_NAME")))}function _t(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"ERROR.REQUIRED_LAST_NAME")))}function gt(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"ERROR.INVALID_MOBILE")))}function ft(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",34)(1,"button",35),e.NdJ("click",function(){e.CHM(i);const a=e.oxw(2);return e.KtG(a.toggleEdit())}),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.hij(" ",e.lcZ(5,1,"BTN.EDIT")," "))}function ht(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",34)(1,"button",36)(2,"mat-icon"),e._uU(3,"save"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"button",37),e.NdJ("click",function(){e.CHM(i);const a=e.oxw(2);return e.KtG(a.cancelEdit())}),e.TgZ(7,"mat-icon"),e._uU(8,"cancel"),e.qZA(),e._uU(9),e.ALo(10,"translate"),e.qZA()()}if(2&o){const i=e.oxw(2);e.xp6(1),e.Q6J("disabled",i.profileForm.invalid),e.xp6(3),e.hij(" ",e.lcZ(5,3,"BTN.SAVE")," "),e.xp6(5),e.hij(" ",e.lcZ(10,5,"BTN.CANCEL")," ")}}function Zt(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",2)(1,"mat-card",3)(2,"mat-card-header")(3,"div",4),e._UZ(4,"img",5),e.YNc(5,pt,5,0,"button",6),e.qZA(),e.TgZ(6,"mat-card-title"),e._uU(7),e.qZA(),e.TgZ(8,"mat-card-subtitle"),e._uU(9),e.qZA()(),e.TgZ(10,"mat-card-content")(11,"form",7),e.NdJ("ngSubmit",function(){e.CHM(i);const a=e.oxw();return e.KtG(a.onSubmit())}),e.TgZ(12,"div",8)(13,"mat-form-field",9)(14,"mat-label")(15,"mat-icon"),e._uU(16,"person"),e.qZA(),e._uU(17),e.ALo(18,"translate"),e.qZA(),e._UZ(19,"input",10),e.qZA(),e.TgZ(20,"mat-form-field",9)(21,"mat-label"),e._uU(22),e.ALo(23,"translate"),e.qZA(),e._UZ(24,"input",11),e.YNc(25,ut,2,0,"mat-error",12),e.qZA()(),e.TgZ(26,"div",8)(27,"mat-form-field",9)(28,"mat-label")(29,"mat-icon"),e._uU(30,"person"),e.qZA(),e._uU(31),e.ALo(32,"translate"),e.qZA(),e._UZ(33,"input",13),e.YNc(34,dt,3,3,"mat-error",12),e.qZA(),e.TgZ(35,"mat-form-field",9)(36,"mat-label")(37,"mat-icon"),e._uU(38,"person"),e.qZA(),e._uU(39),e.ALo(40,"translate"),e.qZA(),e._UZ(41,"input",14),e.YNc(42,_t,3,3,"mat-error",12),e.qZA()(),e.TgZ(43,"div",8)(44,"mat-form-field",9)(45,"mat-label"),e._uU(46),e.ALo(47,"translate"),e.qZA(),e._UZ(48,"input",15),e.YNc(49,gt,3,3,"mat-error",12),e.qZA(),e.TgZ(50,"mat-form-field",9)(51,"mat-label"),e._uU(52),e.ALo(53,"translate"),e.qZA(),e._UZ(54,"input",16),e.qZA()(),e.TgZ(55,"div",8)(56,"mat-form-field",9)(57,"mat-label"),e._uU(58),e.ALo(59,"translate"),e.qZA(),e.TgZ(60,"mat-select",17)(61,"mat-option",18),e._uU(62),e.ALo(63,"translate"),e.qZA(),e.TgZ(64,"mat-option",19),e._uU(65),e.ALo(66,"translate"),e.qZA()()(),e.TgZ(67,"mat-form-field",9)(68,"mat-label"),e._uU(69),e.ALo(70,"translate"),e.qZA(),e._UZ(71,"input",20)(72,"mat-datepicker-toggle",21)(73,"mat-datepicker",null,22),e.qZA()(),e.TgZ(75,"mat-form-field",23)(76,"mat-label"),e._uU(77),e.ALo(78,"translate"),e.qZA(),e._UZ(79,"textarea",24),e.qZA(),e.YNc(80,ft,6,3,"div",25),e.YNc(81,ht,11,7,"div",25),e.qZA()()(),e.TgZ(82,"div",26)(83,"mat-card")(84,"mat-card-header")(85,"mat-card-title"),e._uU(86),e.ALo(87,"translate"),e.qZA()(),e.TgZ(88,"mat-card-content"),e._UZ(89,"mat-progress-bar",27),e.TgZ(90,"div",28),e._uU(91),e.qZA()()(),e.TgZ(92,"mat-card")(93,"mat-card-header")(94,"mat-card-title"),e._uU(95),e.ALo(96,"translate"),e.qZA()(),e.TgZ(97,"mat-card-content")(98,"div",29)(99,"mat-icon"),e._uU(100,"person"),e.qZA(),e.TgZ(101,"span"),e._uU(102),e.ALo(103,"translate"),e.TgZ(104,"span",30),e._uU(105),e.ALo(106,"date"),e.qZA()()(),e.TgZ(107,"div",29)(108,"mat-icon"),e._uU(109,"verified_user"),e.qZA(),e.TgZ(110,"span"),e._uU(111),e.ALo(112,"translate"),e.TgZ(113,"span",30),e._uU(114),e.ALo(115,"translate"),e.ALo(116,"translate"),e.qZA()()(),e.TgZ(117,"div",29)(118,"mat-icon"),e._uU(119,"security"),e.qZA(),e.TgZ(120,"span"),e._uU(121),e.ALo(122,"translate"),e.TgZ(123,"span",30),e._uU(124),e.ALo(125,"translate"),e.ALo(126,"translate"),e.ALo(127,"translate"),e.ALo(128,"translate"),e.qZA()()()()()()()}if(2&o){const i=e.MAs(74),n=e.oxw();e.xp6(4),e.Q6J("src",n.profileImage||"assets/images/others/user.jpg",e.LSH),e.xp6(1),e.Q6J("ngIf",n.isEditing),e.xp6(2),e.AsE("",n.profileForm.get("first_name").value," ",n.profileForm.get("last_name").value,""),e.xp6(2),e.Oqu(n.profileForm.get("userJobName").value),e.xp6(2),e.Q6J("formGroup",n.profileForm),e.xp6(6),e.hij(" ",e.lcZ(18,36,"HTML.USERNAME"),""),e.xp6(5),e.Oqu(e.lcZ(23,38,"HTML.EMAIL")),e.xp6(3),e.Q6J("ngIf",n.profileForm.get("email").invalid),e.xp6(6),e.hij(" ",e.lcZ(32,40,"HTML.FIRST_NAME"),""),e.xp6(3),e.Q6J("ngIf",n.profileForm.get("first_name").invalid),e.xp6(5),e.hij(" ",e.lcZ(40,42,"HTML.LAST_NAME"),""),e.xp6(3),e.Q6J("ngIf",n.profileForm.get("last_name").invalid),e.xp6(4),e.Oqu(e.lcZ(47,44,"HTML.MOBILE")),e.xp6(3),e.Q6J("ngIf",n.profileForm.get("UserMobile").invalid),e.xp6(3),e.Oqu(e.lcZ(53,46,"HTML.Job")),e.xp6(6),e.Oqu(e.lcZ(59,48,"HTML.GENDER")),e.xp6(4),e.Oqu(e.lcZ(63,50,"HTML.MALE")),e.xp6(3),e.Oqu(e.lcZ(66,52,"HTML.FEMALE")),e.xp6(4),e.Oqu(e.lcZ(70,54,"HTML.BIRTH_DATE")),e.xp6(2),e.Q6J("matDatepicker",i)("max",n.maxDate),e.xp6(1),e.Q6J("for",i),e.xp6(5),e.Oqu(e.lcZ(78,56,"HTML.ADDRESS")),e.xp6(3),e.Q6J("ngIf",!n.isEditing),e.xp6(1),e.Q6J("ngIf",n.isEditing),e.xp6(5),e.Oqu(e.lcZ(87,58,"HTML.ProfileCompletion")),e.xp6(3),e.Q6J("value",n.calculateProfileCompletion()),e.xp6(2),e.hij("",n.calculateProfileCompletion(),"%"),e.xp6(4),e.Oqu(e.lcZ(96,60,"HTML.AccountDetails")),e.xp6(7),e.hij("",e.lcZ(103,62,"HTML.MemberSince"),": "),e.xp6(3),e.Oqu(e.lcZ(106,64,null==n.employee?null:n.employee.joinedDate)),e.xp6(6),e.hij("",e.lcZ(112,66,"HTML.Status"),": "),e.xp6(3),e.hij(" ",null!=n.employee&&n.employee.is_active?e.lcZ(115,68,"HTML.ACTIVE"):e.lcZ(116,70,"HTML.BLOCKED")," "),e.xp6(7),e.hij("",e.lcZ(122,72,"HTML.Role"),": "),e.xp6(3),e.Oqu(null!=n.employee&&n.employee.is_superuser?e.lcZ(125,74,"HTML.IsSUPERUSER"):null!=n.employee&&n.employee.is_employee?e.lcZ(126,76,"HTML.IsEMPLOYEE"):null!=n.employee&&n.employee.is_owner?e.lcZ(127,78,"HTML.IsOwner"):e.lcZ(128,80,"HTML.IsTenant"))}}function xt(o,t){1&o&&(e.TgZ(0,"div",38),e._UZ(1,"mat-spinner",39),e.TgZ(2,"p"),e._uU(3,"Loading profile..."),e.qZA()())}class q{constructor(t,i,n,a,r,p,x,T){this.userService=t,this.global=i,this.localStore=n,this.fb=a,this.snackBar=r,this.datePipe=p,this.router=x,this.route=T,this.isLoading=!0,this.isEditing=!1,this.profileImage="assets/images/others/user.jpg",this.maxDate=new Date,this.maxFileSize=1048576,this.allowedTypes=["image/jpeg","image/png","image/gif"],this.maxDate.setFullYear(this.maxDate.getFullYear()-18),this.createForm()}ngOnInit(){this.userId=this.global.me?.id||parseInt(this.localStore.getItem("userId")),this.userId?this.loadProfile():this.router.navigate(["/sign-in"])}createForm(){this.profileForm=this.fb.group({username:[{value:"",disabled:!0}],first_name:["",l.kI.required],last_name:["",l.kI.required],email:["",[l.kI.required,l.kI.email]],UserMobile:["",l.kI.required],userJobName:[""],gender:[""],UserBirthDate:[""],userAddress:[""],branch_KeyField:[""]})}loadProfile(){this.isLoading=!0,this.userService.getOneUser(this.userId).subscribe(t=>{this.employee=t,this.setProfileImage(),this.populateForm(),this.isLoading=!1},t=>{this.snackBar.open("Failed to load profile","Dismiss",{duration:3e3}),this.isLoading=!1})}setProfileImage(){if(this.employee.userPicture)if("string"==typeof this.employee.userPicture)this.profileImage=this.employee.userPicture;else{const t=new FileReader;t.onload=i=>{this.profileImage=i.target.result,t.onload=null},t.readAsDataURL(this.employee.userPicture)}else this.profileImage="assets/images/others/user.jpg"}populateForm(){const t=this.employee.UserBirthDate?this.datePipe.transform(new Date(this.employee.UserBirthDate.toString()),"yyyy-MM-dd"):null;this.profileForm.patchValue({username:this.employee.username,first_name:this.employee.first_name,last_name:this.employee.last_name,email:this.employee.email,UserMobile:this.employee.UserMobile,userJobName:this.employee.userJobName,gender:this.employee.gender,UserBirthDate:t,userAddress:this.employee.userAddress,branch_KeyField:this.employee.branch_KeyField})}toggleEdit(){this.isEditing=!this.isEditing,this.isEditing?this.profileForm.enable():(this.profileForm.disable(),this.profileForm.get("username").disable())}onFileSelected(t){const i=t.target.files[0];if(i){if(!this.allowedTypes.includes(i.type))return void this.snackBar.open("Only JPG, PNG or GIF images are allowed","Dismiss",{duration:3e3});if(i.size>this.maxFileSize)return void this.snackBar.open("Image must be smaller than 1MB","Dismiss",{duration:3e3});this.compressImage(i).then(n=>{this.fileToUpload=n;const a=new FileReader;a.onload=r=>{this.profileImage=r.target.result,a.onload=null},a.readAsDataURL(n)})}}compressImage(t){return new Promise(i=>{const n=new FileReader;n.onload=a=>{const r=new Image;r.src=a.target.result,r.onload=()=>{const p=document.createElement("canvas"),x=p.getContext("2d");let A=r.width,v=r.height;A>v?A>800&&(v*=800/A,A=800):v>800&&(A*=800/v,v=800),p.width=A,p.height=v,x.drawImage(r,0,0,A,v),p.toBlob(Tt=>{i(new File([Tt],t.name,{type:"image/jpeg",lastModified:Date.now()}))},"image/jpeg",.7)}},n.readAsDataURL(t)})}onSubmit(){if(this.profileForm.invalid)return;this.isLoading=!0;const t=new FormData;t.append("id",this.userId.toString()),Object.keys(this.profileForm.value).forEach(i=>{const n=this.profileForm.value[i];if(null!=n)if("UserBirthDate"===i&&n){const a=this.datePipe.transform(n,"yyyy-MM-dd");t.append(i,a)}else t.append(i,n)}),this.fileToUpload&&t.append("userPicture",this.fileToUpload),this.userService.editEmployeeProfile(t).pipe((0,mt.x)(()=>{this.isLoading=!1})).subscribe({next:i=>{this.snackBar.open("Profile updated successfully","Dismiss",{duration:3e3}),this.isEditing=!1,this.profileForm.disable(),this.profileForm.get("username").disable(),this.loadProfile()},error:i=>{this.snackBar.open("Failed to update profile","Dismiss",{duration:3e3}),console.error("Profile update error:",i)}})}cancelEdit(){this.populateForm(),this.isEditing=!1,this.profileForm.disable(),this.profileForm.get("username").disable(),this.fileToUpload=null,this.setProfileImage()}calculateProfileCompletion(){if(!this.employee)return 0;const t=[this.employee.first_name,this.employee.last_name,this.employee.email,this.employee.UserMobile,this.employee.userJobName,this.employee.gender,this.employee.UserBirthDate,this.employee.userAddress],i=t.filter(n=>!!n).length;return Math.round(i/t.length*100)}}q.\u0275fac=function(t){return new(t||q)(e.Y36(m.K),e.Y36(j.U),e.Y36(d.C),e.Y36(l.qu),e.Y36(L.ux),e.Y36(c.uU),e.Y36(F.F0),e.Y36(F.gz))},q.\u0275cmp=e.Xpm({type:q,selectors:[["app-profile"]],features:[e._Bn([c.uU])],decls:3,vars:2,consts:[["class","profile-container",4,"ngIf","ngIfElse"],["loading",""],[1,"profile-container"],[1,"profile-card"],["mat-card-avatar","",1,"profile-image-container"],["alt","Profile Image",1,"profile-image",3,"src"],["mat-mini-fab","","color","primary","class","upload-btn",3,"click",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"form-row"],["appearance","outline"],["matInput","","formControlName","username","readonly",""],["matInput","","formControlName","email","type","email"],[4,"ngIf"],["matInput","","formControlName","first_name"],["matInput","","formControlName","last_name"],["matInput","","formControlName","UserMobile"],["matInput","","formControlName","userJobName"],["formControlName","gender"],["value","M"],["value","F"],["matInput","","formControlName","UserBirthDate",3,"matDatepicker","max"],["matSuffix","",3,"for"],["picker",""],["appearance","outline",1,"full-width"],["matInput","","formControlName","userAddress","rows","2"],["class","actions",4,"ngIf"],[1,"profile-stats"],["mode","determinate",3,"value"],[1,"completion-percentage"],[1,"detail-item"],[1,"status-text"],["mat-mini-fab","","color","primary",1,"upload-btn",3,"click"],["type","file","accept","image/*","hidden","",3,"change"],["fileInput",""],[1,"actions"],["mat-raised-button","","color","primary","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","type","button",1,"cancel-btn",3,"click"],[1,"loading-spinner"],["diameter","50"]],template:function(t,i){if(1&t&&(e.YNc(0,Zt,129,82,"div",0),e.YNc(1,xt,4,0,"ng-template",null,1,e.W1O)),2&t){const n=e.MAs(2);e.Q6J("ngIf",!i.isLoading)("ngIfElse",n)}},dependencies:[c.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,P.ey,y.lW,y.nh,Z.a8,Z.kc,Z.dn,Z.dk,Z.$j,Z.n5,b.Mq,b.hl,b.nW,w.Hw,S.Nt,_.KE,_.hX,_.TO,_.R9,ct.pW,G.Ou,J.gD,c.uU,U.X$],styles:[".profile-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px;padding:20px;max-width:1200px;margin:0 auto}.profile-card[_ngcontent-%COMP%]{flex:1 1 600px;min-width:300px}.profile-stats[_ngcontent-%COMP%]{flex:1 1 300px;display:flex;flex-direction:column;gap:20px}.profile-image-container[_ngcontent-%COMP%]{position:relative;width:80px;height:80px;margin-right:16px}.profile-image[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;object-fit:cover;border:2px solid #f5f5f5}.upload-btn[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;transform:translate(25%,25%)}.status-text[_ngcontent-%COMP%]{font-weight:700;color:#2196f3;font-size:1.1em;margin-left:4px}.form-row[_ngcontent-%COMP%]{display:flex;gap:15px;margin-bottom:15px}.full-width[_ngcontent-%COMP%]{width:100%}.actions[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:20px}.cancel-btn[_ngcontent-%COMP%]{background-color:#f5f5f5}.detail-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin:10px 0}.completion-percentage[_ngcontent-%COMP%]{text-align:center;margin-top:5px;font-weight:700}.loading-spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;gap:15px}@media (max-width: 768px){.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:0}}"]});const W=[{path:"",redirectTo:"employee",pathMatch:"full"},{path:"employee",component:I,pathMatch:"full",data:{breadcrumb:"Employees"}},{path:"profile",component:q,data:{breadcrumb:"MyProfile"}}];class C{}C.\u0275fac=function(t){return new(t||C)},C.\u0275mod=e.oAB({type:C}),C.\u0275inj=e.cJS({imports:[c.ez,st.JF,F.Bz.forChild(W),l.u5,l.UX,B.JX,rt.m,lt.D]})},2887:(X,N,s)=>{s.d(N,{$:()=>h});var c=s(5412),m=s(4650),u=s(1576),l=s(4859),O=s(3081);class h{constructor(g,d){this.dialogRef=g,this.data=d}ngOnInit(){}onConfirm(){this.dialogRef.close(!0)}onDismiss(){this.dialogRef.close(!1)}}h.\u0275fac=function(g){return new(g||h)(m.Y36(c.so),m.Y36(c.WI))},h.\u0275cmp=m.Xpm({type:h,selectors:[["app-confirm-dialog"]],decls:13,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(g,d){1&g&&(m.TgZ(0,"h1",0),m._uU(1),m.qZA(),m.TgZ(2,"div",1)(3,"p"),m._uU(4),m.qZA()(),m.TgZ(5,"div",2)(6,"div",3)(7,"button",4),m.NdJ("click",function(){return d.onDismiss()}),m._uU(8),m.ALo(9,"translate"),m.qZA(),m.TgZ(10,"button",5),m.NdJ("click",function(){return d.onConfirm()}),m._uU(11),m.ALo(12,"translate"),m.qZA()()()),2&g&&(m.xp6(1),m.Oqu(null==d.data?null:d.data.title),m.xp6(3),m.Oqu(null==d.data?null:d.data.message),m.xp6(4),m.Oqu(m.lcZ(9,4,"BTN.NO")),m.xp6(3),m.Oqu(m.lcZ(12,6,"BTN.YES")))},dependencies:[u.xw,u.Wh,l.lW,c.uh,c.xY,c.H8,O.X$]})}}]);