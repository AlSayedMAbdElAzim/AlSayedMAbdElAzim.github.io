"use strict";(self.webpackChunkemporium=self.webpackChunkemporium||[]).push([[67],{6067:(re,k,u)=>{u.r(k),u.d(k,{PaymentsModule:()=>q,routes:()=>oe});var h=u(6895),b=u(2340),T=u(5783),_=u(8910),Z=u(2887),v=u(4459),e=u(4650),P=u(7298),C=u(1182),A=u(5412),m=u(9132),l=u(7465),d=u(5298),o=u(4165),a=u(8959),F=u(3081),R=u(7009),p=u(4006),N=u(4333),f=u(1576),U=u(4859),E=u(811),x=u(3546),Q=u(7392),J=u(4144),S=u(9549),G=u(4850),W=u(1572),$=u(266),X=u(1419);function se(r,t){if(1&r){const i=e.EpF();e.TgZ(0,"mat-button-toggle",21),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.gotoNewDocument())}),e.TgZ(1,"mat-icon"),e._uU(2,"note_add"),e.qZA()()}}const ne=function(r){return["/payments/receivable-add/",r]};function le(r,t){if(1&r&&(e.TgZ(0,"a",27),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA()()),2&r){const i=e.oxw().$implicit;e.s9C("matTooltip",e.lcZ(1,2,"BTN.VIEW")),e.Q6J("routerLink",e.VKq(4,ne,i.id))}}function ce(r,t){if(1&r){const i=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit,c=e.oxw();return e.KtG(c.removeDocument(n.id))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()}2&r&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.REMOVE"))}function ue(r,t){if(1&r&&(e.TgZ(0,"div",22)(1,"div",23),e._uU(2),e._UZ(3,"br"),e._uU(4),e.qZA(),e.TgZ(5,"div",23),e._uU(6),e.qZA(),e.TgZ(7,"div",23),e._uU(8),e.qZA(),e.TgZ(9,"div",23),e._uU(10),e.qZA(),e.TgZ(11,"div",23),e._uU(12),e.qZA(),e.TgZ(13,"div",23),e._uU(14),e.qZA(),e.TgZ(15,"div",23),e._uU(16),e.qZA(),e.TgZ(17,"div",23)(18,"div",24),e.YNc(19,le,4,6,"a",25),e.YNc(20,ce,4,3,"button",26),e.qZA()()()),2&r){const i=t.$implicit,s=e.oxw();e.Tol(s.statusColor[i.PDOValueInAccount]),e.xp6(2),e.Oqu(i.build_Name),e.xp6(2),e.Oqu(i.branch_ArbName),e.xp6(2),e.Oqu(i.unit_UnitNumber),e.xp6(2),e.hij(" ",i.customer_Name," "),e.xp6(2),e.hij(" ",i.PDODocDate," "),e.xp6(2),e.hij(" ",i.PDOValue," "),e.xp6(2),e.hij(" ",i.PDOPrintedCode," "),e.xp6(2),e.hij(" ",i.PDOEjarCode," "),e.xp6(3),e.Q6J("ngIf",s.can("view_onereceivable")),e.xp6(1),e.Q6J("ngIf",s.can("delete_onereceivable"))}}function pe(r,t){if(1&r){const i=e.EpF();e.TgZ(0,"div",29)(1,"div",30)(2,"mat-card",31)(3,"pagination-controls",32),e.NdJ("pageChange",function(n){e.CHM(i);const c=e.oxw();return e.KtG(c.onPageChanged(n))}),e.qZA()()()()}}function de(r,t){1&r&&(e.TgZ(0,"div",33),e._UZ(1,"mat-spinner",34),e.qZA())}const me=function(r,t){return{itemsPerPage:r,currentPage:t}};class V{constructor(t,i,s,n,c,g,D,y,O,L,H){this.transferService=t,this.appSettings=i,this.dialog=s,this.paymentService=n,this.router=c,this.global=g,this.localStore=D,this.settingService=y,this.contractService=O,this.translateService=L,this.snackBar=H,this.statusColor={T:"make-white",F:"make-gold"},this.curCOMId=b.N.comid,this.account=new T.n,this.count=4,this.userPerm=[],this.editReceivableDocCodeStatus=(new v.$).getEditReceivableDocCodeStatus(),this.editCode=!0,this.settings=this.appSettings.settings}ngOnInit(){if(this.securityForApp=(new v.$).getSecurityType(),this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.getParamValue(this.curCOMId,this.account.periorty,this.editReceivableDocCodeStatus),this.prepareMsgLanguage(),this.getDocuments()}else this.router.navigate(["/sign-in"])}getParamValue(t,i,s){this.settingService.getValueForCode(t,i,s).subscribe(n=>{s==this.editReceivableDocCodeStatus&&(this.editReceivableDocCodeValue=n[0].APAValue)},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u062e\u064a\u0627\u0631\u0627\u062a \u0627\u0644\u0646\u0638\u0627\u0645","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getDocuments(){this.documentsAll=null,this.curUserData.is_superuser?this.paymentService.getAllReceivableDocuments(this.curCOMId,this.account.periorty).subscribe(t=>this.documentsAll=t):1==this.curUserData.periorty&&("N"==this.securityForApp&&this.paymentService.getAllReceivableDocumentsPerBranch(this.curCOMId,this.account.periorty,this.curUserData.branch_KeyField).subscribe(t=>this.documentsAll=t),"D"==this.securityForApp&&this.paymentService.getAllReceivableDocumentsPerEmp(this.curCOMId,this.account.periorty,this.curUserData.id).subscribe(t=>this.documentsAll=t))}removeDocument(t){this.dialog.open(Z.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(s=>{s&&(this.paymentService.getOneDocs(t).subscribe(n=>{null!=n.installment_KeyField&&(this.oneDocValue=n.PDOValue,this.contractService.getOneInstallment(n.installment_KeyField).subscribe(c=>{this.curInstallmentValue=c.INSValue,this.curInstallmentPayedValue=c.INSPayedValue,null==this.curInstallmentValue&&(this.curInstallmentValue=0),null==this.curInstallmentPayedValue&&(this.curInstallmentPayedValue=0),this.manageInstallmetPayedValue(n.installment_KeyField,this.curInstallmentValue,this.curInstallmentPayedValue,this.oneDocValue)}))}),this.paymentService.deleteDocument(t).subscribe(n=>this.getDocuments()))})}manageInstallmetPayedValue(t,i,s,n){null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);let c=+s-+n;c<=0&&(c=0),this.insStatus=0==c?"N":"T";let g={id:t,INSStatus:this.insStatus,INSPayedValue:c};console.log("===installData:: "+g),this.contractService.editInstallments(g).subscribe(D=>{console.log("==installment after Update:: "+D)},D=>{console.log(D)})}onPageChanged(t){this.page=t,this.getDocuments(),window.scrollTo(0,0)}gotoNewDocument(){this.transferService.setMessage({editReceivableDocCode:this.editReceivableDocCodeValue}),this.router.navigate(["/payments/receivable-add/"])}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(t=>{this.errorRetrieveMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(t=>{this.deletedTitleMsg=t})}}V.\u0275fac=function(t){return new(t||V)(e.Y36(P.y),e.Y36(C.d),e.Y36(A.uw),e.Y36(_.c),e.Y36(m.F0),e.Y36(l.U),e.Y36(d.C),e.Y36(o.g),e.Y36(a.W),e.Y36(F.sK),e.Y36(R.ux))},V.\u0275cmp=e.Xpm({type:V,selectors:[["app-receivable-doc-list"]],features:[e._Bn([_.c])],decls:64,vars:43,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click",4,"ngIf"],["value","search"],[1,"user-search"],[1,"user-search-input"],["matInput","","name","search","autocomplete","off",3,"placeholder","ngModel","ngModelChange"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","list"],["viewType","matButtonToggleGroup"],["value","list"],["value","grid"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",3,"class",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],["value","add",3,"click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip",4,"ngIf"],["mat-mini-fab","","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100",1,"p-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-button-toggle-group",2,3),e.YNc(4,se,3,0,"mat-button-toggle",4),e.TgZ(5,"mat-button-toggle",5)(6,"mat-icon"),e._uU(7,"search"),e.qZA()()()(),e.TgZ(8,"form",6)(9,"mat-form-field",7)(10,"input",8),e.NdJ("ngModelChange",function(n){return i.searchText=n}),e.ALo(11,"translate"),e.qZA()()(),e.TgZ(12,"div",9)(13,"mat-button-toggle-group",10,11)(15,"mat-button-toggle",12)(16,"mat-icon"),e._uU(17,"view_list"),e.qZA()(),e.TgZ(18,"mat-button-toggle",13)(19,"mat-icon"),e._uU(20,"view_module"),e.qZA()()()()(),e._UZ(21,"mat-divider"),e.TgZ(22,"mat-card")(23,"div",14)(24,"h2"),e._uU(25),e.ALo(26,"translate"),e.qZA()(),e._UZ(27,"mat-divider"),e.TgZ(28,"div",15)(29,"div",16)(30,"div",17)(31,"h3"),e._uU(32),e.ALo(33,"translate"),e.qZA()(),e.TgZ(34,"div",17)(35,"h3"),e._uU(36),e.ALo(37,"translate"),e.qZA()(),e.TgZ(38,"div",17)(39,"h3"),e._uU(40),e.ALo(41,"translate"),e.qZA()(),e.TgZ(42,"div",17)(43,"h3"),e._uU(44),e.ALo(45,"translate"),e.qZA()(),e.TgZ(46,"div",17)(47,"h3"),e._uU(48),e.ALo(49,"translate"),e.qZA()(),e.TgZ(50,"div",17)(51,"h3"),e._uU(52),e.ALo(53,"translate"),e.qZA()(),e.TgZ(54,"div",17)(55,"h3"),e._uU(56),e.ALo(57,"translate"),e.qZA()(),e._UZ(58,"div",17),e.qZA(),e.YNc(59,ue,21,12,"div",18),e.ALo(60,"paginate"),e.ALo(61,"PayDocumentsSearchPipe"),e.qZA()(),e.YNc(62,pe,4,0,"div",19),e.YNc(63,de,2,0,"div",20)),2&t){const s=e.MAs(3);e.xp6(4),e.Q6J("ngIf",i.can("add_onereceivable")),e.xp6(4),e.ekj("show","search"==s.value),e.xp6(2),e.s9C("placeholder",e.lcZ(11,16,"HTML.SEARCH_PayDocument")),e.Q6J("ngModel",i.searchText),e.xp6(15),e.Oqu(e.lcZ(26,18,"HTML.ReceivableDoc_List")),e.xp6(7),e.hij(" ",e.lcZ(33,20,"HTML.BUILDING")," "),e.xp6(4),e.hij(" ",e.lcZ(37,22,"HTML.UnitNumber")," "),e.xp6(4),e.hij(" ",e.lcZ(41,24,"HTML.TENANT")," "),e.xp6(4),e.hij(" ",e.lcZ(45,26,"HTML.DocDate")," "),e.xp6(4),e.hij(" ",e.lcZ(49,28,"HTML.DocValue")," "),e.xp6(4),e.hij(" ",e.lcZ(53,30,"HTML.DocPrintedNo")," "),e.xp6(4),e.hij(" ",e.lcZ(57,32,"HTML.PayDocEjarCode")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(60,34,e.xi3(61,37,i.documentsAll,i.searchText),e.WLB(40,me,i.count,i.page))),e.xp6(3),e.Q6J("ngIf",i.documentsAll),e.xp6(1),e.Q6J("ngIf",!i.documentsAll)}},dependencies:[p._Y,p.Fj,p.JJ,p.JL,p.On,p.F,N.LS,h.sg,h.O5,m.rH,f.xw,f.Wh,f.yH,U.Tq,U.nh,E.A9,E.Yi,x.a8,Q.Hw,J.Nt,S.KE,G.d,W.Ou,$.gM,N._s,X.dg,F.X$],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}table{width:100%}.make-gold{background-color:#fbea96}.make-white{background-color:#fff}\n"],encapsulation:2});class ee{}var te=u(6381),ie=u(5726),he=u(3238),I=u(9602),ge=u(4385),Y=u(8796);function De(r,t){1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.ADD")))}function fe(r,t){1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function ye(r,t){if(1&r&&(e.TgZ(0,"ng-option",17),e._uU(1),e.qZA()),2&r){const i=t.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.CUSName,"")}}function _e(r,t){1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.SAVE")))}function be(r,t){1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function Te(r,t){if(1&r&&(e.TgZ(0,"div",32)(1,"button",33),e.YNc(2,_e,3,3,"span",1),e.YNc(3,be,3,3,"span",1),e.qZA()()),2&r){const i=e.oxw();e.xp6(1),e.Q6J("disabled",!i.docData_Form.valid),e.xp6(1),e.Q6J("ngIf",!i.payDocForDisplay.id),e.xp6(1),e.Q6J("ngIf",i.payDocForDisplay.id)}}class w{constructor(t,i,s,n,c,g,D,y,O,L,H,z,Ge){this.transferService=t,this.activatedRoute=i,this.localStore=s,this._companyService=n,this.global=c,this.router=g,this.snackBar=D,this.docsService=y,this.tenantsService=O,this.contractService=L,this.translateService=H,this.fb=z,this._formBuilder=Ge,this.curCOMId=b.N.comid,this.account=new T.n,this.editCode=!0,this.userPerm=[],this.curDocValue=0,this.curDocPayedValue=0,this.AllNotPayedInstallments=[],this.AllTenants=[]}ngOnInit(){if(this.transferService.getMessage.subscribe(t=>{this.editCode="YES"==t.editReceivableDocCode.toUpperCase(),console.log("---2222 this.editCode:: "+this.editCode)}),this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.getMaxCodeForPayment(this.curCOMId,this.account.periorty),this.getTenants(),this.sub=this.activatedRoute.params.subscribe(t=>{t.id?(this.id=+t.id,this.getDocById(this.id)):this.payDocForDisplay=new ee}),this.docData_Form=this.fb.group({id:null,PDOCode:{value:null,disabled:!this.editCode},PDOValue:{value:null,disabled:this.id},PDODocDate:null,PDODocType:"R",PDODocClassType:"A",PDOPayType:"E",PDOPayDate:null,PDOPrintedCode:null,PDODocSecondPerson:null,PDONotes:null,contract_KeyField:null,branch_KeyField:null,owner_KeyField:null,build_KeyField:null,unit_KeyField:null,installment_KeyField:null,customer_KeyField:null,PDOEjarCode:null})}else this.router.navigate(["/sign-in"])}getMaxCodeForPayment(t,i){this.docsService.getMaxReceivableCode(t,i).subscribe(s=>{this.maxPaymentCode=s.max,this.id||this.docData_Form.patchValue({PDOCode:this.maxPaymentCode})})}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getDocById(t){this.docsService.getOneDocs(t).subscribe(i=>{this.fillForm(i),this.payDocForDisplay=i})}fillForm(t){console.log("-----contract.PDODocType:: "+t.PDODocType),console.log("-----contract.PDOPayType:: "+t.PDOPayType),null!=t.PDODocDate&&(this.s_docDate=t.PDODocDate),this.docData_Form.patchValue({id:t.id,contract_KeyField:t.contract_KeyField,branch_KeyField:t.branch_KeyField,owner_KeyField:t.owner_KeyField,build_KeyField:t.build_KeyField,unit_KeyField:t.unit_KeyField,installment_KeyField:t.installment_KeyField,customer_KeyField:t.customer_KeyField,PDOCode:t.PDOCode,PDOValue:t.PDOValue,PDODocType:t.PDODocType,PDODocDate:t.PDODocDate,PDOPayType:t.PDOPayType,PDOPayDate:t.PDOPayDate,PDODocClassType:t.PDODocClassType,PDOPrintedCode:t.PDOPrintedCode,PDODocSecondPerson:t.PDODocSecondPerson,PDONotes:t.PDONotes,PDOEjarCode:t.PDOEjarCode})}searchByCode(t){console.log("---Search event:: "+t),this.tenantsService.getCustomerPerCode(this.curCOMId,this.account.periorty,+t).subscribe(i=>{i.length>0?(console.log("---id:: "+i[0].id),this.docData_Form.patchValue({customer_KeyField:i[0].id}),this.readCustumer(i[0].id)):(console.log("---Not---"),this.docData_Form.patchValue({customer_KeyField:null}))},i=>{console.log("----not found tenant----")})}readCustumer(t){console.log("====Selected readCustumer:: "+t),this.tenantsService.getOneCustomer(t).subscribe(i=>{console.log("==tenantName:: "+i.CUSName),console.log("==current_contract:: "+i.current_contract),this.docData_Form.patchValue({contract_KeyField:i.current_contract,PDODocSecondPerson:i.CUSName})}),this.getCustomerInstallmentsNotPayed(this.curCOMId,this.account.periorty,t)}getCustomerInstallmentsNotPayed(t,i,s){this.contractService.getInstallmentsPerCustomer_Payed(t,i,s,"F").subscribe(n=>{this.AllNotPayedInstallments=n,this.curOwnerId=n[0].owner_KeyField,this.curContract=n[0].contract_KeyField,this.curBranch=n[0].branch_KeyField,this.curBuild=n[0].build_KeyField,this.curUnit=n[0].unit_KeyField,this.curInstallment=n[0].id,this.curDocValue=n[0].INSValue,this.curDocPayedValue=n[0].INSPayedValue,null==this.curDocValue&&(this.curDocValue=0),null==this.curDocPayedValue&&(this.curDocPayedValue=0),this.docData_Form.patchValue({contract_KeyField:this.curContract,branch_KeyField:this.curBranch,build_KeyField:this.curBuild,unit_KeyField:this.curUnit,owner_KeyField:this.curOwnerId,installment_KeyField:this.curInstallment,PDOValue:this.curDocValue-this.curDocPayedValue})},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0623\u0642\u0633\u0627\u0637","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getTenants(){this.AllTenants=null,this.tenantsService.getCustomers(this.curCOMId,this.account.periorty).subscribe(t=>{this.AllTenants=t})}mappingFormValue_ToPayDocClass(){const t=new h.uU("en-GB").transform(this.docData_Form.value.PDODocDate,"dd/MM/yyyy"),i=new h.uU("en-GB").transform(this.docData_Form.value.PDOPayDate,"dd/MM/yyyy");this.payDocForDisplay.id=this.docData_Form.value.id,this.payDocForDisplay.contract_KeyField=this.docData_Form.value.contract_KeyField,this.payDocForDisplay.branch_KeyField=this.docData_Form.value.branch_KeyField,this.payDocForDisplay.owner_KeyField=this.docData_Form.value.owner_KeyField,this.payDocForDisplay.build_KeyField=this.docData_Form.value.build_KeyField,this.payDocForDisplay.unit_KeyField=this.docData_Form.value.unit_KeyField,this.payDocForDisplay.installment_KeyField=this.docData_Form.value.installment_KeyField,this.payDocForDisplay.customer_KeyField=this.docData_Form.value.customer_KeyField,null!=this.docData_Form.value.PDODocDate&&(this.payDocForDisplay.PDODocDate=t),this.payDocForDisplay.PDOPayType=this.docData_Form.value.PDOPayType,null!=this.docData_Form.value.PDOPayDate&&(this.payDocForDisplay.PDOPayDate=i),this.payDocForDisplay.PDOCode=this.docData_Form.value.PDOCode,this.payDocForDisplay.PDOValue=this.docData_Form.value.PDOValue,this.payDocForDisplay.PDODocType=this.docData_Form.value.PDODocType,this.payDocForDisplay.PDODocClassType=this.docData_Form.value.PDODocClassType,this.payDocForDisplay.PDOPrintedCode=this.docData_Form.value.PDOPrintedCode,this.payDocForDisplay.PDODocSecondPerson=this.docData_Form.value.PDODocSecondPerson,this.payDocForDisplay.PDONotes=this.docData_Form.value.PDONotes,this.payDocForDisplay.PDOEjarCode=this.docData_Form.value.PDOEjarCode}manageInstallmetPayedValue(t,i,s,n,c){null==s&&(s=0),null==n&&(n=0),null==i&&(i=0);let g=+s+ +n;console.log("===installmentPayedValue:: "+s),console.log("===docPayedValue:: "+n),console.log("===totalPayed:: "+g),this.insStatus=g<i?"T":"P";let D={id:t,INSStatus:this.insStatus,INSPayedValue:g,INSPayDate:c,INSPersonPayName:this.payDocForDisplay.PDODocSecondPerson};console.log("===installData:: "+D),this.contractService.editInstallments(D).subscribe(y=>{console.log("==installment after Update:: "+y)},y=>{console.log(y)})}saveEditDocData(t){const i=new h.uU("en-GB").transform(this.docData_Form.value.PDODocDate,"dd/MM/yyyy");this.mappingFormValue_ToPayDocClass(),t?this.docsService.editDoc(this.payDocForDisplay).subscribe(s=>{let n={contract_KeyField:s.contract_KeyField,branch_KeyField:s.branch_KeyField,owner_KeyField:s.owner_KeyField,build_KeyField:s.build_KeyField,unit_KeyField:s.unit_KeyField,installment_KeyField:s.installment_KeyField,customer_KeyField:s.customer_KeyField,TSTCreditValue:s.PDOValue,TSTDebitValue:0,TSTDate:s.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0642\u0628\u0636 \u0631\u0642\u0645 "+s.PDOCode,TSTSubject:"RECEIVABLE",TSTSubjectID:s.ID};this.contractService.deleteStatementForSubjectID(this.curCOMId,this.account.periorty,"RECEIVABLE",s.id).subscribe(c=>{this.contractService.addStatement(n).subscribe(g=>{})}),this.snackBar.open("\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/receivable-list"])},s=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}):this.docsService.addDoc(this.payDocForDisplay).subscribe(s=>{this.contractService.addStatement({contract_KeyField:s.contract_KeyField,branch_KeyField:s.branch_KeyField,owner_KeyField:s.owner_KeyField,build_KeyField:s.build_KeyField,unit_KeyField:s.unit_KeyField,installment_KeyField:s.installment_KeyField,customer_KeyField:s.customer_KeyField,TSTCreditValue:s.PDOValue,TSTDebitValue:0,TSTDate:s.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0642\u0628\u0636 \u0631\u0642\u0645 "+s.PDOCode,TSTSubject:"RECEIVABLE",TSTSubjectID:s.id}).subscribe(c=>{console.log("addStatement Done")},c=>{console.log("addStatement Error:: "+c)}),this.manageInstallmetPayedValue(this.curInstallment,this.curDocValue,this.curDocPayedValue,this.payDocForDisplay.PDOValue,i),this.snackBar.open("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/receivable-list"])},s=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u0627\u0636\u0627\u0641\u0647 \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(t=>{this.errorRetrieveMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t})}}w.\u0275fac=function(t){return new(t||w)(e.Y36(P.y),e.Y36(m.gz),e.Y36(d.C),e.Y36(te.J),e.Y36(l.U),e.Y36(m.F0),e.Y36(R.ux),e.Y36(_.c),e.Y36(ie.v),e.Y36(a.W),e.Y36(F.sK),e.Y36(p.qu),e.Y36(p.qu))},w.\u0275cmp=e.Xpm({type:w,selectors:[["app-receivable-doc-dialog"]],decls:105,vars:68,consts:[[1,"p-2"],[4,"ngIf"],[1,"pt-3"],["autocomplete","off","fxLayout","row wrap",3,"formGroup","ngSubmit"],["fxFlex","100","fxFlex.gt-sm","40",1,"px-2"],["width","400","height","300","id","campanyLogo",3,"src"],["fxFlex","100","fxFlex.gt-sm","60",1,"px-2"],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-sm","20",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","PDOCode"],["matInput","",3,"keyup.enter"],["tenCode",""],["fxFlex","100","fxFlex.gt-sm","40",1,"px-1"],["appearance","outline","formControlName","customer_KeyField",1,"w-100",3,"placeholder","change"],[3,"value",4,"ngFor","ngForOf"],["formControlName","PDOPayType","id","selfpaytypeOpSel",3,"placeholder"],[3,"value"],["fxFlex","100","fxFlex.gt-sm","25",1,"px-1"],["matInput","","formControlName","PDODocDate","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["pdoDocDate",""],["fxFlex","100","fxFlex.gt-sm","50",1,"px-1"],["matInput","","formControlName","PDOValue","required",""],["matInput","","formControlName","PDOPrintedCode"],["matInput","","formControlName","PDOEjarCode"],["matInput","","formControlName","PDODocSecondPerson","required",""],["matInput","","formControlName","PDOPayDate",3,"matDatepicker"],["pdoPayDate",""],["fxFlex","100",1,"px-1"],["matInput","","formControlName","PDONotes","rows","3"],["fxFlex","100","class","mt-2 text-center w-100",4,"ngIf"],["fxFlex","100",1,"mt-2","text-center","w-100"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(t,i){if(1&t){const s=e.EpF();e.TgZ(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"h1"),e.YNc(5,De,3,3,"span",1),e.YNc(6,fe,3,3,"span",1),e._uU(7),e.ALo(8,"translate"),e.qZA()()(),e.TgZ(9,"mat-card-content",2)(10,"form",3),e.NdJ("ngSubmit",function(){return i.saveEditDocData(i.payDocForDisplay.id)}),e.TgZ(11,"div",4),e._UZ(12,"img",5),e.qZA(),e.TgZ(13,"div",6)(14,"div",7)(15,"div",8)(16,"mat-form-field",9)(17,"mat-label"),e._uU(18),e.ALo(19,"translate"),e.qZA(),e._UZ(20,"input",10),e.qZA()(),e.TgZ(21,"div",8)(22,"mat-form-field",9)(23,"mat-label"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"input",11,12),e.NdJ("keyup.enter",function(){e.CHM(s);const c=e.MAs(27);return e.KtG(i.searchByCode(c.value))}),e.qZA()()(),e.TgZ(28,"div",13)(29,"label"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"ng-select",14),e.NdJ("change",function(c){return i.readCustumer(c)}),e.ALo(33,"translate"),e.YNc(34,ye,2,2,"ng-option",15),e.qZA()(),e.TgZ(35,"div",8)(36,"mat-form-field",9)(37,"mat-label"),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"mat-select",16),e.ALo(41,"translate"),e.TgZ(42,"mat-option",17),e._uU(43,"-"),e.qZA(),e.TgZ(44,"mat-option",17),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"mat-option",17),e._uU(48),e.ALo(49,"translate"),e.qZA(),e.TgZ(50,"mat-option",17),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.TgZ(53,"mat-option",17),e._uU(54),e.ALo(55,"translate"),e.qZA()()()(),e.TgZ(56,"div",18)(57,"mat-form-field",9)(58,"mat-label"),e._uU(59),e.ALo(60,"translate"),e.qZA(),e._UZ(61,"input",19)(62,"mat-datepicker-toggle",20)(63,"mat-datepicker",null,21),e.qZA()(),e.TgZ(65,"div",22)(66,"mat-form-field",9)(67,"mat-label"),e._uU(68),e.ALo(69,"translate"),e.qZA(),e._UZ(70,"input",23),e.qZA()(),e.TgZ(71,"div",18)(72,"mat-form-field",9)(73,"mat-label"),e._uU(74),e.ALo(75,"translate"),e.qZA(),e._UZ(76,"input",24),e.qZA()(),e.TgZ(77,"div",18)(78,"mat-form-field",9)(79,"mat-label"),e._uU(80),e.ALo(81,"translate"),e.qZA(),e._UZ(82,"input",25),e.qZA()(),e.TgZ(83,"div",22)(84,"mat-form-field",9)(85,"mat-label"),e._uU(86),e.ALo(87,"translate"),e.qZA(),e._UZ(88,"input",26),e.qZA()(),e.TgZ(89,"div",18)(90,"mat-form-field",9)(91,"mat-label"),e._uU(92),e.ALo(93,"translate"),e.qZA(),e._UZ(94,"input",27)(95,"mat-datepicker-toggle",20)(96,"mat-datepicker",null,28),e.qZA()(),e.TgZ(98,"div",29)(99,"mat-form-field",9)(100,"mat-label"),e._uU(101),e.ALo(102,"translate"),e.qZA(),e._UZ(103,"textarea",30),e.qZA()(),e.YNc(104,Te,4,3,"div",31),e.qZA()()()()()()}if(2&t){const s=e.MAs(64),n=e.MAs(97);e.xp6(5),e.Q6J("ngIf",!i.payDocForDisplay.id),e.xp6(1),e.Q6J("ngIf",i.payDocForDisplay.id),e.xp6(1),e.hij(" ",e.lcZ(8,32,"HTML.ReceivableDoc"),""),e.xp6(3),e.Q6J("formGroup",i.docData_Form),e.xp6(2),e.Q6J("src","assets/images/paymentDocs/receivable.png",e.LSH),e.xp6(6),e.Oqu(e.lcZ(19,34,"HTML.CODE_DOCUMENT")),e.xp6(6),e.Oqu(e.lcZ(25,36,"HTML.CODE_TENANT")),e.xp6(6),e.hij(" ",e.lcZ(31,38,"HTML.TENANT"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(33,40,"HTML.TENANT")),e.xp6(2),e.Q6J("ngForOf",i.AllTenants),e.xp6(4),e.Oqu(e.lcZ(39,42,"HTML.DocPayType")),e.xp6(2),e.s9C("placeholder",e.lcZ(41,44,"HTML.DocPayType")),e.xp6(4),e.Q6J("value","C"),e.xp6(1),e.Oqu(e.lcZ(46,46,"OPTIONS.Cash")),e.xp6(2),e.Q6J("value","B"),e.xp6(1),e.Oqu(e.lcZ(49,48,"OPTIONS.Bank")),e.xp6(2),e.Q6J("value","E"),e.xp6(1),e.Oqu(e.lcZ(52,50,"OPTIONS.Ejar")),e.xp6(2),e.Q6J("value","T"),e.xp6(1),e.Oqu(e.lcZ(55,52,"OPTIONS.Transfere")),e.xp6(5),e.Oqu(e.lcZ(60,54,"HTML.DocDate")),e.xp6(2),e.Q6J("matDatepicker",s),e.xp6(1),e.Q6J("for",s),e.xp6(6),e.Oqu(e.lcZ(69,56,"HTML.DocValue")),e.xp6(6),e.Oqu(e.lcZ(75,58,"HTML.DocPrintedNo")),e.xp6(6),e.Oqu(e.lcZ(81,60,"HTML.PayDocEjarCode")),e.xp6(6),e.Oqu(e.lcZ(87,62,"HTML.DocSecondPart_ReceivableDoc")),e.xp6(6),e.Oqu(e.lcZ(93,64,"HTML.DocPayDate")),e.xp6(2),e.Q6J("matDatepicker",n),e.xp6(1),e.Q6J("for",n),e.xp6(6),e.Oqu(e.lcZ(102,66,"HTML.Notes")),e.xp6(3),e.Q6J("ngIf",i.payDocForDisplay.id&&i.can("change_onereceivable")||!i.payDocForDisplay.id&&i.can("add_onereceivable"))}},dependencies:[p._Y,p.Fj,p.JJ,p.JL,p.Q7,h.sg,h.O5,p.sg,p.u,f.xw,f.yH,he.ey,U.lW,x.a8,x.dn,x.dk,x.n5,I.Mq,I.hl,I.nW,J.Nt,S.KE,S.hX,S.R9,ge.gD,Y.w9,Y.jq,F.X$]});var ve=u(529),xe=u(589),Pe=u(9045);function Fe(r,t){if(1&r){const i=e.EpF();e.TgZ(0,"mat-button-toggle",21),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.gotoNewDocument())}),e.TgZ(1,"mat-icon"),e._uU(2,"note_add"),e.qZA()()}}const Ce=function(r){return["/payments/payable-add/",r]};function Se(r,t){if(1&r&&(e.TgZ(0,"a",27),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA()()),2&r){const i=e.oxw().$implicit;e.s9C("matTooltip",e.lcZ(1,2,"BTN.VIEW")),e.Q6J("routerLink",e.VKq(4,Ce,i.id))}}function Ze(r,t){if(1&r){const i=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit,c=e.oxw();return e.KtG(c.removeDocument(n.id))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()}2&r&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.REMOVE"))}function Ae(r,t){if(1&r&&(e.TgZ(0,"div",22)(1,"div",23),e._uU(2),e.qZA(),e.TgZ(3,"div",23),e._uU(4),e.qZA(),e.TgZ(5,"div",23),e._uU(6),e.qZA(),e.TgZ(7,"div",23),e._uU(8),e.qZA(),e.TgZ(9,"div",23)(10,"div",24),e.YNc(11,Se,4,6,"a",25),e.YNc(12,Ze,4,3,"button",26),e.qZA()()()),2&r){const i=t.$implicit,s=e.oxw();e.xp6(2),e.hij(" ",i.customer_Name," "),e.xp6(2),e.hij(" ",i.PDODocDate," "),e.xp6(2),e.hij(" ",i.PDOValue," "),e.xp6(2),e.hij(" ",i.PDOPrintedCode," "),e.xp6(3),e.Q6J("ngIf",s.can("view_onepayable")),e.xp6(1),e.Q6J("ngIf",s.can("delete_onepayable"))}}function Ne(r,t){if(1&r){const i=e.EpF();e.TgZ(0,"div",29)(1,"div",30)(2,"mat-card",31)(3,"pagination-controls",32),e.NdJ("pageChange",function(n){e.CHM(i);const c=e.oxw();return e.KtG(c.onPageChanged(n))}),e.qZA()()()()}}function Ue(r,t){1&r&&(e.TgZ(0,"div",33),e._UZ(1,"mat-spinner",34),e.qZA())}const Oe=function(r,t){return{itemsPerPage:r,currentPage:t}};class B{constructor(t,i,s,n,c,g,D,y,O,L){this.transferService=t,this.appSettings=i,this.dialog=s,this.paymentService=n,this.router=c,this.global=g,this.localStore=D,this.settingService=y,this.translateService=O,this.snackBar=L,this.curCOMId=b.N.comid,this.account=new T.n,this.count=4,this.userPerm=[],this.editPayableDocCodeStatus=(new v.$).getEditPayableDocCodeStatus(),this.editCode=!0,this.settings=this.appSettings.settings}ngOnInit(){if(this.securityForApp=(new v.$).getSecurityType(),this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.getParamValue(this.curCOMId,this.account.periorty,this.editPayableDocCodeStatus),this.prepareMsgLanguage(),this.getDocuments()}else this.router.navigate(["/sign-in"])}getParamValue(t,i,s){this.settingService.getValueForCode(t,i,s).subscribe(n=>{s==this.editPayableDocCodeStatus&&(this.editPayableDocCodeValue=n[0].APAValue)},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u062e\u064a\u0627\u0631\u0627\u062a \u0627\u0644\u0646\u0638\u0627\u0645","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getDocuments(){this.documentsAll=null,this.curUserData.is_superuser?this.paymentService.getAllPayableDocuments(this.curCOMId,this.account.periorty).subscribe(t=>this.documentsAll=t):1==this.curUserData.periorty&&("N"==this.securityForApp&&this.paymentService.getAllPayableDocumentsPerBranch(this.curCOMId,this.account.periorty,this.curUserData.branch_KeyField).subscribe(t=>this.documentsAll=t),"D"==this.securityForApp&&this.paymentService.getAllPayableDocumentsPerEmp(this.curCOMId,this.account.periorty,this.curUserData.id).subscribe(t=>this.documentsAll=t))}removeDocument(t){this.dialog.open(Z.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(s=>{s&&this.paymentService.deleteDocument(t).subscribe(n=>this.getDocuments())})}onPageChanged(t){this.page=t,this.getDocuments(),window.scrollTo(0,0)}gotoNewDocument(){this.transferService.setMessage({editPayableDocCode:this.editPayableDocCodeValue}),this.router.navigate(["/payments/payable-add/"])}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(t=>{this.errorRetrieveMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(t=>{this.deletedTitleMsg=t})}}function Le(r,t){1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.ADD")))}function Ee(r,t){1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function Ie(r,t){if(1&r&&(e.TgZ(0,"ng-option",29),e._uU(1),e.qZA()),2&r){const i=t.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.CUSName,"")}}function we(r,t){1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.SAVE")))}function Me(r,t){1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function Ke(r,t){if(1&r&&(e.TgZ(0,"div",30)(1,"button",31),e.YNc(2,we,3,3,"span",1),e.YNc(3,Me,3,3,"span",1),e.qZA()()),2&r){const i=e.oxw();e.xp6(1),e.Q6J("disabled",!i.docData_Form.valid),e.xp6(1),e.Q6J("ngIf",!i.payDocForDisplay.id),e.xp6(1),e.Q6J("ngIf",i.payDocForDisplay.id)}}B.\u0275fac=function(t){return new(t||B)(e.Y36(P.y),e.Y36(C.d),e.Y36(A.uw),e.Y36(_.c),e.Y36(m.F0),e.Y36(l.U),e.Y36(d.C),e.Y36(o.g),e.Y36(F.sK),e.Y36(R.ux))},B.\u0275cmp=e.Xpm({type:B,selectors:[["app-payable-doc-list"]],features:[e._Bn([_.c])],decls:52,vars:34,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click",4,"ngIf"],["value","search"],[1,"user-search"],[1,"user-search-input"],["matInput","","name","search","autocomplete","off",3,"placeholder","ngModel","ngModelChange"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","list"],["viewType","matButtonToggleGroup"],["value","list"],["value","grid"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],["value","add",3,"click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip",4,"ngIf"],["mat-mini-fab","","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100",1,"p-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-button-toggle-group",2,3),e.YNc(4,Fe,3,0,"mat-button-toggle",4),e.TgZ(5,"mat-button-toggle",5)(6,"mat-icon"),e._uU(7,"search"),e.qZA()()()(),e.TgZ(8,"form",6)(9,"mat-form-field",7)(10,"input",8),e.NdJ("ngModelChange",function(n){return i.searchText=n}),e.ALo(11,"translate"),e.qZA()()(),e.TgZ(12,"div",9)(13,"mat-button-toggle-group",10,11)(15,"mat-button-toggle",12)(16,"mat-icon"),e._uU(17,"view_list"),e.qZA()(),e.TgZ(18,"mat-button-toggle",13)(19,"mat-icon"),e._uU(20,"view_module"),e.qZA()()()()(),e._UZ(21,"mat-divider"),e.TgZ(22,"mat-card")(23,"div",14)(24,"h2"),e._uU(25),e.ALo(26,"translate"),e.qZA()(),e._UZ(27,"mat-divider"),e.TgZ(28,"div",15)(29,"div",16)(30,"div",17)(31,"h2"),e._uU(32),e.ALo(33,"translate"),e.qZA()(),e.TgZ(34,"div",17)(35,"h2"),e._uU(36),e.ALo(37,"translate"),e.qZA()(),e.TgZ(38,"div",17)(39,"h2"),e._uU(40),e.ALo(41,"translate"),e.qZA()(),e.TgZ(42,"div",17)(43,"h2"),e._uU(44),e.ALo(45,"translate"),e.qZA()(),e._UZ(46,"div",17),e.qZA(),e.YNc(47,Ae,13,6,"div",18),e.ALo(48,"paginate"),e.ALo(49,"PayDocumentsSearchPipe"),e.qZA()(),e.YNc(50,Ne,4,0,"div",19),e.YNc(51,Ue,2,0,"div",20)),2&t){const s=e.MAs(3);e.xp6(4),e.Q6J("ngIf",i.can("add_onepayable")),e.xp6(4),e.ekj("show","search"==s.value),e.xp6(2),e.s9C("placeholder",e.lcZ(11,13,"HTML.SEARCH_PayDocument")),e.Q6J("ngModel",i.searchText),e.xp6(15),e.Oqu(e.lcZ(26,15,"HTML.PayableDoc_List")),e.xp6(7),e.hij(" ",e.lcZ(33,17,"HTML.TENANT")," "),e.xp6(4),e.hij(" ",e.lcZ(37,19,"HTML.DocDate")," "),e.xp6(4),e.hij(" ",e.lcZ(41,21,"HTML.DocValue")," "),e.xp6(4),e.hij(" ",e.lcZ(45,23,"HTML.DocPrintedNo")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(48,25,e.xi3(49,28,i.documentsAll,i.searchText),e.WLB(31,Oe,i.count,i.page))),e.xp6(3),e.Q6J("ngIf",i.documentsAll),e.xp6(1),e.Q6J("ngIf",!i.documentsAll)}},dependencies:[p._Y,p.Fj,p.JJ,p.JL,p.On,p.F,N.LS,h.sg,h.O5,m.rH,f.xw,f.Wh,f.yH,U.Tq,U.nh,E.A9,E.Yi,x.a8,Q.Hw,J.Nt,S.KE,G.d,W.Ou,$.gM,N._s,X.dg,F.X$],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}\n"],encapsulation:2});class M{constructor(t,i,s,n,c,g,D,y,O,L,H,z){this.transferService=t,this.activatedRoute=i,this.localStore=s,this._companyService=n,this.global=c,this.router=g,this.snackBar=D,this.docsService=y,this.tenantsService=O,this.contractService=L,this.translateService=H,this.fb=z,this.curCOMId=b.N.comid,this.account=new T.n,this.editCode=!0,this.userPerm=[],this.AllTenants=[]}ngOnInit(){if(this.transferService.getMessage.subscribe(t=>{this.editCode="YES"==t.editPayableDocCode.toUpperCase(),console.log("---2222 this.editCode:: "+this.editCode)}),this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.getMaxCodeForPayment(this.curCOMId,this.account.periorty),this.getTenants(),this.sub=this.activatedRoute.params.subscribe(t=>{t.id?(this.id=+t.id,this.getDocById(this.id)):this.payDocForDisplay=new ee}),this.docData_Form=this.fb.group({id:null,PDOCode:{value:null,disabled:!this.editCode},PDOValue:{value:null,disabled:this.id},PDODocDate:null,PDODocType:"P",PDODocClassType:"H",PDOPrintedCode:null,PDODocSecondPerson:null,PDONotes:null,contract_KeyField:null,branch_KeyField:null,owner_KeyField:null,build_KeyField:null,unit_KeyField:null,installment_KeyField:null,customer_KeyField:null})}else this.router.navigate(["/sign-in"])}getMaxCodeForPayment(t,i){this.docsService.getMaxPayableCode(t,i).subscribe(s=>{this.maxPaymentCode=s.max,this.id||this.docData_Form.patchValue({PDOCode:this.maxPaymentCode})})}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getDocById(t){this.docsService.getOneDocs(t).subscribe(i=>{this.fillForm(i),this.payDocForDisplay=i})}fillForm(t){null!=t.PDODocDate&&(this.s_docDate=t.PDODocDate),this.docData_Form.patchValue({id:t.id,contract_KeyField:t.contract_KeyField,branch_KeyField:t.branch_KeyField,owner_KeyField:t.owner_KeyField,build_KeyField:t.build_KeyField,unit_KeyField:t.unit_KeyField,installment_KeyField:t.installment_KeyField,customer_KeyField:t.customer_KeyField,PDOCode:t.PDOCode,PDOValue:t.PDOValue,PDODocType:t.PDODocType,PDODocDate:t.PDODocDate,PDODocClassType:t.PDODocClassType,PDOPrintedCode:t.PDOPrintedCode,PDODocSecondPerson:t.PDODocSecondPerson,PDONotes:t.PDONotes})}onEnter(t){console.log("---Search event:: "+t)}searchByCode(t){console.log("---Search event:: "+t),this.tenantsService.getCustomerPerCode(this.curCOMId,this.account.periorty,+t).subscribe(i=>{i.length>0?(console.log("---id:: "+i[0].id),this.docData_Form.patchValue({customer_KeyField:i[0].id}),this.readCustumer(i[0].id)):(console.log("---Not---"),this.docData_Form.patchValue({customer_KeyField:null}))},i=>{console.log("----not found tenant----")})}readCustumer(t){this.tenantsService.getOneCustomer(t).subscribe(i=>{this.docData_Form.patchValue({PDODocSecondPerson:i.CUSName,contract_KeyField:i.current_contract,branch_KeyField:i.current_branch,build_KeyField:i.current_building,unit_KeyField:i.current_unit,owner_KeyField:i.current_owner})})}getTenants(){this.AllTenants=null,this.tenantsService.getCustomers(this.curCOMId,this.account.periorty).subscribe(t=>this.AllTenants=t)}mappingFormValue_ToPayDocClass(){const t=new h.uU("en-GB").transform(this.docData_Form.value.PDODocDate,"dd/MM/yyyy");this.payDocForDisplay.id=this.docData_Form.value.id,this.payDocForDisplay.contract_KeyField=this.docData_Form.value.contract_KeyField,this.payDocForDisplay.branch_KeyField=this.docData_Form.value.branch_KeyField,this.payDocForDisplay.owner_KeyField=this.docData_Form.value.owner_KeyField,this.payDocForDisplay.build_KeyField=this.docData_Form.value.build_KeyField,this.payDocForDisplay.unit_KeyField=this.docData_Form.value.unit_KeyField,this.payDocForDisplay.installment_KeyField=this.docData_Form.value.installment_KeyField,this.payDocForDisplay.customer_KeyField=this.docData_Form.value.customer_KeyField,null!=this.docData_Form.value.PDODocDate&&(this.payDocForDisplay.PDODocDate=t),this.payDocForDisplay.PDOCode=this.docData_Form.value.PDOCode,this.payDocForDisplay.PDOValue=this.docData_Form.value.PDOValue,this.payDocForDisplay.PDODocType=this.docData_Form.value.PDODocType,this.payDocForDisplay.PDODocClassType=this.docData_Form.value.PDODocClassType,this.payDocForDisplay.PDOPrintedCode=this.docData_Form.value.PDOPrintedCode,this.payDocForDisplay.PDODocSecondPerson=this.docData_Form.value.PDODocSecondPerson,this.payDocForDisplay.PDONotes=this.docData_Form.value.PDONotes}saveEditDocData(t){this.mappingFormValue_ToPayDocClass(),t?this.docsService.editDoc(this.payDocForDisplay).subscribe(i=>{let s={contract_KeyField:i.contract_KeyField,branch_KeyField:i.branch_KeyField,owner_KeyField:i.owner_KeyField,build_KeyField:i.build_KeyField,unit_KeyField:i.unit_KeyField,installment_KeyField:null,customer_KeyField:i.customer_KeyField,TSTCreditValue:0,TSTDebitValue:i.PDOValue,TSTDate:i.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0635\u0631\u0641 \u0631\u0642\u0645 "+i.PDOCode,TSTSubject:"PAYABLE",TSTSubjectID:i.ID};this.contractService.deleteStatementForSubjectID(this.curCOMId,this.account.periorty,"PAYABLE",i.id).subscribe(n=>{this.contractService.addStatement(s).subscribe(c=>{})}),this.snackBar.open("\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/payable-list"])},i=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}):this.docsService.addDoc(this.payDocForDisplay).subscribe(i=>{this.contractService.addStatement({contract_KeyField:i.contract_KeyField,branch_KeyField:i.branch_KeyField,owner_KeyField:i.owner_KeyField,build_KeyField:i.build_KeyField,unit_KeyField:i.unit_KeyField,installment_KeyField:null,customer_KeyField:i.customer_KeyField,TSTCreditValue:0,TSTDebitValue:i.PDOValue,TSTDate:i.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0635\u0631\u0641 \u0631\u0642\u0645 "+i.PDOCode,TSTSubject:"PAYABLE",TSTSubjectID:i.ID}).subscribe(n=>{}),this.snackBar.open("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/payable-list"])},i=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u0627\u0636\u0627\u0641\u0647 \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(t=>{this.errorRetrieveMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t})}}M.\u0275fac=function(t){return new(t||M)(e.Y36(P.y),e.Y36(m.gz),e.Y36(d.C),e.Y36(te.J),e.Y36(l.U),e.Y36(m.F0),e.Y36(R.ux),e.Y36(_.c),e.Y36(ie.v),e.Y36(a.W),e.Y36(F.sK),e.Y36(p.qu))},M.\u0275cmp=e.Xpm({type:M,selectors:[["app-payable-doc-dialog"]],decls:70,vars:38,consts:[[1,"p-2"],[4,"ngIf"],[1,"pt-3"],["autocomplete","off","fxLayout","row wrap",3,"formGroup","ngSubmit"],["fxFlex","100","fxFlex.gt-sm","40",1,"px-2"],["width","400","height","300","id","campanyLogo",3,"src"],["fxFlex","100","fxFlex.gt-sm","60",1,"px-2"],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-sm","20",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","PDOCode"],["matInput","",3,"keyup.enter"],["tenCode",""],["fxFlex","100","fxFlex.gt-sm","60",1,"px-1"],["appearance","outline","formControlName","customer_KeyField",1,"w-100",3,"placeholder","keyup.enter","change"],["box",""],[3,"value",4,"ngFor","ngForOf"],["fxFlex","100","fxFlex.gt-sm","25",1,"px-1"],["matInput","","formControlName","PDODocDate","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["pdoDocDate",""],["fxFlex","100","fxFlex.gt-sm","50",1,"px-1"],["matInput","","formControlName","PDOValue","required",""],["matInput","","formControlName","PDOPrintedCode"],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","PDODocSecondPerson","required",""],["fxFlex","100",1,"px-1"],["matInput","","formControlName","PDONotes","rows","3"],["fxFlex","100","class","mt-2 text-center w-100",4,"ngIf"],[3,"value"],["fxFlex","100",1,"mt-2","text-center","w-100"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(t,i){if(1&t){const s=e.EpF();e.TgZ(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"h1"),e.YNc(5,Le,3,3,"span",1),e.YNc(6,Ee,3,3,"span",1),e._uU(7),e.ALo(8,"translate"),e.qZA()()(),e.TgZ(9,"mat-card-content",2)(10,"form",3),e.NdJ("ngSubmit",function(){return i.saveEditDocData(i.payDocForDisplay.id)}),e.TgZ(11,"div",4),e._UZ(12,"img",5),e.qZA(),e.TgZ(13,"div",6)(14,"div",7)(15,"div",8)(16,"mat-form-field",9)(17,"mat-label"),e._uU(18),e.ALo(19,"translate"),e.qZA(),e._UZ(20,"input",10),e.qZA()(),e.TgZ(21,"div",8)(22,"mat-form-field",9)(23,"mat-label"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"input",11,12),e.NdJ("keyup.enter",function(){e.CHM(s);const c=e.MAs(27);return e.KtG(i.searchByCode(c.value))}),e.qZA()()(),e.TgZ(28,"div",13)(29,"label"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"ng-select",14,15),e.NdJ("keyup.enter",function(){e.CHM(s);const c=e.MAs(33);return e.KtG(i.onEnter(c.value))})("change",function(c){return i.readCustumer(c)}),e.ALo(34,"translate"),e.YNc(35,Ie,2,2,"ng-option",16),e.qZA()(),e.TgZ(36,"div",17)(37,"mat-form-field",9)(38,"mat-label"),e._uU(39),e.ALo(40,"translate"),e.qZA(),e._UZ(41,"input",18)(42,"mat-datepicker-toggle",19)(43,"mat-datepicker",null,20),e.qZA()(),e.TgZ(45,"div",21)(46,"mat-form-field",9)(47,"mat-label"),e._uU(48),e.ALo(49,"translate"),e.qZA(),e._UZ(50,"input",22),e.qZA()(),e.TgZ(51,"div",17)(52,"mat-form-field",9)(53,"mat-label"),e._uU(54),e.ALo(55,"translate"),e.qZA(),e._UZ(56,"input",23),e.qZA()(),e.TgZ(57,"div",24)(58,"mat-form-field",9)(59,"mat-label"),e._uU(60),e.ALo(61,"translate"),e.qZA(),e._UZ(62,"input",25),e.qZA()(),e.TgZ(63,"div",26)(64,"mat-form-field",9)(65,"mat-label"),e._uU(66),e.ALo(67,"translate"),e.qZA(),e._UZ(68,"textarea",27),e.qZA()(),e.YNc(69,Ke,4,3,"div",28),e.qZA()()()()()()}if(2&t){const s=e.MAs(44);e.xp6(5),e.Q6J("ngIf",!i.payDocForDisplay.id),e.xp6(1),e.Q6J("ngIf",i.payDocForDisplay.id),e.xp6(1),e.hij(" ",e.lcZ(8,18,"HTML.PayableDoc"),""),e.xp6(3),e.Q6J("formGroup",i.docData_Form),e.xp6(2),e.Q6J("src","assets/images/paymentDocs/payable.png",e.LSH),e.xp6(6),e.Oqu(e.lcZ(19,20,"HTML.CODE_DOCUMENT")),e.xp6(6),e.Oqu(e.lcZ(25,22,"HTML.CODE_TENANT")),e.xp6(6),e.hij(" ",e.lcZ(31,24,"HTML.TENANT"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(34,26,"HTML.TENANT")),e.xp6(3),e.Q6J("ngForOf",i.AllTenants),e.xp6(4),e.Oqu(e.lcZ(40,28,"HTML.DocDate")),e.xp6(2),e.Q6J("matDatepicker",s),e.xp6(1),e.Q6J("for",s),e.xp6(6),e.Oqu(e.lcZ(49,30,"HTML.DocValue")),e.xp6(6),e.Oqu(e.lcZ(55,32,"HTML.DocPrintedNo")),e.xp6(6),e.Oqu(e.lcZ(61,34,"HTML.DocSecondPart_PayableDoc")),e.xp6(6),e.Oqu(e.lcZ(67,36,"HTML.Notes")),e.xp6(3),e.Q6J("ngIf",i.payDocForDisplay.id&&i.can("change_onepayable")||!i.payDocForDisplay.id&&i.can("add_onepayable"))}},dependencies:[p._Y,p.Fj,p.JJ,p.JL,p.Q7,h.sg,h.O5,p.sg,p.u,f.xw,f.yH,U.lW,x.a8,x.dn,x.dk,x.n5,I.Mq,I.hl,I.nW,J.Nt,S.KE,S.hX,S.R9,Y.w9,Y.jq,F.X$]});var ae=u(3705),qe=u(9368);function Re(r,t){if(1&r){const i=e.EpF();e.TgZ(0,"mat-button-toggle",21),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.gotoNewUnit())}),e.TgZ(1,"mat-icon"),e._uU(2,"add_circle_outline"),e.qZA()()}}const Je=function(r){return["/units/unit-add/",r]};function Ve(r,t){if(1&r&&(e.TgZ(0,"a",29),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA()()),2&r){const i=e.oxw().$implicit;e.s9C("matTooltip",e.lcZ(1,2,"BTN.VIEW")),e.Q6J("routerLink",e.VKq(4,Je,i.id))}}function Ye(r,t){if(1&r){const i=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit,c=e.oxw();return e.KtG(c.removeUnit(n.id))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()}2&r&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.REMOVE"))}function Be(r,t){if(1&r){const i=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().$implicit,c=e.oxw();return e.KtG(c.openExpensesDialog(n))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"build"),e.qZA()()}2&r&&e.s9C("matTooltip",e.lcZ(1,1,"ADMIN_NAV.Expenses"))}function je(r,t){if(1&r&&(e.TgZ(0,"div",22)(1,"div",23),e._uU(2),e.qZA(),e.TgZ(3,"div",23),e._uU(4),e.qZA(),e.TgZ(5,"div",23),e._uU(6),e.qZA(),e.TgZ(7,"div",23),e._uU(8),e.qZA(),e.TgZ(9,"div",23),e._uU(10),e.qZA(),e.TgZ(11,"div",23),e._uU(12),e.qZA(),e.TgZ(13,"div",23)(14,"mat-icon",24),e._uU(15),e.qZA()(),e.TgZ(16,"div",23)(17,"div",25),e.YNc(18,Ve,4,6,"a",26),e.YNc(19,Ye,4,3,"button",27),e.YNc(20,Be,4,3,"button",28),e.qZA()()()),2&r){const i=t.$implicit,s=e.oxw();e.xp6(2),e.Oqu(i.branch_ArbName),e.xp6(2),e.Oqu(i.build_Name),e.xp6(2),e.hij(" ",i.UNTFloorNumber," "),e.xp6(2),e.hij(" ",i.UNTUnitNumber," "),e.xp6(2),e.hij(" ",i.UNTHousingStatusDisplay," "),e.xp6(2),e.hij(" ",i.UNTUnitTypeDisplay," "),e.xp6(3),e.Oqu("T"==i.UNTActive?"check_box":"check_box_outline_blank"),e.xp6(3),e.Q6J("ngIf",s.can("view_oneunit")),e.xp6(1),e.Q6J("ngIf",s.can("delete_units")),e.xp6(1),e.Q6J("ngIf",s.can("view_unititemexpenses"))}}function He(r,t){if(1&r){const i=e.EpF();e.TgZ(0,"div",32)(1,"div",33)(2,"mat-card",34)(3,"pagination-controls",35),e.NdJ("pageChange",function(n){e.CHM(i);const c=e.oxw();return e.KtG(c.onPageChanged(n))}),e.qZA()()()()}}function ke(r,t){1&r&&(e.TgZ(0,"div",36),e._UZ(1,"mat-spinner",37),e.qZA())}const Qe=function(r,t){return{itemsPerPage:r,currentPage:t}};class j{constructor(t,i,s,n,c,g,D,y){this.appSettings=t,this.dialog=i,this.unitsService=s,this.router=n,this.global=c,this.localStore=g,this.translateService=D,this.snackBar=y,this.curCOMId=b.N.comid,this.account=new T.n,this.count=6,this.userPerm=[],this.settings=this.appSettings.settings}ngOnInit(){if(this.securityForApp=(new v.$).getSecurityType(),this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.prepareMsgLanguage(),this.getUnits()}else this.router.navigate(["/sign-in"])}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getUnits(){this.unitsAll=null,this.curUserData.is_superuser?this.unitsService.getAllUnits(this.curCOMId,this.account.periorty).subscribe(t=>this.unitsAll=t):1==this.curUserData.periorty&&(this.curBranchID=this.curUserData.branch_KeyField??0,"N"==this.securityForApp&&this.unitsService.getUnitsPerBranch(this.curCOMId,this.account.periorty,this.curBranchID).subscribe(t=>this.unitsAll=t),"D"==this.securityForApp&&this.unitsService.getUnitsPerEmployee(this.curCOMId,this.account.periorty,this.curUserData.id).subscribe(t=>this.unitsAll=t))}openExpensesDialog(t){this.dialog.open(qe.Z,{data:{unitRow:t,periorty:this.account.periorty},panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr"}).afterClosed().subscribe(s=>{})}removeUnit(t){confirm(this.askToDeletedMsg)&&this.unitsService.deleteUnit(t).subscribe(i=>this.getUnits())}onPageChanged(t){this.page=t,this.getUnits(),window.scrollTo(0,0)}gotoNewUnit(){this.router.navigate(["/units/unit-add/"])}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(t=>{this.errorRetrieveMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t})}}j.\u0275fac=function(t){return new(t||j)(e.Y36(C.d),e.Y36(A.uw),e.Y36(ae.X),e.Y36(m.F0),e.Y36(l.U),e.Y36(d.C),e.Y36(F.sK),e.Y36(R.ux))},j.\u0275cmp=e.Xpm({type:j,selectors:[["app-expenses-inv-list"]],features:[e._Bn([ae.X])],decls:64,vars:43,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click",4,"ngIf"],["value","search"],[1,"user-search"],[1,"user-search-input"],["matInput","","name","search","autocomplete","off",3,"placeholder","ngModel","ngModelChange"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","list"],["viewType","matButtonToggleGroup"],["value","list"],["value","grid"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],["value","add",3,"click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"text-muted"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip",4,"ngIf"],["mat-mini-fab","","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["mat-mini-fab","","color","primary",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100",1,"p-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-button-toggle-group",2,3),e.YNc(4,Re,3,0,"mat-button-toggle",4),e.TgZ(5,"mat-button-toggle",5)(6,"mat-icon"),e._uU(7,"search"),e.qZA()()()(),e.TgZ(8,"form",6)(9,"mat-form-field",7)(10,"input",8),e.NdJ("ngModelChange",function(n){return i.searchText=n}),e.ALo(11,"translate"),e.qZA()()(),e.TgZ(12,"div",9)(13,"mat-button-toggle-group",10,11)(15,"mat-button-toggle",12)(16,"mat-icon"),e._uU(17,"view_list"),e.qZA()(),e.TgZ(18,"mat-button-toggle",13)(19,"mat-icon"),e._uU(20,"view_module"),e.qZA()()()()(),e._UZ(21,"mat-divider"),e.TgZ(22,"mat-card")(23,"div",14)(24,"h2"),e._uU(25),e.ALo(26,"translate"),e.qZA()(),e._UZ(27,"mat-divider"),e.TgZ(28,"div",15)(29,"div",16)(30,"div",17)(31,"h2"),e._uU(32),e.ALo(33,"translate"),e.qZA()(),e.TgZ(34,"div",17)(35,"h2"),e._uU(36),e.ALo(37,"translate"),e.qZA()(),e.TgZ(38,"div",17)(39,"h2"),e._uU(40),e.ALo(41,"translate"),e.qZA()(),e.TgZ(42,"div",17)(43,"h2"),e._uU(44),e.ALo(45,"translate"),e.qZA()(),e.TgZ(46,"div",17)(47,"h2"),e._uU(48),e.ALo(49,"translate"),e.qZA()(),e.TgZ(50,"div",17)(51,"h2"),e._uU(52),e.ALo(53,"translate"),e.qZA()(),e.TgZ(54,"div",17)(55,"h2"),e._uU(56),e.ALo(57,"translate"),e.qZA()(),e._UZ(58,"div",17),e.qZA(),e.YNc(59,je,21,10,"div",18),e.ALo(60,"paginate"),e.ALo(61,"UnitsSearchPipe"),e.qZA()(),e.YNc(62,He,4,0,"div",19),e.YNc(63,ke,2,0,"div",20)),2&t){const s=e.MAs(3);e.xp6(4),e.Q6J("ngIf",i.can("add_units")),e.xp6(4),e.ekj("show","search"==s.value),e.xp6(2),e.s9C("placeholder",e.lcZ(11,16,"HTML.SEARCH_UNITS")),e.Q6J("ngModel",i.searchText),e.xp6(15),e.Oqu(e.lcZ(26,18,"HTML.UNIT_LIST")),e.xp6(7),e.hij(" ",e.lcZ(33,20,"HTML.BRANCH")," "),e.xp6(4),e.hij(" ",e.lcZ(37,22,"HTML.BUILDING")," "),e.xp6(4),e.hij(" ",e.lcZ(41,24,"HTML.FloorNumber")," "),e.xp6(4),e.hij(" ",e.lcZ(45,26,"HTML.UnitNumber")," "),e.xp6(4),e.hij(" ",e.lcZ(49,28,"HTML.HOUSING_STATUS")," "),e.xp6(4),e.hij(" ",e.lcZ(53,30,"HTML.UnitType")," "),e.xp6(4),e.hij(" ",e.lcZ(57,32,"HTML.ACTIVATED")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(60,34,e.xi3(61,37,i.unitsAll,i.searchText),e.WLB(40,Qe,i.count,i.page))),e.xp6(3),e.Q6J("ngIf",i.unitsAll),e.xp6(1),e.Q6J("ngIf",!i.unitsAll)}},dependencies:[p._Y,p.Fj,p.JJ,p.JL,p.On,p.F,N.LS,h.sg,h.O5,m.rH,f.xw,f.Wh,f.yH,U.Tq,U.nh,E.A9,E.Yi,x.a8,Q.Hw,J.Nt,S.KE,G.d,W.Ou,$.gM,N._s,X.pL,F.X$],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}\n"],encapsulation:2});class K{}K.\u0275fac=function(t){return new(t||K)},K.\u0275cmp=e.Xpm({type:K,selectors:[["app-expenses-inv-dialog"]],decls:2,vars:0,template:function(t,i){1&t&&(e.TgZ(0,"p"),e._uU(1,"expenses-inv-dialog works!"),e.qZA())}});const oe=[{path:"",redirectTo:"receivable-list",pathMatch:"full"},{path:"receivable-list",component:V,data:{breadcrumb:"ReceiptVouchers"}},{path:"receivable-add/:id",component:w,data:{breadcrumb:"EditReceiptVoucher"}},{path:"receivable-add",component:w,data:{breadcrumb:"AddReceiptVoucher"}},{path:"payable-list",component:B,data:{breadcrumb:"PaymentVouchers"}},{path:"payable-add/:id",component:M,data:{breadcrumb:"EditPaymentVoucher"}},{path:"payable-add",component:M,data:{breadcrumb:"AddPaymentVoucher"}},{path:"expensesinv-list",component:j,data:{breadcrumb:"ExpensesInvoice"}},{path:"expensesinv-add/:id",component:K,data:{breadcrumb:"EditExpensesInvoice"}},{path:"expensesinv-add",component:K,data:{breadcrumb:"AddExpensesInvoice"}}];class q{}q.\u0275fac=function(t){return new(t||q)},q.\u0275mod=e.oAB({type:q}),q.\u0275inj=e.cJS({imports:[ve.JF,p.u5,N.JX,Pe.D,h.ez,m.Bz.forChild(oe),p.UX,xe.m,N.JX,Y.A0]})},1419:(re,k,u)=>{u.d(k,{DA:()=>C,G2:()=>Z,JQ:()=>P,dg:()=>e,go:()=>b,mo:()=>T,pL:()=>v,sp:()=>_});var h=u(4650);class b{transform(l,d){let o=new RegExp(d,"ig");if(l)return l.filter(a=>a.profile.name?-1!==a.profile.name.search(o):-1!==a.username.search(o))}}b.\u0275fac=function(l){return new(l||b)},b.\u0275pipe=h.Yjl({name:"UserSearchPipe",type:b,pure:!1});class T{transform(l,d){if(!l)return null;if(!d)return l;let o=new RegExp(d,"ig");return l?l.filter(a=>a.first_name&&-1!==a.first_name.search(o)?-1!==a.first_name.search(o):a.last_name&&-1!==a.last_name.search(o)?-1!==a.last_name.search(o):a.UserMobile&&-1!==a.UserMobile.search(o)?-1!==a.UserMobile.search(o):a.userJobName?-1!==a.userJobName.search(o)?-1!==a.userJobName.search(o):void 0:-1!==a.username.search(o)):void 0}}T.\u0275fac=function(l){return new(l||T)},T.\u0275pipe=h.Yjl({name:"EmpSearchPipe",type:T,pure:!1});class _{transform(l,d){if(!l)return null;if(!d)return l;let o=new RegExp(d,"ig");return l?l.filter(a=>a.OWNFirstName&&-1!==a.OWNFirstName.search(o)?-1!==a.OWNFirstName.search(o):a.OWNLastName&&-1!==a.OWNLastName.search(o)?-1!==a.OWNLastName.search(o):a.OWNName&&-1!==a.OWNName.search(o)?-1!==a.OWNName.search(o):a.OWNMobile&&-1!==a.OWNMobile.search(o)?-1!==a.OWNMobile.search(o):a.OWNMobileWhatsapp?-1!==a.OWNMobileWhatsapp.search(o)?-1!==a.OWNMobileWhatsapp.search(o):void 0:-1!==a.username.search(o)):void 0}}_.\u0275fac=function(l){return new(l||_)},_.\u0275pipe=h.Yjl({name:"OwnerSearchPipe",type:_,pure:!1});class Z{transform(l,d){if(!l)return null;if(!d)return l;let o=new RegExp(d,"ig");return l?l.filter(a=>a.branch_ArbName&&-1!==a.branch_ArbName.search(o)?-1!==a.branch_ArbName.search(o):a.BUIName&&-1!==a.BUIName.search(o)?-1!==a.BUIName.search(o):a.owner_FullName&&-1!==a.owner_FullName.search(o)?-1!==a.owner_FullName.search(o):a.BUIPropertyTypeDisplay&&-1!==a.BUIPropertyTypeDisplay.search(o)?-1!==a.BUIPropertyTypeDisplay.search(o):a.BUIPropertyUsageTypeDisplay&&-1!==a.BUIPropertyUsageTypeDisplay.search(o)?-1!==a.BUIPropertyUsageTypeDisplay.search(o):a.BUIElectricityCountersWrittenCode&&-1!==a.BUIElectricityCountersWrittenCode.search(o)?-1!==a.BUIElectricityCountersWrittenCode.search(o):a.BUIWaterCountersWrittenCode&&-1!==a.BUIWaterCountersWrittenCode.search(o)?-1!==a.BUIWaterCountersWrittenCode.search(o):a.BUIGasCountersWrittenCode?-1!==a.BUIGasCountersWrittenCode.search(o)?-1!==a.BUIGasCountersWrittenCode.search(o):-1!==a.BUIName.search(o):-1!=a.BUIName.search(o)):void 0}}Z.\u0275fac=function(l){return new(l||Z)},Z.\u0275pipe=h.Yjl({name:"BuildingSearchPipe",type:Z,pure:!1});class v{transform(l,d){if(!l)return null;if(!d)return l;let o=new RegExp(d,"ig");return l?l.filter(a=>a.branch_ArbName&&-1!==a.branch_ArbName.search(o)?-1!==a.branch_ArbName.search(o):a.owner_FullName&&-1!==a.owner_FullName.search(o)?-1!==a.owner_FullName.search(o):a.build_Name&&-1!==a.build_Name.search(o)?-1!==a.build_Name.search(o):a.UNTUnitNumber&&-1!==a.UNTUnitNumber.search(o)?-1!==a.UNTUnitNumber.search(o):a.UNTHousingStatusDisplay&&-1!==a.UNTHousingStatusDisplay.search(o)?-1!==a.UNTHousingStatusDisplay.search(o):a.UNTUnitFileNumber&&-1!==a.UNTUnitFileNumber.search(o)?-1!==a.UNTUnitFileNumber.search(o):a.UNTUnitTypeDisplay&&-1!==a.UNTUnitTypeDisplay.search(o)?-1!==a.UNTUnitTypeDisplay.search(o):a.UNTElectricityNumber&&-1!==a.UNTElectricityNumber.search(o)?-1!==a.UNTElectricityNumber.search(o):a.UNTWaterNumber&&-1!==a.UNTWaterNumber.search(o)?-1!==a.UNTWaterNumber.search(o):a.UNTGasNumber&&-1!==a.UNTGasNumber.search(o)?-1!==a.UNTGasNumber.search(o):a.UNTFloorNumber?-1!==a.UNTFloorNumber.toString().search(o)?-1!==a.UNTFloorNumber.toString().search(o):-1!==a.UNTUnitNumber.search(o):-1!=a.UNTUnitNumber.search(o)):void 0}}v.\u0275fac=function(l){return new(l||v)},v.\u0275pipe=h.Yjl({name:"UnitsSearchPipe",type:v,pure:!1});class e{transform(l,d){if(!l)return null;if(!d)return l;let o=new RegExp(d,"ig");return l?l.filter(a=>a.branch_ArbName&&-1!==a.branch_ArbName.search(o)?-1!==a.branch_ArbName.search(o):a.unit_UnitNumber&&-1!==a.unit_UnitNumber.search(o)?-1!==a.unit_UnitNumber.search(o):a.build_Name&&-1!==a.build_Name.search(o)?-1!==a.build_Name.search(o):a.customer_Name&&-1!==a.customer_Name.search(o)?-1!==a.customer_Name.search(o):a.PDOPrintedCode&&-1!==a.PDOPrintedCode.search(o)?-1!==a.PDOPrintedCode.search(o):a.PDOEjarCode&&-1!==a.PDOEjarCode.search(o)?-1!==a.PDOEjarCode.search(o):a.PDOCode&&-1!==a.PDOCode.toString().search(o)?-1!==a.PDOCode.toString().search(o):a.contract_Code&&-1!==a.contract_Code.toString().search(o)?-1!==a.contract_Code.toString().search(o):a.contract_EjarCode?-1!==a.contract_EjarCode.toString().search(o)?-1!==a.contract_EjarCode.toString().search(o):-1!==a.build_Name.search(o):-1!=a.unit_UnitNumber.search(o)):void 0}}e.\u0275fac=function(l){return new(l||e)},e.\u0275pipe=h.Yjl({name:"PayDocumentsSearchPipe",type:e,pure:!1});class P{transform(l,d){if(!l)return null;if(!d)return l;let o=new RegExp(d,"ig");return l?l.filter(a=>a.build_Name&&-1!==a.build_Name.search(o)?-1!==a.build_Name.search(o):a.unit_UnitNumber&&-1!==a.unit_UnitNumber.search(o)?-1!==a.unit_UnitNumber.search(o):a.customer_Name&&-1!==a.customer_Name.search(o)?-1!==a.customer_Name.search(o):a.customer_Mobile&&-1!==a.customer_Mobile.search(o)?-1!==a.customer_Mobile.search(o):a.RCOCode&&-1!==a.RCOCode.toString().search(o)?-1!==a.RCOCode.toString().search(o):a.RCOEjarCode?-1!==a.RCOEjarCode.toString().search(o)?-1!==a.RCOEjarCode.toString().search(o):-1!==a.build_Name.search(o):-1!=a.unit_UnitNumber.search(o)):void 0}}P.\u0275fac=function(l){return new(l||P)},P.\u0275pipe=h.Yjl({name:"ContractSearchPipe",type:P,pure:!1});class C{transform(l,d){if(!l)return null;if(!d)return l;let o=new RegExp(d,"ig");return l?l.filter(a=>a.CUSName&&-1!==a.CUSName.search(o)?-1!==a.CUSName.search(o):a.CUSMobile&&-1!==a.CUSMobile.search(o)?-1!==a.CUSMobile.search(o):a.unit_Name&&-1!==a.unit_Name.search(o)?-1!==a.unit_Name.search(o):a.build_Name&&-1!==a.build_Name.search(o)?-1!==a.build_Name.search(o):a.job_Name&&-1!==a.job_Name.search(o)?-1!==a.job_Name.search(o):a.workplace_Name?-1!==a.workplace_Name.search(o)?-1!==a.workplace_Name.search(o):-1!==a.CUSName.search(o):-1!=a.CUSName.search(o)):void 0}}C.\u0275fac=function(l){return new(l||C)},C.\u0275pipe=h.Yjl({name:"TenantSearchPipe",type:C,pure:!1});class A{transform(l,d){let o=new RegExp(d,"ig");if(l)return l.filter(a=>a.CUSMobile?-1!==a.CUSMobile.search(o):-1!==a.CUSName.search(o))}}A.\u0275fac=function(l){return new(l||A)},A.\u0275pipe=h.Yjl({name:"TenantMobileSearchPipe",type:A,pure:!1})}}]);