"use strict";(self.webpackChunkemporium=self.webpackChunkemporium||[]).push([[368],{6002:(A,h,s)=>{s.d(h,{Z:()=>o});var l=s(5521),e=s(2340),p=s(4650),m=s(529),g=s(7465);class o{constructor(t,n){this.http=t,this.globalServ=n,this.baseUrl=(new l.P).api_Ip,this.secondPartUrl=(new l.P).api_constant,this.curCOMId=e.N.comid}getAllBranch(t,n){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/allBranches/?M="+t+"&C="+n,this.globalServ.getAuthHeaders())}getOneBranch(t){return console.log(this.baseUrl+this.secondPartUrl+"atlas/branch/"+t+"/"),this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/"+t+"/",this.globalServ.getAuthHeaders())}getMainBranch(t,n){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/branchPerSpec/?M="+t+"&C="+n+"&Main=T",this.globalServ.getAuthHeaders())}getBranchPerEmp(t,n,d){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/branchPerSpec/?M="+t+"&C="+n+"&emp="+d,this.globalServ.getAuthHeaders())}sendSms(t,n,d){return this.http.post(t,n,this.globalServ.smsHeaders(d))}sendSmsData(t,n){const d=new FormData;return d.append("bearerTokens",n),d.append("sender","Jeddah Lake"),d.append("recipients","966503002323"),d.append("body","125478"),this.http.post(t,d,this.globalServ.smsHeaders(n))}sendSmsGet(t){return this.http.get(t)}sendSmsGetToken(t,n){return this.http.get(t,this.globalServ.smsHeaders(n))}addBranch(t){return this.http.post(this.baseUrl+this.secondPartUrl+"atlas/branch/",t,this.globalServ.getAuthHeaders())}editBranch(t,n){return this.http.put(this.baseUrl+this.secondPartUrl+"atlas/branch/"+n+"/",t,this.globalServ.getAuthHeaders())}deleteBranch(t){return this.http.delete(this.baseUrl+this.secondPartUrl+"atlas/branch/"+t+"/",this.globalServ.getAuthHeaders())}softDeleteBranch(t){return this.http.put(this.baseUrl+this.secondPartUrl+"atlas/branch/"+t+"/",{RowDelete:1},this.globalServ.getAuthHeaders())}}o.\u0275fac=function(t){return new(t||o)(p.LFG(m.eN),p.LFG(g.U))},o.\u0275prov=p.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})},9368:(A,h,s)=>{s.d(h,{Z:()=>x});var l=s(5412),e=s(4006),p=s(2340),m=s(2887);class g{}var o=s(6895),u=s(4459),t=s(4650),n=s(6002),d=s(3705),Z=s(3081),C=s(6838),b=s(5298),M=s(7009),E=s(1576),S=s(3238),_=s(4859),D=s(3546),f=s(9602),P=s(7392),O=s(4144),U=s(9549),L=s(4850),F=s(4385),y=s(266);function I(r,a){if(1&r&&(t.TgZ(0,"mat-option",7),t._uU(1),t.qZA()),2&r){const i=a.$implicit;t.Q6J("value",i.id),t.xp6(1),t.hij(" ",i.CTTSubjectName," ")}}function N(r,a){if(1&r){const i=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){t.CHM(i);const v=t.oxw();return t.KtG(v.onSave())}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA()()}if(2&r){const i=t.oxw();t.Q6J("disabled",!i.dataForm.valid),t.xp6(2),t.Oqu(t.lcZ(3,2,"BTN.SAVE"))}}function B(r,a){if(1&r){const i=t.EpF();t.TgZ(0,"div",30)(1,"button",31),t.NdJ("click",function(){t.CHM(i);const v=t.oxw().$implicit,T=t.oxw();return t.KtG(T.remove(v.id))}),t.ALo(2,"translate"),t.TgZ(3,"mat-icon"),t._uU(4,"delete"),t.qZA()()()}2&r&&(t.xp6(1),t.s9C("matTooltip",t.lcZ(2,1,"BTN.REMOVE")))}function H(r,a){if(1&r&&(t.TgZ(0,"div",27)(1,"div",28),t._uU(2),t.qZA(),t.TgZ(3,"div",28),t._uU(4),t.qZA(),t.TgZ(5,"div",28),t._uU(6),t.qZA(),t.TgZ(7,"div",28),t._uU(8),t.qZA(),t.TgZ(9,"div",28),t.YNc(10,B,5,3,"div",29),t.qZA()()),2&r){const i=a.$implicit,c=t.oxw();t.xp6(2),t.Oqu(i.expense_Name),t.xp6(2),t.Oqu(i.UEXExpenseValue),t.xp6(2),t.hij("",i.UEXDate," "),t.xp6(2),t.hij("",i.UEXNotes," "),t.xp6(2),t.Q6J("ngIf",c.can("view_deleteunitexpenses"))}}class x{constructor(a,i,c,v,T,X,R,K,Y,w){this.dialogRef=a,this.unitInjected=i,this.atlasService=c,this.unitsService=v,this.translateService=T,this._codesService=X,this.localStore=R,this.dialog=K,this.snackBar=Y,this.fb=w,this.passwordHide=!0,this.curCOMId=p.N.comid,this.userPerm=[],this.AllExpences=[]}ngOnInit(){this.parentExpenseCTT=(new u.I).Expenses,this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let a=0;a<this.curUserPermissions.length;a++)this.userPerm[a]=this.curUserPermissions[a].codename;this.dataForm=this.fb.group({unit_KeyField:[null,e.kI.required],expense_CTTKeyField:[null,e.kI.required],UEXDate:null,UEXExpenseValue:0,UEXNotes:null}),this.dataForm.patchValue({unit_KeyField:this.unitInjected.unitRow.id}),this.Expenses=new g,this.curPeriority=this.unitInjected.periorty,this.action="Patch",this.getAllExpenses(this.curCOMId,this.curPeriority),this.getUnitExpense(),this.prepareMsgLanguage()}can(a){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(a))}getUnitExpense(){this.unitsExpenses=null,this.unitsService.getAllExpensesForUnit(this.curCOMId,this.curPeriority,this.unitInjected.unitRow.id).subscribe(a=>this.unitsExpenses=a)}getAllExpenses(a,i){this._codesService.getSubForParent(a,i,this.parentExpenseCTT).subscribe(c=>{this.AllExpences=c,console.log("---this.AllExpences:: "+this.AllExpences)},c=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0645\u0635\u0627\u0631\u064a\u0641","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}mapFormValue_toTable(){const a=new o.uU("en-GB").transform(this.dataForm.value.UEXDate,"dd/MM/yyyy");this.Expenses.unit_KeyField=this.unitInjected.unitRow.id,this.Expenses.expense_CTTKeyField=this.dataForm.value.expense_CTTKeyField,this.Expenses.UEXDate=this.dataForm.value.UEXDate,this.Expenses.UEXNotes=this.dataForm.value.UEXNotes,this.Expenses.UEXExpenseValue=this.dataForm.value.UEXExpenseValue,null!=this.dataForm.value.UEXDate&&(this.Expenses.UEXDate=a)}onSave(){this.mapFormValue_toTable(),this.unitsService.addExpensesForUnits(this.Expenses).subscribe(()=>{this.snackBar.open(this.dataSavedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getUnitExpense()})}close(){this.action="Cancel",console.log("===***Press Close button***==="),this.dialogRef.close({event:this.action})}remove(a){this.dialog.open(m.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(c=>{c&&this.unitsService.deleteExpensesForUnit(a).subscribe(()=>{this.snackBar.open(this.deletedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getUnitExpense()})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.DataSaved").subscribe(a=>{this.dataSavedMsg=a}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(a=>{this.askToDeletedMsg=a}),this.translateService.get("MESSAGE.DELETED").subscribe(a=>{this.deletedMsg=a}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(a=>{this.deletedTitleMsg=a})}}x.\u0275fac=function(a){return new(a||x)(t.Y36(l.so),t.Y36(l.WI),t.Y36(n.Z),t.Y36(d.X),t.Y36(Z.sK),t.Y36(C.d),t.Y36(b.C),t.Y36(l.uw),t.Y36(M.ux),t.Y36(e.QS))},x.\u0275cmp=t.Xpm({type:x,selectors:[["app-unit-expenses"]],decls:70,vars:39,consts:[["autocomplete","off",3,"formGroup"],["mat-dialog-content",""],["fxLayout","row wrap"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["fxFlex","100","fxFlex.gt-sm","35.0",1,"px-1"],["appearance","outline",1,"w-100"],["formControlName","expense_CTTKeyField","id","expenseContOpSel",3,"placeholder"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","100","fxFlex.gt-sm","34.6",1,"px-1"],["matInput","","formControlName","UEXExpenseValue"],["fxFlex","100","fxFlex.gt-sm","30.0",1,"px-1"],["matInput","","formControlName","UEXDate","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["UEXDate",""],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","UEXNotes","rows","3"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],[1,"p-2"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],["class","p-2 actions",4,"ngIf"],[1,"p-2","actions"],["mat-mini-fab","","color","warn",1,"mx-1",3,"matTooltip","click"]],template:function(a,i){if(1&a&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"mat-select",6),t.ALo(10,"translate"),t.TgZ(11,"mat-option",7),t._uU(12,"-"),t.qZA(),t.YNc(13,I,2,2,"mat-option",8),t.qZA()()(),t.TgZ(14,"div",9)(15,"mat-form-field",5)(16,"mat-label"),t._uU(17),t.ALo(18,"translate"),t.qZA(),t._UZ(19,"input",10),t.qZA()(),t.TgZ(20,"div",11)(21,"mat-form-field",5)(22,"mat-label"),t._uU(23),t.ALo(24,"translate"),t.qZA(),t._UZ(25,"input",12)(26,"mat-datepicker-toggle",13)(27,"mat-datepicker",null,14),t.qZA()()(),t.TgZ(29,"div",3)(30,"div",15)(31,"mat-form-field",5)(32,"mat-label"),t._uU(33),t.ALo(34,"translate"),t.qZA(),t._UZ(35,"textarea",16),t.qZA()()()()(),t.TgZ(36,"div",17)(37,"div",3),t.YNc(38,N,4,4,"button",18),t.TgZ(39,"button",19),t.NdJ("click",function(){return i.close()}),t._uU(40),t.ALo(41,"translate"),t.qZA()()(),t._UZ(42,"mat-divider"),t.TgZ(43,"div",20)(44,"mat-card")(45,"div",21)(46,"h2"),t._uU(47),t.ALo(48,"translate"),t.qZA()(),t._UZ(49,"mat-divider"),t.TgZ(50,"div",22)(51,"div",23)(52,"div",24)(53,"h2"),t._uU(54),t.ALo(55,"translate"),t.qZA()(),t.TgZ(56,"div",24)(57,"h2"),t._uU(58),t.ALo(59,"translate"),t.qZA()(),t.TgZ(60,"div",24)(61,"h2"),t._uU(62),t.ALo(63,"translate"),t.qZA()(),t.TgZ(64,"div",24)(65,"h2"),t._uU(66),t.ALo(67,"translate"),t.qZA()(),t._UZ(68,"div",24),t.qZA(),t.YNc(69,H,11,5,"div",25),t.qZA()()()()),2&a){const c=t.MAs(28);t.Q6J("formGroup",i.dataForm),t.xp6(7),t.hij(" ",t.lcZ(8,17,"HTML.Expenses"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(10,19,"HTML.Expenses")),t.xp6(4),t.Q6J("ngForOf",i.AllExpences),t.xp6(4),t.Oqu(t.lcZ(18,21,"HTML.ExpenseValue")),t.xp6(6),t.Oqu(t.lcZ(24,23,"HTML.Date")),t.xp6(2),t.Q6J("matDatepicker",c),t.xp6(1),t.Q6J("for",c),t.xp6(7),t.Oqu(t.lcZ(34,25,"HTML.Notes")),t.xp6(5),t.Q6J("ngIf",i.can("view_addunitexpenses")),t.xp6(2),t.Oqu(t.lcZ(41,27,"BTN.CANCEL")),t.xp6(7),t.Oqu(t.lcZ(48,29,"HTML.UnitExpenses")),t.xp6(7),t.hij(" ",t.lcZ(55,31,"HTML.Expenses")," "),t.xp6(4),t.hij(" ",t.lcZ(59,33,"HTML.ExpenseValue")," "),t.xp6(4),t.hij(" ",t.lcZ(63,35,"HTML.Date")," "),t.xp6(4),t.hij(" ",t.lcZ(67,37,"HTML.Notes")," "),t.xp6(3),t.Q6J("ngForOf",i.unitsExpenses)}},dependencies:[e._Y,e.Fj,e.JJ,e.JL,e.Q7,o.sg,o.O5,e.sg,e.u,E.xw,E.Wh,E.yH,S.ey,_.lW,_.nh,D.a8,f.Mq,f.hl,f.nW,l.xY,l.H8,P.Hw,O.Nt,U.KE,U.hX,U.R9,L.d,F.gD,y.gM,Z.X$],styles:[".user-form[_ngcontent-%COMP%]   .form-field-outer[_ngcontent-%COMP%]{width:680px}.user-form[_ngcontent-%COMP%]   .mat-mdc-radio-button[_ngcontent-%COMP%]{margin-right:12px}.auth[_ngcontent-%COMP%]{white-space:nowrap;padding:7px 14px;font-weight:500}"]})},2887:(A,h,s)=>{s.d(h,{$:()=>o});var l=s(5412),e=s(4650),p=s(1576),m=s(4859),g=s(3081);class o{constructor(t,n){this.dialogRef=t,this.data=n}ngOnInit(){}onConfirm(){this.dialogRef.close(!0)}onDismiss(){this.dialogRef.close(!1)}}o.\u0275fac=function(t){return new(t||o)(e.Y36(l.so),e.Y36(l.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-confirm-dialog"]],decls:13,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"h1",0),e._uU(1),e.qZA(),e.TgZ(2,"div",1)(3,"p"),e._uU(4),e.qZA()(),e.TgZ(5,"div",2)(6,"div",3)(7,"button",4),e.NdJ("click",function(){return n.onDismiss()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",5),e.NdJ("click",function(){return n.onConfirm()}),e._uU(11),e.ALo(12,"translate"),e.qZA()()()),2&t&&(e.xp6(1),e.Oqu(null==n.data?null:n.data.title),e.xp6(3),e.Oqu(null==n.data?null:n.data.message),e.xp6(4),e.Oqu(e.lcZ(9,4,"BTN.NO")),e.xp6(3),e.Oqu(e.lcZ(12,6,"BTN.YES")))},dependencies:[p.xw,p.Wh,m.lW,l.uh,l.xY,l.H8,g.X$]})}}]);