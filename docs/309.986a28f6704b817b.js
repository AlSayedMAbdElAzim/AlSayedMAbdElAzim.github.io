"use strict";(self.webpackChunkemporium=self.webpackChunkemporium||[]).push([[309],{5309:(V,O,i)=>{i.r(O),i.d(O,{AtlasModule:()=>w,routes:()=>X});var m=i(6895),l=i(9132),s=i(4006),v=i(9442),b=i(4333),y=i(3609),Z=i(1596),g=i(5783),_=i(5521),e=i(4650),c=i(5298),h=i(6381),A=i(7465),F=i(7009),B=i(1182),C=i(1576),z=i(5829),R=i(3238),U=i(4859),I=i(3546),q=i(4144),T=i(9549),J=i(4385),x=i(3081);function ee(n,t){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.ADD")))}function te(n,t){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function ae(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.REQUIRED")," "))}const j=function(){return{min:4}};function ne(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.xi3(2,1,"ERROR.MINLENGTH",e.DdM(4,j))," "))}function re(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.REQUIRED")," "))}function ie(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.xi3(2,1,"ERROR.MINLENGTH",e.DdM(4,j))," "))}function oe(n,t){if(1&n&&(e.TgZ(0,"mat-option",27),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&n){const a=t.$implicit;e.Q6J("value",a),e.xp6(1),e.hij(" ",e.lcZ(2,2,a)," ")}}function se(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ERROR.REQUIRED")," "))}const le=function(n){return{"background-color":n}};function ce(n,t){if(1&n&&e._UZ(0,"div",28),2&n){const a=e.oxw();e.Q6J("ngStyle",e.VKq(1,le,a.companyData_Form.controls.COMTheme.value))}}function ue(n,t){if(1&n&&(e.TgZ(0,"div",29)(1,"button",30),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&n){const a=e.oxw();e.xp6(1),e.Q6J("disabled",a.companyData_Form.invalid),e.xp6(1),e.hij(" ",e.lcZ(3,2,"BTN.SAVE")," ")}}class D{constructor(t,a,r,o,d,M,E){this.localStore=t,this._companyService=a,this.global=r,this.router=o,this.snackBar=d,this.fb=M,this.appSettings=E,this.noImageUrl="",this.account=new g.n,this.themeColors=["green","blue","red","pink","purple","grey"],this.userPerm=[],this.fileToUpload=null,this.companyData_Form=this.fb.group({COMCode:[],COMAraName:["",[s.kI.required,s.kI.minLength(4)]],COMLogo:[],COMEngName:["",[s.kI.required,s.kI.minLength(4)]],COMDisplayedName:[""],COMAddress:[""],COMPhone:[""],COMMobile:[""],COMFax:[""],COMUnifiedNumber:[""],COMTheme:["blue",s.kI.required]}),this.baseUrl=this.appSettings.settings.url,this.secondPartUrl=new _.P(this.baseUrl).api_constant,this.noImageUrl=new _.P(this.baseUrl).noImage,this.url=this.noImageUrl}ngOnDestroy(){this.userSUb&&this.userSUb.unsubscribe()}ngOnInit(){this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")&&(this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curCOMId=this.curUserData.COMId,this.appSetup=JSON.parse(this.localStore.getItem("appsetup")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions")),this.userPerm=this.curUserPermissions.map(t=>t.codename),this.get_CompanyData(this.curCOMId,this.account.periorty))}can(t){return this.curUserData.is_superuser||this.userPerm.includes(t)}handelFileInput(t){if(this.fileToUpload=t.item(0),this.fileToUpload){const a=new FileReader;a.onload=r=>{this.url=r.target.result},a.readAsDataURL(this.fileToUpload)}}get_CompanyData(t,a){this._companyService.getCompany(t,a).subscribe(r=>{this.companyDataPatchValues(r[0]),this.url=r[0].COMLogo||this.noImageUrl},r=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0634\u0631\u0643\u0629","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}mappingCompanyDataFormToClass(){this.initializationForCompany(),this.newCompanyData.COMCode=this.companyData_Form.value.COMCode,this.newCompanyData.COMAraName=this.companyData_Form.value.COMAraName,this.newCompanyData.COMEngName=this.companyData_Form.value.COMEngName,this.newCompanyData.COMAddress=this.companyData_Form.value.COMAddress,this.newCompanyData.COMPhone=this.companyData_Form.value.COMPhone,this.newCompanyData.COMMobile=this.companyData_Form.value.COMMobile,this.newCompanyData.COMFax=this.companyData_Form.value.COMFax,this.newCompanyData.COMUnifiedNumber=this.companyData_Form.value.COMUnifiedNumber,this.newCompanyData.COMDisplayedName=this.companyData_Form.value.COMDisplayedName,this.newCompanyData.COMTheme=this.companyData_Form.value.COMTheme}companyDataPatchValues(t){this.companyData_Form.patchValue({COMCode:t.COMCode,COMAraName:t.COMAraName,COMEngName:t.COMEngName,COMAddress:t.COMAddress,COMPhone:t.COMPhone,COMMobile:t.COMMobile,COMFax:t.COMFax,COMUnifiedNumber:t.COMUnifiedNumber,COMDisplayedName:t.COMDisplayedName,COMTheme:t.COMTheme||"blue"})}initializationForCompany(){this.newCompanyData={COMId:this.curCOMId,EntryDate:null,EntryUser:null,RowConfirm:0,RowStatus:0,RowDelete:0,COMCode:null,COMAraName:"",COMEngName:"",COMDisplayedName:"",COMLogo:null,COMAddress:"",COMPhone:"",COMMobile:"",COMFax:"",COMUnifiedNumber:"",COMTheme:"blue"}}saveEditCompanyData(){this.companyData_Form.invalid||(this.mappingCompanyDataFormToClass(),this._companyService.editCompany(this.newCompanyData,this.curCOMId,this.fileToUpload).subscribe(()=>{this.snackBar.open("\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0634\u0631\u0643\u0647","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["atlas/company"])},t=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u062d\u0641\u0638 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0634\u0631\u0643\u0629","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}))}}D.\u0275fac=function(t){return new(t||D)(e.Y36(c.C),e.Y36(h.J),e.Y36(A.U),e.Y36(l.F0),e.Y36(F.ux),e.Y36(s.qu),e.Y36(B.d))},D.\u0275cmp=e.Xpm({type:D,selectors:[["app-company-info"]],decls:81,vars:45,consts:[[1,"p-2"],[4,"ngIf"],[1,"pt-3"],["autocomplete","off","fxLayout","column","fxLayoutGap","16px",3,"formGroup","ngSubmit"],["fxFlex","100",1,"px-2"],["width","200","height","150","id","campanyLogo","alt","Company Logo",3,"src"],[1,"file-upload"],["for","upload",1,"d-block","file-upload__label"],["type","file","id","upload","formControlName","COMLogo","name","COMLogo","accept","image/*",1,"file-upload__input",3,"change"],["fxFlex","100","fxLayout","row wrap","fxLayoutGap","8px",1,"px-2"],["fxFlex","100","fxFlex.gt-sm","49",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","COMAraName","required",""],["matInput","","formControlName","COMEngName","required","","readonly",""],["matInput","","formControlName","COMDisplayedName"],["matInput","","formControlName","COMMobile"],["fxFlex","100","fxFlex.gt-sm","33",1,"px-1"],["matInput","","formControlName","COMUnifiedNumber"],["matInput","","formControlName","COMPhone"],["matInput","","formControlName","COMFax"],["fxFlex","100","fxFlex.gt-sm","50","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px",1,"px-1"],["formControlName","COMTheme","required",""],[3,"value",4,"ngFor","ngForOf"],["class","theme-preview",3,"ngStyle",4,"ngIf"],["fxFlex","100",1,"px-1"],["matInput","","formControlName","COMAddress","rows","3"],["fxFlex","100","class","mt-2 text-center w-100",4,"ngIf"],[3,"value"],[1,"theme-preview",3,"ngStyle"],["fxFlex","100",1,"mt-2","text-center","w-100"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"h1"),e.YNc(5,ee,3,3,"span",1),e.YNc(6,te,3,3,"span",1),e._uU(7),e.ALo(8,"translate"),e.qZA()()(),e.TgZ(9,"mat-card-content",2)(10,"form",3),e.NdJ("ngSubmit",function(){return a.saveEditCompanyData()}),e.TgZ(11,"div",4),e._UZ(12,"img",5),e.TgZ(13,"div",6)(14,"label",7),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"input",8),e.NdJ("change",function(o){return a.handelFileInput(o.target.files)}),e.qZA()()(),e.TgZ(18,"div",9)(19,"div",10)(20,"mat-form-field",11)(21,"mat-label"),e._uU(22),e.ALo(23,"translate"),e.qZA(),e._UZ(24,"input",12),e.YNc(25,ae,3,3,"mat-error",1),e.YNc(26,ne,3,5,"mat-error",1),e.qZA()(),e.TgZ(27,"div",10)(28,"mat-form-field",11)(29,"mat-label"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e._UZ(32,"input",13),e.YNc(33,re,3,3,"mat-error",1),e.YNc(34,ie,3,5,"mat-error",1),e.qZA()(),e.TgZ(35,"div",10)(36,"mat-form-field",11)(37,"mat-label"),e._uU(38),e.ALo(39,"translate"),e.qZA(),e._UZ(40,"input",14),e.qZA()(),e.TgZ(41,"div",10)(42,"mat-form-field",11)(43,"mat-label"),e._uU(44),e.ALo(45,"translate"),e.qZA(),e._UZ(46,"input",15),e.qZA()(),e.TgZ(47,"div",16)(48,"mat-form-field",11)(49,"mat-label"),e._uU(50),e.ALo(51,"translate"),e.qZA(),e._UZ(52,"input",17),e.qZA()(),e.TgZ(53,"div",16)(54,"mat-form-field",11)(55,"mat-label"),e._uU(56),e.ALo(57,"translate"),e.qZA(),e._UZ(58,"input",18),e.qZA()(),e.TgZ(59,"div",16)(60,"mat-form-field",11)(61,"mat-label"),e._uU(62),e.ALo(63,"translate"),e.qZA(),e._UZ(64,"input",19),e.qZA()(),e.TgZ(65,"div",20)(66,"mat-form-field",11)(67,"mat-label"),e._uU(68),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"mat-select",21),e.YNc(71,oe,3,4,"mat-option",22),e.qZA(),e.YNc(72,se,3,3,"mat-error",1),e.qZA(),e.YNc(73,ce,1,3,"div",23),e.qZA(),e.TgZ(74,"div",24)(75,"mat-form-field",11)(76,"mat-label"),e._uU(77),e.ALo(78,"translate"),e.qZA(),e._UZ(79,"textarea",25),e.qZA()(),e.YNc(80,ue,4,4,"div",26),e.qZA()()()()()),2&t&&(e.xp6(5),e.Q6J("ngIf",!a.curCOMId),e.xp6(1),e.Q6J("ngIf",a.curCOMId),e.xp6(1),e.hij(" ",e.lcZ(8,23,"HTML.COMPANYDATA")," "),e.xp6(3),e.Q6J("formGroup",a.companyData_Form),e.xp6(2),e.Q6J("src",a.url,e.LSH),e.xp6(3),e.Oqu(e.lcZ(16,25,"HTML.Logo")),e.xp6(7),e.Oqu(e.lcZ(23,27,"HTML.ArabicName")),e.xp6(3),e.Q6J("ngIf",null==a.companyData_Form.controls.COMAraName.errors?null:a.companyData_Form.controls.COMAraName.errors.required),e.xp6(1),e.Q6J("ngIf",a.companyData_Form.controls.COMAraName.hasError("minlength")),e.xp6(4),e.Oqu(e.lcZ(31,29,"HTML.EnglishName")),e.xp6(3),e.Q6J("ngIf",null==a.companyData_Form.controls.COMEngName.errors?null:a.companyData_Form.controls.COMEngName.errors.required),e.xp6(1),e.Q6J("ngIf",a.companyData_Form.controls.COMEngName.hasError("minlength")),e.xp6(4),e.Oqu(e.lcZ(39,31,"HTML.DisplayedName")),e.xp6(6),e.Oqu(e.lcZ(45,33,"HTML.MOBILE")),e.xp6(6),e.Oqu(e.lcZ(51,35,"HTML.UnifiedNumber")),e.xp6(6),e.Oqu(e.lcZ(57,37,"HTML.WORK_PHONE")),e.xp6(6),e.Oqu(e.lcZ(63,39,"HTML.Fax")),e.xp6(6),e.Oqu(e.lcZ(69,41,"HTML.ThemeColor")),e.xp6(3),e.Q6J("ngForOf",a.themeColors),e.xp6(1),e.Q6J("ngIf",null==a.companyData_Form.controls.COMTheme.errors?null:a.companyData_Form.controls.COMTheme.errors.required),e.xp6(1),e.Q6J("ngIf",a.companyData_Form.controls.COMTheme.value),e.xp6(4),e.Oqu(e.lcZ(78,43,"HTML.ADDRESS")),e.xp6(3),e.Q6J("ngIf",a.can("change_company")))},dependencies:[m.sg,m.O5,m.PC,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,C.xw,C.SQ,C.Wh,C.yH,z.Zl,R.ey,U.lW,I.a8,I.dn,I.dk,I.n5,q.Nt,T.KE,T.hX,T.TO,J.gD,m.rS,x.X$],styles:[".file-upload[_ngcontent-%COMP%]{margin-top:10px}.file-upload__label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333}.file-upload__input[_ngcontent-%COMP%]{margin-top:5px}.w-100[_ngcontent-%COMP%]{width:100%}.theme-preview[_ngcontent-%COMP%]{width:30px;height:30px;border-radius:4px;display:inline-block;margin-left:10px;vertical-align:middle;border:1px solid #ccc}"]});var u=i(4459),f=i(5412),pe=i(6709);function de(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Arabic Name is required"),e.qZA())}function me(n,t){if(1&n&&(e.TgZ(0,"mat-option",20)(1,"span"),e._uU(2),e.qZA()()),2&n){const a=t.$implicit;e.Q6J("value",a.id),e.xp6(2),e.Oqu(a.CTTSubjectName)}}function he(n,t){if(1&n&&(e.TgZ(0,"mat-option",21)(1,"span"),e._uU(2),e.qZA()()),2&n){const a=t.$implicit;e.Q6J("value",a.id),e.xp6(2),e.Oqu(a.CTTSubjectName)}}function ge(n,t){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.SAVE")))}function Ce(n,t){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function _e(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.onSave())}),e.YNc(1,ge,3,3,"span",7),e.YNc(2,Ce,3,3,"span",7),e.qZA()}if(2&n){const a=e.oxw();e.Q6J("mat-dialog-close",a.form.value)("disabled",!a.form.valid),e.xp6(1),e.Q6J("ngIf",!a.data.cttRow),e.xp6(1),e.Q6J("ngIf",a.data.cttRow)}}class S{constructor(t,a,r){this.dialogRef=t,this.data=a,this.fb=r}ngOnInit(){this.form=this.fb.group({id:null,CTTSubjectName:[null,s.kI.required],CTTIsDefaultValue:!1,Parent_CTTKeyField:0,Related_CTTKeyField:null,CTTSubjectEName:null,RowConfirm:0,RowDelete:0,RowStatus:0,EntryUser:null,EditUser:null,EntryUser_Name:null,EditUser_Name:null,CTTArrangeOrder:0,CTTSerial:null,CTTCode:null}),this.data.cttRow?(this.action="Patch",this.form.patchValue(this.data.cttRow)):(this.action="Post",this.form.patchValue({Parent_CTTKeyField:this.data.parentID}))}onSubmit(){console.log(this.form.value),this.form.valid&&this.dialogRef.close(this.form.value)}onSave(){this.form.valid&&this.dialogRef.close({event:this.action,data:this.form.value})}close(){this.action="Cancel",this.dialogRef.close({event:this.action})}canAdd(){return!(!this.data.curUserData.is_superuser&&!this.data.userPerm.includes(this.data.securityAdd))}canChange(){return!(!this.data.curUserData.is_superuser&&!this.data.userPerm.includes(this.data.securityChange))}}S.\u0275fac=function(t){return new(t||S)(e.Y36(f.so),e.Y36(f.WI),e.Y36(s.QS))},S.\u0275cmp=e.Xpm({type:S,selectors:[["app-codetabletree-dialog"]],decls:39,vars:24,consts:[["mat-dialog-title",""],["autocomplete","off",1,"popup-container",3,"formGroup"],["mat-dialog-content",""],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["fxFlex","100","fxFlex.gt-sm","70.0",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","CTTSubjectName","required",""],[4,"ngIf"],["fxFlex","100","fxFlex.gt-sm","29.8",1,"px-1"],["fxFlex","100",1,"py-1"],["formControlName","CTTIsDefaultValue","color","primary"],["fxFlex","100","fxFlex.gt-sm","50.0",1,"px-1"],["formControlName","Parent_CTTKeyField",3,"disabled"],["disabled","",3,"value",4,"ngFor","ngForOf"],["fxFlex","100","fxFlex.gt-sm","49.8",1,"px-1"],["formControlName","Related_CTTKeyField"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],["disabled","",3,"value"],[3,"value"],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click"]],template:function(t,a){1&t&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"form",1)(4,"div",2)(5,"div",3)(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e._UZ(11,"input",6),e.YNc(12,de,2,0,"mat-error",7),e.qZA()(),e.TgZ(13,"div",8)(14,"div",9)(15,"mat-checkbox",10),e._uU(16),e.ALo(17,"translate"),e.qZA()()()(),e.TgZ(18,"div",3)(19,"div",11)(20,"mat-form-field",5)(21,"mat-label"),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"mat-select",12),e.YNc(25,me,3,2,"mat-option",13),e.qZA()()(),e.TgZ(26,"div",14)(27,"mat-form-field",5)(28,"mat-label"),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"mat-select",15),e.YNc(32,he,3,2,"mat-option",16),e.qZA()()()()(),e.TgZ(33,"div",17)(34,"div",3),e.YNc(35,_e,3,4,"button",18),e.TgZ(36,"button",19),e.NdJ("click",function(){return a.close()}),e._uU(37),e.ALo(38,"translate"),e.qZA()()()()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,12,"ADMIN_NAV.SYSTEMCODES")),e.xp6(2),e.Q6J("formGroup",a.form),e.xp6(6),e.Oqu(e.lcZ(10,14,"FIELD.NAME")),e.xp6(3),e.Q6J("ngIf",null==a.form.controls.CTTSubjectName.errors?null:a.form.controls.CTTSubjectName.errors.required),e.xp6(4),e.Oqu(e.lcZ(17,16,"HTML.IsDefaultValue")),e.xp6(6),e.Oqu(e.lcZ(23,18,"HTML.PARENT")),e.xp6(2),e.Q6J("disabled",!0),e.xp6(1),e.Q6J("ngForOf",a.data.parentCTT),e.xp6(4),e.Oqu(e.lcZ(30,20,"HTML.RELATED")),e.xp6(3),e.Q6J("ngForOf",a.data.relatedCTT),e.xp6(3),e.Q6J("ngIf",a.data.cttRow&&a.canChange()||!a.data.cttRow&&a.canAdd()),e.xp6(2),e.Oqu(e.lcZ(38,22,"BTN.CANCEL")))},dependencies:[m.sg,m.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,C.xw,C.Wh,C.yH,R.ey,U.lW,pe.oG,f.ZT,f.uh,f.xY,f.H8,q.Nt,T.KE,T.hX,T.TO,J.gD,x.X$],styles:[".popup-container[_ngcontent-%COMP%]{width:600px;height:350px;max-width:90%;max-height:60%;overflow:auto}"]});var G=i(2887),k=i(6838),K=i(811),W=i(7392),$=i(266),fe=i(1419);function Te(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"mat-button-toggle",20),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.openCategoryDialog(null))}),e.TgZ(1,"mat-icon"),e._uU(2,"add_circle_outline"),e.qZA()()}}function be(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(a);const o=e.oxw().$implicit,d=e.oxw();return e.KtG(d.openCategoryDialog(o))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA()()}2&n&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.VIEW"))}function ye(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(a);const o=e.oxw().$implicit,d=e.oxw();return e.KtG(d.remove(o.id))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()}2&n&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.REMOVE"))}function ve(n,t){if(1&n&&(e.TgZ(0,"div",21)(1,"div",22),e._uU(2),e.qZA(),e.TgZ(3,"div",22)(4,"mat-icon",23),e._uU(5),e.qZA()(),e.TgZ(6,"div",22),e._uU(7),e.qZA(),e.TgZ(8,"div",22)(9,"div",24),e.YNc(10,be,4,3,"button",25),e.YNc(11,ye,4,3,"button",26),e.qZA()()()),2&n){const a=t.$implicit,r=e.oxw();e.xp6(2),e.Oqu(a.CTTSubjectName),e.xp6(3),e.Oqu(a.CTTIsDefaultValue?"check_box":"check_box_outline_blank"),e.xp6(2),e.hij(" ",a.related_Name," "),e.xp6(3),e.Q6J("ngIf",r.userCanView),e.xp6(1),e.Q6J("ngIf",r.userCanDelete)}}function Ae(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",29)(1,"div",30)(2,"mat-card",31)(3,"pagination-controls",32),e.NdJ("pageChange",function(o){e.CHM(a);const d=e.oxw();return e.KtG(d.onPageChanged(o))}),e.qZA()()()()}}const xe=function(n,t){return{itemsPerPage:n,currentPage:t}};class p{constructor(t,a,r,o,d,M,E,Y,H,Q){this.localStore=t,this.global=a,this.router=r,this.activatedRoute=o,this._codesService=d,this.snackBar=M,this.translateService=E,this.fb=Y,this.dialog=H,this.appSettings=Q,this.currentRowCTTArray=[],this.allCTTArray=[],this.parentsCTTArray=[],this.relatedCTTArray=[],this.levelOneCTTArray=[],this.count=10,this.account=new g.n,this.userPerm=[],this.settings=this.appSettings.settings}ngOnDestroy(){this.userSUb&&this.userSUb.unsubscribe()}ngOnInit(){if(this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curCOMId=this.curUserData.COMId,this.appSetup=JSON.parse(this.localStore.getItem("appsetup")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.prepareMsgLanguage()}this.activatedRoute.data.subscribe(t=>{this.securityAdd=t.securityAdd,this.securityChange=t.securityChange,this.securityDelete=t.securityDelete,this.securityView=t.securityView,this.parentCTT=t.parentCTT,this.relatedCTT=t.relatedCTT,this.titleCTT=t.breadcrumb,this.userCanAdd=this.canadd(),this.userCanChange=this.canchange(),this.userCanDelete=this.candelete(),this.userCanView=this.canview(),this.getCodeTableTreePerParent(this.curCOMId,this.account.periorty),this.getAllCodeTableTree(this.curCOMId,this.account.periorty),this.getCodeTableTreeLevelOne(this.curCOMId,this.account.periorty),this.parentCTT&&this.getCodeTableTreePerCode(this.curCOMId,this.account.periorty),this.relatedCTT&&this.getCodeTableTreePerRelated(this.curCOMId,this.account.periorty)})}canadd(){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(this.securityAdd))}canchange(){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(this.securityChange))}candelete(){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(this.securityDelete))}canview(){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(this.securityView))}onPageChanged(t){this.page=t,window.scrollTo(0,0)}openCategoryDialog(t){this.dialog.open(S,{data:{cttRow:t,parentID:this.parentID,parentCTTValue:this.parentCTT,relatedCTTValue:this.relatedCTT,parentCTT:this.levelOneCTTArray,relatedCTT:this.relatedCTTArray,curUserData:this.curUserData,userPerm:this.userPerm,securityChange:this.securityChange,securityAdd:this.securityAdd},panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr"}).afterClosed().subscribe(r=>{"Cancel"==r?.event||("Patch"==r?.event?this._codesService.editCode(r.data,r.data.id).subscribe(o=>{this.snackBar.open("\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0643\u0648\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getCodeTableTreePerParent(this.curCOMId,this.account.periorty)},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0643\u0648\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}):"Post"==r?.event&&this._codesService.addCodeTableTree(r.data).subscribe(o=>{this.snackBar.open("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0643\u0648\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getCodeTableTreePerParent(this.curCOMId,this.account.periorty)},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0643\u0648\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}))})}getAllCodeTableTree(t,a){this._codesService.getAllCodeTableTree(t,a).subscribe(r=>{this.allCTTArray=r},r=>{this.snackBar.open(this.errorRetrieveMsg,"\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getCodeTableTreeLevelOne(t,a){this._codesService.getLevelOne(t,a).subscribe(r=>{this.levelOneCTTArray=r},r=>{this.snackBar.open(this.errorRetrieveMsg,"\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getCodeTableTreePerCode(t,a){this._codesService.getRowPerCode(t,a,this.parentCTT).subscribe(r=>{this.parentID=r[0].id,this.currentRowCTTArray=r},r=>{this.snackBar.open(this.errorRetrieveMsg,"\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getCodeTableTreePerParent(t,a){this.curParentCTT=this.parentCTT??0,this._codesService.getSubForParent(t,a,this.curParentCTT).subscribe(r=>{this.parentsCTTArray=r},r=>{this.snackBar.open(this.errorRetrieveMsg,"\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getCodeTableTreePerRelated(t,a){this._codesService.getSubForParent(t,a,this.relatedCTT).subscribe(r=>{this.relatedCTTArray=r},r=>{this.snackBar.open(this.errorRetrieveMsg,"\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}remove(t){this.dialog.open(G.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(r=>{r&&this._codesService.deleteCode(t).subscribe(()=>{this.snackBar.open(this.deletedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getCodeTableTreePerParent(this.curCOMId,this.account.periorty)})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(t=>{this.errorRetrieveMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(t=>{this.deletedTitleMsg=t})}}p.\u0275fac=function(t){return new(t||p)(e.Y36(c.C),e.Y36(A.U),e.Y36(l.F0),e.Y36(l.gz),e.Y36(k.d),e.Y36(F.ux),e.Y36(x.sK),e.Y36(s.qu),e.Y36(f.uw),e.Y36(B.d))},p.\u0275cmp=e.Xpm({type:p,selectors:[["app-codetabletree-list"]],decls:45,vars:30,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click",4,"ngIf"],["value","search"],[1,"user-search"],[1,"user-search-input"],["matInput","","name","search","autocomplete","off",3,"placeholder","ngModel","ngModelChange"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","list"],["viewType","matButtonToggleGroup"],["value","list"],["value","grid"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["value","add",3,"click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"text-muted"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","warn","class","mx-1",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"matTooltip","click"],["mat-mini-fab","","color","warn",1,"mx-1",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100"],[1,"p-0","text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-button-toggle-group",2,3),e.YNc(4,Te,3,0,"mat-button-toggle",4),e.TgZ(5,"mat-button-toggle",5)(6,"mat-icon"),e._uU(7,"search"),e.qZA()()()(),e.TgZ(8,"form",6)(9,"mat-form-field",7)(10,"input",8),e.NdJ("ngModelChange",function(o){return a.searchText=o}),e.ALo(11,"translate"),e.qZA()()(),e.TgZ(12,"div",9)(13,"mat-button-toggle-group",10,11)(15,"mat-button-toggle",12)(16,"mat-icon"),e._uU(17,"view_list"),e.qZA()(),e.TgZ(18,"mat-button-toggle",13)(19,"mat-icon"),e._uU(20,"view_module"),e.qZA()()()()(),e.TgZ(21,"mat-card")(22,"div",14)(23,"h2"),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.TgZ(26,"div",15)(27,"div",16)(28,"div",17)(29,"h2"),e._uU(30),e.ALo(31,"translate"),e.qZA()(),e.TgZ(32,"div",17)(33,"h2"),e._uU(34),e.ALo(35,"translate"),e.qZA()(),e.TgZ(36,"div",17)(37,"h2"),e._uU(38),e.ALo(39,"translate"),e.qZA()(),e._UZ(40,"div",17),e.qZA(),e.YNc(41,ve,12,5,"div",18),e.ALo(42,"paginate"),e.ALo(43,"CTTSearchPipe"),e.qZA()(),e.YNc(44,Ae,4,0,"div",19)),2&t){const r=e.MAs(3);e.xp6(4),e.Q6J("ngIf",a.userCanAdd),e.xp6(4),e.ekj("show","search"==r.value),e.xp6(2),e.s9C("placeholder",e.lcZ(11,11,"HTML.SEARCH_CTT")),e.Q6J("ngModel",a.searchText),e.xp6(14),e.Oqu(e.lcZ(25,13,a.titleCTT)),e.xp6(6),e.hij(" ",e.lcZ(31,15,"FIELD.NAME")," "),e.xp6(4),e.hij(" ",e.lcZ(35,17,"HTML.DEFAULT")," "),e.xp6(4),e.hij(" ",e.lcZ(39,19,"HTML.RELATED")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(42,21,e.xi3(43,24,a.parentsCTTArray,a.searchText),e.WLB(27,xe,a.count,a.page))),e.xp6(3),e.Q6J("ngIf",a.parentsCTTArray.length>0)}},dependencies:[m.sg,m.O5,s._Y,s.Fj,s.JJ,s.JL,s.On,s.F,C.xw,C.Wh,C.yH,U.nh,K.A9,K.Yi,I.a8,W.Hw,q.Nt,T.KE,$.gM,b.LS,x.X$,fe.AS,b._s],styles:[".user-name[_ngcontent-%COMP%]{padding:0 12px;font-weight:400}.user-content[_ngcontent-%COMP%]{padding:10px}.user-content[_ngcontent-%COMP%]   .user-img[_ngcontent-%COMP%]{position:relative}.user-content[_ngcontent-%COMP%]   .user-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%;width:80px;height:80px}.user-content[_ngcontent-%COMP%]   .user-img[_ngcontent-%COMP%]   img.blocked[_ngcontent-%COMP%]{opacity:.5}.user-content[_ngcontent-%COMP%]   .user-img[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content[_ngcontent-%COMP%]   .mat-mdc-slide-toggle[_ngcontent-%COMP%]{margin-top:15px}.user-content[_ngcontent-%COMP%]   .user-details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content[_ngcontent-%COMP%]   .user-details[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{padding:2px 10px}.user-content[_ngcontent-%COMP%]   .user-details.blocked[_ngcontent-%COMP%]{opacity:.5}.user-search[_ngcontent-%COMP%]{width:0;overflow:hidden;transition:.3s}.user-search[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]{width:100%!important;text-align:center!important}.user-search[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{min-height:36px;padding:8px 0!important}.user-search[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%]{display:none}.user-search[_ngcontent-%COMP%]   .mat-mdc-input-element[_ngcontent-%COMP%]{text-align:center}.user-search.show[_ngcontent-%COMP%]{width:100%;overflow:visible}.user-spinner[_ngcontent-%COMP%]{position:absolute;inset:0}.mat-mdc-card[_ngcontent-%COMP%]{overflow:hidden}"]});var Me=i(529);class P{constructor(t,a,r){this.http=t,this.globalServ=a,this.appSettings=r,this.defaultCusImage=this.noImageUrl,this.CusImageToUpload=null,this.baseUrl=this.appSettings.settings.url,this.secondPartUrl=new _.P(this.baseUrl).api_constant,this.noImageUrl=new _.P(this.baseUrl).noImage}onTextChanged(t){this.tipText=t.target.value}onImageChanged(t){this.tipPIC=t.target.files[0],this.tipPicName=this.tipPIC.name}handelCUSImgInput(t){this.CusImageToUpload=t.item(0);var a=new FileReader;a.onload=r=>{this.defaultCusImage=r.target.result},a.readAsDataURL(this.CusImageToUpload)}newTip(){const t=new FormData;t.append("TIPText",this.tipText),t.append("TIPPIC",this.CusImageToUpload),this.http.post(this.baseUrl+this.secondPartUrl+"atlas/tips/",t,this.globalServ.getAuthHeaders_for_files()).subscribe(a=>console.log(a),a=>console.log(a))}}function Oe(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Arabic Name is required"),e.qZA())}function Ze(n,t){if(1&n&&(e.TgZ(0,"mat-option",10)(1,"span"),e._uU(2),e.qZA()()),2&n){const a=t.$implicit;e.Q6J("value",a.id),e.xp6(2),e.Oqu(a.CTTSubjectName)}}function Ue(n,t){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.SAVE")))}function Ie(n,t){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function we(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.onSave())}),e.YNc(1,Ue,3,3,"span",7),e.YNc(2,Ie,3,3,"span",7),e.qZA()}if(2&n){const a=e.oxw();e.Q6J("mat-dialog-close",a.form.value)("disabled",!a.form.valid),e.xp6(1),e.Q6J("ngIf",!a.data.branchRow),e.xp6(1),e.Q6J("ngIf",a.data.branchRow)}}P.\u0275fac=function(t){return new(t||P)(e.Y36(Me.eN),e.Y36(A.U),e.Y36(B.d))},P.\u0275cmp=e.Xpm({type:P,selectors:[["app-tips-list"]],decls:25,vars:1,consts:[["type","text",3,"change"],["type","file",3,"change"],[3,"click"],[2,"width","150px","height","200px",3,"src"],["for","upload",1,"d-block","text-center"],["name","TIPPIC","id","upload","type","file","accept","image/*",3,"change"]],template:function(t,a){1&t&&(e.TgZ(0,"h1"),e._uU(1,"Upload Image From Angular"),e.qZA(),e.TgZ(2,"label"),e._uU(3," Title: "),e.TgZ(4,"input",0),e.NdJ("change",function(o){return a.onTextChanged(o)}),e.qZA()(),e._UZ(5,"br"),e.TgZ(6,"label"),e._uU(7," Image: "),e.TgZ(8,"input",1),e.NdJ("change",function(o){return a.onImageChanged(o.target.files)}),e.qZA()(),e._UZ(9,"br"),e.TgZ(10,"button",2),e.NdJ("click",function(){return a.newTip()}),e._uU(11,"New Tips"),e.qZA(),e._UZ(12,"br")(13,"br")(14,"br")(15,"br"),e.TgZ(16,"h1"),e._uU(17,"Upload Image From Angular"),e.qZA(),e._UZ(18,"br")(19,"br"),e.TgZ(20,"div"),e._UZ(21,"img",3),e.TgZ(22,"label",4),e._uU(23,"\u0635\u0648\u0631\u0647 \u0627\u0644\u0639\u0645\u064a\u0644"),e.qZA(),e.TgZ(24,"input",5),e.NdJ("change",function(o){return a.handelCUSImgInput(o.target.files)}),e.qZA()()),2&t&&(e.xp6(21),e.Q6J("src",a.defaultCusImage,e.LSH))}});class L{constructor(t,a,r,o,d){this.dialogRef=t,this.codesService=a,this.snackBar=r,this.data=o,this.fb=d,this.account=new g.n,this.currency_const=(new u.I).Currency,this.currenciesArray=[]}ngOnInit(){this.form=this.fb.group({id:null,BRAArbName:[null,s.kI.required],BRAAddress:null,Currency_CTTKeyField:[null,s.kI.required],RowConfirm:0,RowDelete:0,RowStatus:0,BRACode:null}),this.curCOMId=this.data.curUserData.COMId,this.getCurrencies(this.curCOMId,this.data.periorty),this.data.branchRow?(this.action="Patch",this.form.patchValue(this.data.branchRow)):this.action="Post"}getCurrencies(t,a){this.codesService.getSubForParent(t,a,this.currency_const).subscribe(r=>{this.currenciesArray=r},r=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0639\u0645\u0644\u0627\u062a","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}onSave(){this.form.valid&&this.dialogRef.close({event:this.action,data:this.form.value})}close(){this.action="Cancel",this.dialogRef.close({event:this.action})}can(t){return!(!this.data.curUserData.is_superuser&&!this.data.userPerm.includes(t))}}L.\u0275fac=function(t){return new(t||L)(e.Y36(f.so),e.Y36(k.d),e.Y36(F.ux),e.Y36(f.WI),e.Y36(s.QS))},L.\u0275cmp=e.Xpm({type:L,selectors:[["app-branch-dialog"]],decls:36,vars:19,consts:[["mat-dialog-title",""],["autocomplete","off",3,"formGroup"],["mat-dialog-content",""],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-sm","49.8",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","BRAArbName","required",""],[4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["formControlName","Currency_CTTKeyField"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","BRAAddress","required",""],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click"]],template:function(t,a){1&t&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"form",1)(4,"div",2)(5,"div",3)(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e._UZ(11,"input",6),e.YNc(12,Oe,2,0,"mat-error",7),e.qZA()(),e.TgZ(13,"div",8)(14,"div",4)(15,"mat-form-field",5)(16,"mat-label"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"mat-select",9)(20,"mat-option",10),e._uU(21,"-"),e.qZA(),e.YNc(22,Ze,3,2,"mat-option",11),e.qZA()()()(),e.TgZ(23,"div",8)(24,"div",12)(25,"mat-form-field",5)(26,"mat-label"),e._uU(27),e.ALo(28,"translate"),e.qZA(),e._UZ(29,"input",13),e.qZA()()()()(),e.TgZ(30,"div",14)(31,"div",8),e.YNc(32,we,3,4,"button",15),e.TgZ(33,"button",16),e.NdJ("click",function(){return a.close()}),e._uU(34),e.ALo(35,"translate"),e.qZA()()()()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,9,"ADMIN_NAV.BRANCH")),e.xp6(2),e.Q6J("formGroup",a.form),e.xp6(6),e.Oqu(e.lcZ(10,11,"FIELD.NAME")),e.xp6(3),e.Q6J("ngIf",null==a.form.controls.BRAArbName.errors?null:a.form.controls.BRAArbName.errors.required),e.xp6(5),e.Oqu(e.lcZ(18,13,"HTML.Currency")),e.xp6(5),e.Q6J("ngForOf",a.currenciesArray),e.xp6(5),e.Oqu(e.lcZ(28,15,"HTML.ADDRESS")),e.xp6(5),e.Q6J("ngIf",a.data.branchRow&&a.can("change_branch")||!a.data.branchRow&&a.can("add_branch")),e.xp6(2),e.Oqu(e.lcZ(35,17,"BTN.CANCEL")))},dependencies:[m.sg,m.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,C.xw,C.Wh,C.yH,R.ey,U.lW,f.ZT,f.uh,f.xY,f.H8,q.Nt,T.KE,T.hX,T.TO,J.gD,x.X$]});var De=i(6002),Se=i(4850);function Pe(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.openCategoryDialog(null))}),e.TgZ(1,"h2"),e._uU(2,"+"),e.qZA()()}}function Le(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(a);const o=e.oxw().$implicit,d=e.oxw();return e.KtG(d.openCategoryDialog(o))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"visibility"),e.qZA()()}2&n&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.VIEW"))}function Ne(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(a);const o=e.oxw().$implicit,d=e.oxw();return e.KtG(d.remove(o.id))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()}2&n&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.REMOVE"))}function Ee(n,t){if(1&n&&(e.TgZ(0,"div",9)(1,"div",10),e._uU(2),e.qZA(),e.TgZ(3,"div",10),e._uU(4),e.qZA(),e.TgZ(5,"div",10),e._uU(6),e.qZA(),e.TgZ(7,"div",10)(8,"div",11),e.YNc(9,Le,4,3,"button",12),e.YNc(10,Ne,4,3,"button",13),e.qZA()()()),2&n){const a=t.$implicit,r=e.oxw();e.xp6(2),e.Oqu(a.BRAArbName),e.xp6(2),e.Oqu(a.currencyName),e.xp6(2),e.Oqu(a.BRAAddress),e.xp6(3),e.Q6J("ngIf",r.can("view_branch")),e.xp6(1),e.Q6J("ngIf",r.can("delete_branch"))}}function Fe(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",16)(1,"div",17)(2,"mat-card",18)(3,"pagination-controls",19),e.NdJ("pageChange",function(o){e.CHM(a);const d=e.oxw();return e.KtG(d.onPageChanged(o))}),e.qZA()()()()}}const Be=function(n,t){return{itemsPerPage:n,currentPage:t}};class N{constructor(t,a,r,o,d,M,E,Y,H,Q){this.localStore=t,this.global=a,this.router=r,this._codesService=o,this.snackBar=d,this.translateService=M,this.fb=E,this.dialog=Y,this.atlasService=H,this.appSettings=Q,this.count=6,this.account=new g.n,this.userPerm=[],this.AllBranches=[],this.settings=this.appSettings.settings}ngOnDestroy(){this.userSUb&&this.userSUb.unsubscribe()}ngOnInit(){if(this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curCOMId=this.curUserData.COMId,this.appSetup=JSON.parse(this.localStore.getItem("appsetup")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.prepareMsgLanguage(),this.curUserData.is_superuser?this.getAllBranches(this.curCOMId,this.account.periorty):"T"==this.curUserData.is_employee&&this.getEmpBranches(this.curCOMId,this.account.periorty,this.curUserData.id,this.curUserData.branch_KeyField??0)}}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getAllBranches(t,a){this.atlasService.getAllBranch(t,a).subscribe(r=>{this.AllBranches=r},r=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0641\u0631\u0648\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getEmpBranches(t,a,r,o){console.log("----is Emp"),this.atlasService.getBranchPerEmp(t,a,r).subscribe(d=>{this.AllBranches=d,console.log("8888 getBranchPerEmp:: "+this.AllBranches),this.AllBranches.length>0||(console.log("----Length <= 0"),console.log("curBra:: "+o),this.atlasService.getOneBranch(o).subscribe(M=>{this.AllBranches=M,console.log("7777getOneBranch:: "+this.AllBranches)},M=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0641\u0631\u0639 \u0627\u0644\u0645\u0648\u0638\u0641","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}))},d=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0641\u0631\u0648\u0639 \u0644\u0644\u0645\u0648\u0638\u0641","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}onPageChanged(t){this.page=t,window.scrollTo(0,0)}openCategoryDialog(t){console.log("-----Data:: "+t),this.dialog.open(L,{data:{branchRow:t,periorty:this.account.periorty,curUserData:this.curUserData,userPerm:this.userPerm},panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr"}).afterClosed().subscribe(r=>{"Cancel"==r.event||("Patch"==r.event?this.atlasService.editBranch(r.data,r.data.id).subscribe(o=>{this.snackBar.open("\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0641\u0631\u0639","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getAllBranches(this.curCOMId,this.account.periorty)},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0641\u0631\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}):"Post"==r.event&&this.atlasService.addBranch(r.data).subscribe(o=>{this.snackBar.open("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0641\u0631\u0639","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getAllBranches(this.curCOMId,this.account.periorty)},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0641\u0631\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}))})}remove(t){this.dialog.open(G.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(r=>{r&&this.atlasService.softDeleteBranch(t).subscribe(()=>{this.snackBar.open(this.deletedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getAllBranches(this.curCOMId,this.account.periorty)})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(t=>{this.errorRetrieveMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(t=>{this.deletedTitleMsg=t})}}N.\u0275fac=function(t){return new(t||N)(e.Y36(c.C),e.Y36(A.U),e.Y36(l.F0),e.Y36(k.d),e.Y36(F.ux),e.Y36(x.sK),e.Y36(s.qu),e.Y36(f.uw),e.Y36(De.Z),e.Y36(B.d))},N.\u0275cmp=e.Xpm({type:N,selectors:[["app-branch-list"]],decls:26,vars:21,consts:[[1,"p-2"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","warn","class","mx-1",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"matTooltip","click"],["mat-mini-fab","","color","warn",1,"mx-1",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100"],[1,"p-0","text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"mat-card")(2,"div",1)(3,"h2"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.YNc(6,Pe,3,0,"button",2),e.qZA(),e._UZ(7,"mat-divider"),e.TgZ(8,"div",3)(9,"div",4)(10,"div",5)(11,"h2"),e._uU(12),e.ALo(13,"translate"),e.qZA()(),e.TgZ(14,"div",5)(15,"h2"),e._uU(16),e.ALo(17,"translate"),e.qZA()(),e.TgZ(18,"div",5)(19,"h2"),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e._UZ(22,"div",5),e.qZA(),e.YNc(23,Ee,11,5,"div",6),e.ALo(24,"paginate"),e.qZA()(),e.YNc(25,Fe,4,0,"div",7),e.qZA()),2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,7,"ADMIN_NAV.BRANCH")),e.xp6(2),e.Q6J("ngIf",a.can("add_branch")),e.xp6(6),e.hij(" ",e.lcZ(13,9,"FIELD.NAME")," "),e.xp6(4),e.hij(" ",e.lcZ(17,11,"HTML.Currency")," "),e.xp6(4),e.hij(" ",e.lcZ(21,13,"HTML.ADDRESS")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(24,15,a.AllBranches,e.WLB(18,Be,a.count,a.page))),e.xp6(2),e.Q6J("ngIf",a.AllBranches.length>0))},dependencies:[m.sg,m.O5,C.xw,C.Wh,C.yH,U.lW,U.nh,I.a8,W.Hw,Se.d,$.gM,b.LS,x.X$,b._s]});const X=[{path:"company",component:D,data:{breadcrumb:"Company"}},{path:"branch",component:N,data:{breadcrumb:"Branch"}},{path:"codetree/country",component:p,data:{breadcrumb:"Countries",parentCTT:String((new u.I).Countries),relatedCTT:null,securityAdd:"add_country",securityChange:"change_country",securityDelete:"delete_country",securityView:"view_country"}},{path:"codetree/govern",component:p,data:{breadcrumb:"Governorates",parentCTT:String((new u.I).Governorates),relatedCTT:String((new u.I).Countries),securityAdd:"add_governorate",securityChange:"change_governorate",securityDelete:"delete_governorate",securityView:"view_governorate"}},{path:"codetree/city",component:p,data:{breadcrumb:"Cities",parentCTT:String((new u.I).City),relatedCTT:String((new u.I).Governorates),securityAdd:"add_city",securityChange:"change_city",securityDelete:"delete_city",securityView:"view_city"}},{path:"codetree/region",component:p,data:{breadcrumb:"Regions",parentCTT:String((new u.I).Regions),relatedCTT:String((new u.I).City),securityAdd:"add_region",securityChange:"change_region",securityDelete:"delete_region",securityView:"view_region"}},{path:"codetree/doctype",component:p,data:{breadcrumb:"DOCTypes",parentCTT:String((new u.I).InvoiceTypes),securityAdd:"add_doctypes",securityChange:"change_doctypes",securityDelete:"delete_doctypes",securityView:"view_doctypes"}},{path:"codetree/features",component:p,data:{breadcrumb:"PropertyFeatures",parentCTT:String((new u.I).BuildingFeatures),securityAdd:"add_buildingfeature",securityChange:"change_buildingfeature",securityDelete:"delete_buildingfeature",securityView:"view_buildingfeature"}},{path:"codetree/ownershipdoc",component:p,data:{breadcrumb:"OwnershipDocTypes",parentCTT:String((new u.I).OwnershipDocTypes),securityAdd:"add_ownershipdoc",securityChange:"change_ownershipdoc",securityDelete:"delete_ownershipdoc",securityView:"view_ownershipdoc"}},{path:"codetree/currency",component:p,data:{breadcrumb:"Currency",parentCTT:String((new u.I).Currency),securityAdd:"add_currency",securityChange:"change_currency",securityDelete:"delete_currency",securityView:"view_currency"}},{path:"codetree/expenses",component:p,data:{breadcrumb:"Expenses",parentCTT:String((new u.I).Expenses),securityAdd:"add_expenses",securityChange:"change_expenses",securityDelete:"delete_expenses",securityView:"view_expenses"}},{path:"codetree/notification",component:p,data:{breadcrumb:"Notification",parentCTT:String((new u.I).NotificationTypes),securityAdd:"add_notification",securityChange:"change_notification",securityDelete:"delete_notification",securityView:"view_notification"}},{path:"codetree/jobs",component:p,data:{breadcrumb:"Jobs",parentCTT:String((new u.I).Jobs),securityAdd:"add_jobs",securityChange:"change_jobs",securityDelete:"delete_jobs",securityView:"view_jobs"}},{path:"codetree/workplaces",component:p,data:{breadcrumb:"WorkPlaces",parentCTT:String((new u.I).WorkPlaces),securityAdd:"add_workplaces",securityChange:"change_workplaces",securityDelete:"delete_workplaces",securityView:"view_workplaces"}},{path:"codetree/workfileds",component:p,data:{breadcrumb:"WorkFields",parentCTT:String((new u.I).WorkType),securityAdd:"add_workfields",securityChange:"change_workfields",securityDelete:"delete_workfields",securityView:"view_workfields"}},{path:"codetree/banks",component:p,data:{breadcrumb:"Banks",parentCTT:String((new u.I).Banks),securityAdd:"add_banks",securityChange:"change_banks",securityDelete:"delete_banks",securityView:"view_banks"}},{path:"codetree/smstypes",component:p,data:{breadcrumb:"SMSTypes",parentCTT:String((new u.I).SMSTypes),relatedCTT:null,securityAdd:"add_smstypes",securityChange:"change_smstypes",securityDelete:"delete_smstypes",securityView:"view_smstypes"}},{path:"codetree/maintenancerequesttypes",component:p,data:{breadcrumb:"MaintenanceRequestTypes",parentCTT:String((new u.I).MaintenanceRequestTypes),relatedCTT:null,securityAdd:"add_maintenancerequesttypes",securityChange:"change_maintenancerequesttypes",securityDelete:"delete_maintenancerequesttypes",securityView:"view_maintenancerequesttypes"}},{path:"codetree/maintenanceelements",component:p,data:{breadcrumb:"MaintenanceElements",parentCTT:String((new u.I).MaintenanceElements),relatedCTT:null,securityAdd:"add_maintenanceelements",securityChange:"change_maintenanceelements",securityDelete:"delete_maintenanceelements",securityView:"view_maintenanceelements"}},{path:"codetree/maintenanceordersteps",component:p,data:{breadcrumb:"MaintenanceOrderSteps",parentCTT:String((new u.I).MaintenanceOrderSteps),relatedCTT:null,securityAdd:"add_maintenanceordersteps",securityChange:"change_maintenanceordersteps",securityDelete:"delete_maintenanceordersteps",securityView:"view_maintenanceordersteps"}},{path:"codetree/maintenancejobsclassification",component:p,data:{breadcrumb:"MaintenanceJobsClassification",parentCTT:String((new u.I).MaintenanceJobsClassification),relatedCTT:null,securityAdd:"add_maintenancejobsclassification",securityChange:"change_maintenancejobsclassification",securityDelete:"delete_maintenancejobsclassification",securityView:"view_maintenancejobsclassification"}},{path:"tips",component:P,data:{breadcrumb:"Tips"}}];class w{constructor(t){this.translateService=t}ngOnInit(){this.prepareMsgLanguage()}prepareMsgLanguage(){this.translateService.get("TS.COMPANYDATA").subscribe(t=>{this.companyDataMsg=t})}}w.\u0275fac=function(t){return new(t||w)(e.LFG(x.sK))},w.\u0275mod=e.oAB({type:w}),w.\u0275inj=e.cJS({imports:[m.ez,l.Bz.forChild(X),s.u5,s.UX,v.m,b.JX,y.kz,Z.Y$]})},6002:(V,O,i)=>{i.d(O,{Z:()=>g});var m=i(5521),l=i(262),s=i(2843),v=i(4650),b=i(1182),y=i(529),Z=i(7465);class g{constructor(e,c,h){this.appSettings=e,this.http=c,this.globalServ=h,this.baseUrl=this.appSettings.settings.url,this.secondPartUrl=new m.P(this.baseUrl).api_constant}getSubscriptionStatus(e){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/subscription/"+e+"/").pipe((0,l.K)(this.handleSubscribeError))}handleSubscribeError(e){return console.error("Error fetching subscription status:",e),(0,s._)(()=>new Error("Failed to load subscription status"))}getAllBranch(e,c){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/allBranches/?M="+e+"&C="+c,this.globalServ.getAuthHeaders())}getOneBranch(e){return console.log(this.baseUrl+this.secondPartUrl+"atlas/branch/"+e+"/"),this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/"+e+"/",this.globalServ.getAuthHeaders())}getMainBranch(e,c){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/branchPerSpec/?M="+e+"&C="+c+"&Main=T",this.globalServ.getAuthHeaders())}getBranchPerEmp(e,c,h){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/branchPerSpec/?M="+e+"&C="+c+"&emp="+h,this.globalServ.getAuthHeaders())}getBranchPerOwner(e,c,h){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/branchPerSpec/?M="+e+"&C="+c+"&owner="+h,this.globalServ.getAuthHeaders())}sendTaqnyatSMS(e,c,h,A){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/sendSMS/?M="+e+"&C="+c+"&recipients="+h+"&msg="+A,this.globalServ.getAuthHeaders())}sendWhatsApp_Cartat(e,c,h,A){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/sendWhatsApp/?M="+e+"&C="+c+"&mobile="+h+"&msg="+A,this.globalServ.getAuthHeaders())}sendSms(e,c,h){return this.http.post(e,c,this.globalServ.smsHeaders(h))}sendSmsData(e,c){const h=new FormData;return h.append("bearerTokens",c),h.append("sender","Jeddah Lake"),h.append("recipients","966503002323"),h.append("body","125478"),this.http.post(e,h,this.globalServ.smsHeaders(c))}sendSmsGet(e){return this.http.get(e)}sendSmsGetToken(e,c){return this.http.get(e,this.globalServ.smsHeaders(c))}addBranch(e){return this.http.post(this.baseUrl+this.secondPartUrl+"atlas/branch/",e,this.globalServ.getAuthHeaders())}editBranch(e,c){return this.http.put(this.baseUrl+this.secondPartUrl+"atlas/branch/"+c+"/",e,this.globalServ.getAuthHeaders())}deleteBranch(e){return this.http.delete(this.baseUrl+this.secondPartUrl+"atlas/branch/"+e+"/",this.globalServ.getAuthHeaders())}softDeleteBranch(e){return this.http.put(this.baseUrl+this.secondPartUrl+"atlas/branch/"+e+"/",{RowDelete:1},this.globalServ.getAuthHeaders())}}g.\u0275fac=function(e){return new(e||g)(v.LFG(b.d),v.LFG(y.eN),v.LFG(Z.U))},g.\u0275prov=v.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"})},2887:(V,O,i)=>{i.d(O,{$:()=>y});var m=i(5412),l=i(4650),s=i(1576),v=i(4859),b=i(3081);class y{constructor(g,_){this.dialogRef=g,this.data=_}ngOnInit(){}onConfirm(){this.dialogRef.close(!0)}onDismiss(){this.dialogRef.close(!1)}}y.\u0275fac=function(g){return new(g||y)(l.Y36(m.so),l.Y36(m.WI))},y.\u0275cmp=l.Xpm({type:y,selectors:[["app-confirm-dialog"]],decls:13,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(g,_){1&g&&(l.TgZ(0,"h1",0),l._uU(1),l.qZA(),l.TgZ(2,"div",1)(3,"p"),l._uU(4),l.qZA()(),l.TgZ(5,"div",2)(6,"div",3)(7,"button",4),l.NdJ("click",function(){return _.onDismiss()}),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.TgZ(10,"button",5),l.NdJ("click",function(){return _.onConfirm()}),l._uU(11),l.ALo(12,"translate"),l.qZA()()()),2&g&&(l.xp6(1),l.Oqu(null==_.data?null:_.data.title),l.xp6(3),l.Oqu(null==_.data?null:_.data.message),l.xp6(4),l.Oqu(l.lcZ(9,4,"BTN.NO")),l.xp6(3),l.Oqu(l.lcZ(12,6,"BTN.YES")))},dependencies:[s.xw,s.Wh,v.lW,m.uh,m.xY,m.H8,b.X$]})}}]);