"use strict";(self.webpackChunkemporium=self.webpackChunkemporium||[]).push([[592],{5346:(b,h,n)=>{n.d(h,{n:()=>e});var i=n(7579),m=n(4650);class e{constructor(){this.totalInfo=new i.x}setInfo(g){this.totalInfo.next(g)}}e.\u0275fac=function(g){return new(g||e)},e.\u0275prov=m.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})},3221:(b,h,n)=>{n.d(h,{y:()=>O});var i=n(2340),m=n(5783),e=n(4650),d=n(4006),g=n(9132),f=n(7009),u=n(3071),l=n(5298),a=n(7465),c=n(3081),s=n(5412),t=n(4165),M=n(1182),E=n(6895),x=n(4333),v=n(1576),D=n(4859),T=n(3546),U=n(7392),A=n(266);function y(_,r){if(1&_){const o=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){e.CHM(o);const P=e.oxw(2);return e.KtG(P.onClickUsed())}),e.TgZ(1,"mat-icon"),e._uU(2,"vpn_key"),e.qZA()()}}function S(_,r){if(1&_){const o=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(o);const P=e.oxw().$implicit,C=e.oxw();return e.KtG(C.onClickSendItToUser(C.AllPermissionsDisplayed,P.codename))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"lock"),e.qZA()()}2&_&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.Transfer"))}function w(_,r){if(1&_&&(e.TgZ(0,"div",10)(1,"div",11),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",12),e._uU(5),e.qZA(),e.TgZ(6,"div",11)(7,"div",13),e.YNc(8,y,3,0,"button",14),e.YNc(9,S,4,3,"button",15),e.qZA()()()),2&_){const o=r.$implicit,p=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,4,"SECURITY."+o.codename)),e.xp6(3),e.Oqu(o.codename),e.xp6(3),e.Q6J("ngIf",p.can("add_emp_security_onepermission")&&p.userPerm.indexOf(o.codename)>-1),e.xp6(1),e.Q6J("ngIf",p.can("add_emp_security_onepermission")&&-1==p.userPerm.indexOf(o.codename))}}function I(_,r){if(1&_){const o=e.EpF();e.TgZ(0,"div")(1,"div",18)(2,"mat-card",19)(3,"pagination-controls",20),e.NdJ("pageChange",function(P){e.CHM(o);const C=e.oxw();return e.KtG(C.onPageChanged(P))}),e.qZA()()()()}}function R(_,r){if(1&_){const o=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(o);const P=e.oxw().$implicit,C=e.oxw();return e.KtG(C.onClickDeletePerm(P.codename))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()}2&_&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.REMOVE"))}function N(_,r){if(1&_&&(e.TgZ(0,"div",10)(1,"div",21),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",11)(5,"div",13),e.YNc(6,R,4,3,"button",15),e.qZA()()()),2&_){const o=r.$implicit,p=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,2,"SECURITY."+o.codename)," "),e.xp6(4),e.Q6J("ngIf",p.can("delete_emp_security_onepermission"))}}function Z(_,r){if(1&_){const o=e.EpF();e.TgZ(0,"div")(1,"div",18)(2,"mat-card",19)(3,"pagination-controls",22),e.NdJ("pageChange",function(P){e.CHM(o);const C=e.oxw();return e.KtG(C.onUserPageChanged(P))}),e.qZA()()()()}}class O{constructor(r,o,p,P,C,L,B,F,K,k,Y,W){this.formBuilder=r,this.router=o,this.snackBar=p,this.userService=P,this.activatedRoute=C,this.localStore=L,this.global=B,this.translateService=F,this.fb=K,this.dialog=k,this.settingService=Y,this.appSettings=W,this.countAll=6,this.countPerUser=6,this.curCOMId=i.N.comid,this.account=new m.n,this.tempuserPerm=[],this.AllPermissions=[],this.AllPermissionsDisplayed=[],this.tempDisplayed=[],this.UserPermissions=[],this.userPerm=[],this.settings=this.appSettings.settings}ngOnInit(){if(this.userSUb=this.global.user.subscribe(r=>{this.account=r}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let r=0;r<this.curUserPermissions.length;r++)this.tempuserPerm[r]=this.curUserPermissions[r].codename;this.getAllPermissions()}this.sub=this.activatedRoute.params.subscribe(r=>{r.id&&(this.id=+r.id,console.log("params['id']:: "+this.id),this.getUserPermissions(+this.id))})}can(r){return!(!this.curUserData.is_superuser&&!this.tempuserPerm.includes(r))}refreshDisplayed(r){this.AllPermissionsDisplayed=r,this.config={id:"basicPaginate",itemsPerPage:this.countAll,currentPage:1,totalItems:this.AllPermissionsDisplayed.length}}getAllPermissions(){this.userService.getAllPermission().subscribe(r=>{this.AllPermissions=r,this.refreshDisplayed(this.AllPermissions),this.tempDisplayed=r,this.config={id:"basicPaginate",itemsPerPage:this.countAll,currentPage:1,totalItems:this.AllPermissions.length}},r=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getUserPermissions(r){this.userService.getUserPermission(r).subscribe(o=>{this.UserPermissions=o.user_permissions,this.userConfig={id:"userPaginate",itemsPerPage:this.countPerUser,currentPage:1,totalItems:this.UserPermissions.length},this.userPermInArray()},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}userPermInArray(){for(let r=0;r<this.UserPermissions.length;r++)this.userPerm[r]=this.UserPermissions[r].codename,console.log("this.userPerm[i]:: "+this.userPerm[r])}manageAllPermissionsDisplayed(){console.log("this.userPerm:: "+this.userPerm),this.tempDisplayed.forEach((r,o)=>{this.userPerm.includes(this.tempDisplayed[o].codename)&&(console.log("**included:: "+this.tempDisplayed[o].codename),delete this.tempDisplayed[o])}),this.refreshDisplayed(this.tempDisplayed)}onClickSendItToUser(r,o){console.log("----// Add it to Table  ----//"),this.userService.addUserPerm(this.id,o).subscribe(p=>{this.refreshDisplayed(r),this.getUserPermissions(this.id)})}onClickDeletePerm(r){console.log("----// Remove Perm from Table  ----//"),this.userService.removeUserPerm(this.id,r).subscribe(o=>{this.getUserPermissions(this.id)})}onClickUsed(){console.log("--** it is used so, will not do anything **--")}onPageChanged(r){this.config.currentPage=r}onUserPageChanged(r){this.userConfig.currentPage=r}onLoginFormSubmit(r){}onRegisterFormSubmit(r){}}O.\u0275fac=function(r){return new(r||O)(e.Y36(d.QS),e.Y36(g.F0),e.Y36(f.ux),e.Y36(u.K),e.Y36(g.gz),e.Y36(l.C),e.Y36(a.U),e.Y36(c.sK),e.Y36(d.qu),e.Y36(s.uw),e.Y36(t.g),e.Y36(M.d))},O.\u0275cmp=e.Xpm({type:O,selectors:[["app-emp-security-dialog"]],decls:29,vars:19,consts:[[1,"p-4"],["fxLayout","row"],["fxFlex","100","fxFlex.gt-sm","50",1,"p-3"],[1,"mat-mdc-table","permission-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],[4,"ngIf"],["fxFlex","100","fxFlex.gt-sm","10",1,"p-3"],["fxFlex","100","fxFlex.gt-sm","35",1,"p-3"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"mat-mdc-cell","primary-text","notifbold"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"click",4,"ngIf"],["mat-mini-fab","","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"click"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["fxFlex","100"],[1,"p-0","text-center"],["id","basicPaginate","autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],[1,"mat-mdc-cell","selectedbold"],["id","userPaginate","autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"]],template:function(r,o){1&r&&(e.TgZ(0,"mat-card",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h2"),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"div",5)(10,"h2"),e._uU(11),e.ALo(12,"translate"),e.qZA()(),e._UZ(13,"div",5),e.qZA(),e.YNc(14,w,10,6,"div",6),e.ALo(15,"paginate"),e.qZA(),e.YNc(16,I,4,0,"div",7),e.qZA(),e._UZ(17,"div",8),e.TgZ(18,"div",9)(19,"div",3)(20,"div",4)(21,"div",5)(22,"h2"),e._uU(23),e.ALo(24,"translate"),e.qZA()(),e._UZ(25,"div",5),e.qZA(),e.YNc(26,N,7,4,"div",6),e.ALo(27,"paginate"),e.qZA(),e.YNc(28,Z,4,0,"div",7),e.qZA()()()),2&r&&(e.xp6(7),e.hij(" ",e.lcZ(8,7,"HTML.Description")," "),e.xp6(4),e.hij(" ",e.lcZ(12,9,"HTML.CODE")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(15,11,o.AllPermissionsDisplayed,o.config)),e.xp6(2),e.Q6J("ngIf",o.AllPermissionsDisplayed.length>0),e.xp6(7),e.hij(" ",e.lcZ(24,14,"HTML.CODE")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(27,16,o.UserPermissions,o.userConfig)),e.xp6(2),e.Q6J("ngIf",o.UserPermissions.length>0))},dependencies:[E.sg,E.O5,x.LS,v.xw,v.yH,D.nh,T.a8,U.Hw,A.gM,x._s,c.X$],styles:[".auth[_ngcontent-%COMP%]{white-space:nowrap;padding:7px 14px;font-weight:500}.notifbold[_ngcontent-%COMP%]{font-weight:700}.selectedbold[_ngcontent-%COMP%]{font-weight:700;color:green}.permission-table.mat-mdc-table[_ngcontent-%COMP%]{display:block;overflow-x:auto}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-row[_ngcontent-%COMP%]{display:flex;border-bottom-width:1px;border-bottom-style:solid;align-items:center;min-height:48px;padding:0 16px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{flex:1;overflow:hidden;word-wrap:break-word;padding:0 8px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell.image[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell.image[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;flex-basis:60px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;border-radius:50%;margin:4px 0}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell.status[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell.status[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;flex-basis:32px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell.ratings[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell.ratings[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;flex-basis:80px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{font-size:14px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{text-align:right}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 4px}.permission-table.mat-mdc-table.header-sm[_ngcontent-%COMP%]   .mat-mdc-header-row[_ngcontent-%COMP%]{min-height:36px}.permission-table.mat-mdc-table.truncated[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%], .permission-table.mat-mdc-table.truncated[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis}"]})},7288:(b,h,n)=>{n.d(h,{j:()=>i});class i{}},9515:(b,h,n)=>{n.d(h,{A:()=>u});var i=n(4650),m=n(6895),e=n(1576),d=n(7392);function g(l,a){if(1&l){const c=i.EpF();i.TgZ(0,"mat-icon",4),i.NdJ("click",function(){const M=i.CHM(c).index,E=i.oxw();return i.KtG(E.rate(M))}),i._uU(1),i.qZA()}if(2&l){const c=a.$implicit;i.xp6(1),i.Oqu(c)}}function f(l,a){if(1&l&&(i.TgZ(0,"p",5),i._uU(1),i.qZA()),2&l){const c=i.oxw();i.xp6(1),i.hij("",c.ratingsCount," ratings")}}class u{constructor(){this.showText=!0}ngDoCheck(){this.ratingsCount&&this.ratingsValue&&!this.avg&&this.calculateAvgValue()}rate(a){}calculateAvgValue(){switch(this.avg=this.ratingsValue/this.ratingsCount,!0){case this.avg>0&&this.avg<20:this.stars=["star_half","star_border","star_border","star_border","star_border"];break;case 20==this.avg:this.stars=["star","star_border","star_border","star_border","star_border"];break;case this.avg>20&&this.avg<40:this.stars=["star","star_half","star_border","star_border","star_border"];break;case 40==this.avg:this.stars=["star","star","star_border","star_border","star_border"];break;case this.avg>40&&this.avg<60:this.stars=["star","star","star_half","star_border","star_border"];break;case 60==this.avg:this.stars=["star","star","star","star_border","star_border"];break;case this.avg>60&&this.avg<80:this.stars=["star","star","star","star_half","star_border"];break;case 80==this.avg:this.stars=["star","star","star","star","star_border"];break;case this.avg>80&&this.avg<100:this.stars=["star","star","star","star","star_half"];break;case this.avg>=100:this.stars=["star","star","star","star","star"];break;default:this.stars=["star_border","star_border","star_border","star_border","star_border"]}}}u.\u0275fac=function(a){return new(a||u)},u.\u0275cmp=i.Xpm({type:u,selectors:[["app-rating"]],inputs:{ratingsCount:"ratingsCount",ratingsValue:"ratingsValue",direction:"direction",showText:"showText"},decls:4,vars:4,consts:[[3,"fxLayout","fxLayoutAlign"],[1,"ratings"],["class","mat-icon-xs",3,"click",4,"ngFor","ngForOf"],["class","ratings-count text-muted",4,"ngIf"],[1,"mat-icon-xs",3,"click"],[1,"ratings-count","text-muted"]],template:function(a,c){1&a&&(i.TgZ(0,"div",0)(1,"div",1),i.YNc(2,g,2,1,"mat-icon",2),i.qZA(),i.YNc(3,f,2,1,"p",3),i.qZA()),2&a&&(i.Q6J("fxLayout",c.direction)("fxLayoutAlign","row"==c.direction?"start center":"center end"),i.xp6(2),i.Q6J("ngForOf",c.stars),i.xp6(1),i.Q6J("ngIf",c.showText))},dependencies:[m.sg,m.O5,e.xw,e.Wh,d.Hw],styles:[".ratings[_ngcontent-%COMP%]{color:#fbc02d}.ratings-count[_ngcontent-%COMP%]{margin-left:12px;font-weight:500}"]})},6660:(b,h,n)=>{n.d(h,{H:()=>m});var i=n(4650);class m{transform(d,g){return d.filter(f=>f.id==g)[0]}}m.\u0275fac=function(d){return new(d||m)},m.\u0275pipe=i.Yjl({name:"filterById",type:m,pure:!0})},1419:(b,h,n)=>{n.d(h,{DA:()=>f,JQ:()=>g,go:()=>m,mo:()=>e});var i=n(4650);class m{transform(a,c){let s=new RegExp(c,"ig");if(a)return a.filter(t=>t.profile.name?-1!==t.profile.name.search(s):-1!==t.username.search(s))}}m.\u0275fac=function(a){return new(a||m)},m.\u0275pipe=i.Yjl({name:"UserSearchPipe",type:m,pure:!1});class e{transform(a,c){let s=new RegExp(c,"ig");if(a)return a.filter(t=>t.first_name?-1!==t.first_name.search(s):t.last_name?-1!==t.last_name.search(s):-1!==t.username.search(s))}}e.\u0275fac=function(a){return new(a||e)},e.\u0275pipe=i.Yjl({name:"EmpSearchPipe",type:e,pure:!1});class d{transform(a,c){let s=new RegExp(c,"ig");if(a)return a.filter(t=>t.ownFirstName?-1!==t.ownFirstName.search(s):-1!==t.ownLastName.search(s))}}d.\u0275fac=function(a){return new(a||d)},d.\u0275pipe=i.Yjl({name:"OwnerSearchPipe",type:d,pure:!1});class g{transform(a,c){if(!a)return null;if(!c)return a;let s=new RegExp(c,"ig");return a?a.filter(t=>t.build_Name&&-1!==t.build_Name.search(s)?-1!==t.build_Name.search(s):t.unit_UnitNumber&&-1!==t.unit_UnitNumber.search(s)?-1!==t.unit_UnitNumber.search(s):t.customer_Name&&-1!==t.customer_Name.search(s)?-1!==t.customer_Name.search(s):t.customer_Mobile&&-1!==t.customer_Mobile.search(s)?-1!==t.customer_Mobile.search(s):t.RCOCode&&-1!==t.RCOCode.toString().search(s)?-1!==t.RCOCode.toString().search(s):t.RCOEjarCode?-1!==t.RCOEjarCode.toString().search(s)?-1!==t.RCOEjarCode.toString().search(s):-1!==t.build_Name.search(s):-1!=t.unit_UnitNumber.search(s)):void 0}}g.\u0275fac=function(a){return new(a||g)},g.\u0275pipe=i.Yjl({name:"ContractSearchPipe",type:g,pure:!1});class f{transform(a,c){if(!a)return null;if(!c)return a;let s=new RegExp(c,"ig");return a?a.filter(t=>t.CUSName&&-1!==t.CUSName.search(s)?-1!==t.CUSName.search(s):t.CUSMobile&&-1!==t.CUSMobile.search(s)?-1!==t.CUSMobile.search(s):t.unit_Name&&-1!==t.unit_Name.search(s)?-1!==t.unit_Name.search(s):t.build_Name&&-1!==t.build_Name.search(s)?-1!==t.build_Name.search(s):t.job_Name&&-1!==t.job_Name.search(s)?-1!==t.job_Name.search(s):t.workplace_Name?-1!==t.workplace_Name.search(s)?-1!==t.workplace_Name.search(s):-1!==t.CUSName.search(s):-1!=t.CUSName.search(s)):void 0}}f.\u0275fac=function(a){return new(a||f)},f.\u0275pipe=i.Yjl({name:"TenantSearchPipe",type:f,pure:!1});class u{transform(a,c){let s=new RegExp(c,"ig");if(a)return a.filter(t=>t.CUSMobile?-1!==t.CUSMobile.search(s):-1!==t.CUSName.search(s))}}u.\u0275fac=function(a){return new(a||u)},u.\u0275pipe=i.Yjl({name:"TenantMobileSearchPipe",type:u,pure:!1})},8955:(b,h,n)=>{function i(e){if(e.value&&!/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$/.test(e.value))return{invalidEmail:!0}}function m(e,d){return g=>{let u=g.controls[d];if(g.controls[e].value!==u.value)return u.setErrors({mismatchedPasswords:!0})}}n.d(h,{L:()=>i,z:()=>m})}}]);