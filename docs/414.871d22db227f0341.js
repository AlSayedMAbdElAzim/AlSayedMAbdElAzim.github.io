"use strict";(self.webpackChunkemporium=self.webpackChunkemporium||[]).push([[414],{3221:(S,v,s)=>{s.d(v,{y:()=>f});var p=s(2340),l=s(5783),t=s(4650),h=s(4006),e=s(9132),O=s(7009),D=s(3071),x=s(5298),A=s(7465),u=s(3081),T=s(5412),b=s(4165),P=s(1182),E=s(6895),M=s(4333),g=s(1576),_=s(4859),o=s(3546),c=s(7392),C=s(266);function U(a,n){if(1&a){const i=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(i);const m=t.oxw(2);return t.KtG(m.onClickUsed())}),t.TgZ(1,"mat-icon"),t._uU(2,"vpn_key"),t.qZA()()}}function y(a,n){if(1&a){const i=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(i);const m=t.oxw().$implicit,d=t.oxw();return t.KtG(d.onClickSendItToUser(d.AllPermissionsDisplayed,m.codename))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"lock"),t.qZA()()}2&a&&t.s9C("matTooltip",t.lcZ(1,1,"BTN.Transfer"))}function L(a,n){if(1&a&&(t.TgZ(0,"div",10)(1,"div",11),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",12),t._uU(5),t.qZA(),t.TgZ(6,"div",11)(7,"div",13),t.YNc(8,U,3,0,"button",14),t.YNc(9,y,4,3,"button",15),t.qZA()()()),2&a){const i=n.$implicit,r=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,4,"SECURITY."+i.codename)),t.xp6(3),t.Oqu(i.codename),t.xp6(3),t.Q6J("ngIf",r.can("add_emp_security_onepermission")&&r.userPerm.indexOf(i.codename)>-1),t.xp6(1),t.Q6J("ngIf",r.can("add_emp_security_onepermission")&&-1==r.userPerm.indexOf(i.codename))}}function I(a,n){if(1&a){const i=t.EpF();t.TgZ(0,"div")(1,"div",18)(2,"mat-card",19)(3,"pagination-controls",20),t.NdJ("pageChange",function(m){t.CHM(i);const d=t.oxw();return t.KtG(d.onPageChanged(m))}),t.qZA()()()()}}function Z(a,n){if(1&a){const i=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(i);const m=t.oxw().$implicit,d=t.oxw();return t.KtG(d.onClickDeletePerm(m.codename))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()}2&a&&t.s9C("matTooltip",t.lcZ(1,1,"BTN.REMOVE"))}function R(a,n){if(1&a&&(t.TgZ(0,"div",10)(1,"div",21),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",11)(5,"div",13),t.YNc(6,Z,4,3,"button",15),t.qZA()()()),2&a){const i=n.$implicit,r=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,2,"SECURITY."+i.codename)," "),t.xp6(4),t.Q6J("ngIf",r.can("delete_emp_security_onepermission"))}}function B(a,n){if(1&a){const i=t.EpF();t.TgZ(0,"div")(1,"div",18)(2,"mat-card",19)(3,"pagination-controls",22),t.NdJ("pageChange",function(m){t.CHM(i);const d=t.oxw();return t.KtG(d.onUserPageChanged(m))}),t.qZA()()()()}}class f{constructor(n,i,r,m,d,K,w,W,Y,F,N,J){this.formBuilder=n,this.router=i,this.snackBar=r,this.userService=m,this.activatedRoute=d,this.localStore=K,this.global=w,this.translateService=W,this.fb=Y,this.dialog=F,this.settingService=N,this.appSettings=J,this.countAll=6,this.countPerUser=6,this.curCOMId=p.N.comid,this.account=new l.n,this.tempuserPerm=[],this.AllPermissions=[],this.AllPermissionsDisplayed=[],this.tempDisplayed=[],this.UserPermissions=[],this.userPerm=[],this.settings=this.appSettings.settings}ngOnInit(){if(this.userSUb=this.global.user.subscribe(n=>{this.account=n}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let n=0;n<this.curUserPermissions.length;n++)this.tempuserPerm[n]=this.curUserPermissions[n].codename;this.getAllPermissions()}this.sub=this.activatedRoute.params.subscribe(n=>{n.id&&(this.id=+n.id,console.log("params['id']:: "+this.id),this.getUserPermissions(+this.id))})}can(n){return!(!this.curUserData.is_superuser&&!this.tempuserPerm.includes(n))}refreshDisplayed(n){this.AllPermissionsDisplayed=n,this.config={id:"basicPaginate",itemsPerPage:this.countAll,currentPage:1,totalItems:this.AllPermissionsDisplayed.length}}getAllPermissions(){this.userService.getAllPermission().subscribe(n=>{this.AllPermissions=n,this.refreshDisplayed(this.AllPermissions),this.tempDisplayed=n,this.config={id:"basicPaginate",itemsPerPage:this.countAll,currentPage:1,totalItems:this.AllPermissions.length}},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getUserPermissions(n){this.userService.getUserPermission(n).subscribe(i=>{this.UserPermissions=i.user_permissions,this.userConfig={id:"userPaginate",itemsPerPage:this.countPerUser,currentPage:1,totalItems:this.UserPermissions.length},this.userPermInArray()},i=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}userPermInArray(){for(let n=0;n<this.UserPermissions.length;n++)this.userPerm[n]=this.UserPermissions[n].codename,console.log("this.userPerm[i]:: "+this.userPerm[n])}manageAllPermissionsDisplayed(){console.log("this.userPerm:: "+this.userPerm),this.tempDisplayed.forEach((n,i)=>{this.userPerm.includes(this.tempDisplayed[i].codename)&&(console.log("**included:: "+this.tempDisplayed[i].codename),delete this.tempDisplayed[i])}),this.refreshDisplayed(this.tempDisplayed)}onClickSendItToUser(n,i){console.log("----// Add it to Table  ----//"),this.userService.addUserPerm(this.id,i).subscribe(r=>{this.refreshDisplayed(n),this.getUserPermissions(this.id)})}onClickDeletePerm(n){console.log("----// Remove Perm from Table  ----//"),this.userService.removeUserPerm(this.id,n).subscribe(i=>{this.getUserPermissions(this.id)})}onClickUsed(){console.log("--** it is used so, will not do anything **--")}onPageChanged(n){this.config.currentPage=n}onUserPageChanged(n){this.userConfig.currentPage=n}onLoginFormSubmit(n){}onRegisterFormSubmit(n){}}f.\u0275fac=function(n){return new(n||f)(t.Y36(h.QS),t.Y36(e.F0),t.Y36(O.ux),t.Y36(D.K),t.Y36(e.gz),t.Y36(x.C),t.Y36(A.U),t.Y36(u.sK),t.Y36(h.qu),t.Y36(T.uw),t.Y36(b.g),t.Y36(P.d))},f.\u0275cmp=t.Xpm({type:f,selectors:[["app-emp-security-dialog"]],decls:29,vars:19,consts:[[1,"p-4"],["fxLayout","row"],["fxFlex","100","fxFlex.gt-sm","50",1,"p-3"],[1,"mat-mdc-table","permission-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],[4,"ngIf"],["fxFlex","100","fxFlex.gt-sm","10",1,"p-3"],["fxFlex","100","fxFlex.gt-sm","35",1,"p-3"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"mat-mdc-cell","primary-text","notifbold"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"click",4,"ngIf"],["mat-mini-fab","","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"click"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["fxFlex","100"],[1,"p-0","text-center"],["id","basicPaginate","autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],[1,"mat-mdc-cell","selectedbold"],["id","userPaginate","autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"]],template:function(n,i){1&n&&(t.TgZ(0,"mat-card",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h2"),t._uU(7),t.ALo(8,"translate"),t.qZA()(),t.TgZ(9,"div",5)(10,"h2"),t._uU(11),t.ALo(12,"translate"),t.qZA()(),t._UZ(13,"div",5),t.qZA(),t.YNc(14,L,10,6,"div",6),t.ALo(15,"paginate"),t.qZA(),t.YNc(16,I,4,0,"div",7),t.qZA(),t._UZ(17,"div",8),t.TgZ(18,"div",9)(19,"div",3)(20,"div",4)(21,"div",5)(22,"h2"),t._uU(23),t.ALo(24,"translate"),t.qZA()(),t._UZ(25,"div",5),t.qZA(),t.YNc(26,R,7,4,"div",6),t.ALo(27,"paginate"),t.qZA(),t.YNc(28,B,4,0,"div",7),t.qZA()()()),2&n&&(t.xp6(7),t.hij(" ",t.lcZ(8,7,"HTML.Description")," "),t.xp6(4),t.hij(" ",t.lcZ(12,9,"HTML.CODE")," "),t.xp6(3),t.Q6J("ngForOf",t.xi3(15,11,i.AllPermissionsDisplayed,i.config)),t.xp6(2),t.Q6J("ngIf",i.AllPermissionsDisplayed.length>0),t.xp6(7),t.hij(" ",t.lcZ(24,14,"HTML.CODE")," "),t.xp6(3),t.Q6J("ngForOf",t.xi3(27,16,i.UserPermissions,i.userConfig)),t.xp6(2),t.Q6J("ngIf",i.UserPermissions.length>0))},dependencies:[E.sg,E.O5,M.LS,g.xw,g.yH,_.nh,o.a8,c.Hw,C.gM,M._s,u.X$],styles:[".auth[_ngcontent-%COMP%]{white-space:nowrap;padding:7px 14px;font-weight:500}.notifbold[_ngcontent-%COMP%]{font-weight:700}.selectedbold[_ngcontent-%COMP%]{font-weight:700;color:green}.permission-table.mat-mdc-table[_ngcontent-%COMP%]{display:block;overflow-x:auto}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-row[_ngcontent-%COMP%]{display:flex;border-bottom-width:1px;border-bottom-style:solid;align-items:center;min-height:48px;padding:0 16px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{flex:1;overflow:hidden;word-wrap:break-word;padding:0 8px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell.image[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell.image[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;flex-basis:60px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;border-radius:50%;margin:4px 0}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell.status[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell.status[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;flex-basis:32px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell.ratings[_ngcontent-%COMP%], .permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell.ratings[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;flex-basis:80px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{font-size:14px}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{text-align:right}.permission-table.mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 4px}.permission-table.mat-mdc-table.header-sm[_ngcontent-%COMP%]   .mat-mdc-header-row[_ngcontent-%COMP%]{min-height:36px}.permission-table.mat-mdc-table.truncated[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%], .permission-table.mat-mdc-table.truncated[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis}"]})},6331:(S,v,s)=>{s.d(v,{p:()=>g});var p=s(5412),l=s(4006),t=s(2340),h=s(3071),e=s(4650),O=s(3081),D=s(5298),x=s(7009),A=s(6895),u=s(1576),T=s(4859),b=s(4144),P=s(9549);function E(_,o){1&_&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&_&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"HTML.PasswordREQ")))}function M(_,o){1&_&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&_&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"MESSAGE.MinLength6")))}class g{constructor(o,c,C,U,y,L,I,Z){this.dialogRef=o,this.data=c,this.translateService=C,this.localStore=U,this.userService=y,this.dialog=L,this.snackBar=I,this.fb=Z,this.curCOMId=t.N.comid}ngOnInit(){this.dataForm=this.fb.group({password:[null,l.kI.required]}),this.curPeriority=this.data.dataRow.periorty,this.action="Patch",this.prepareMsgLanguage()}can(o){return!(!this.data.curUserData.is_superuser&&!this.data.userPerm.includes(o))}onSave(){this.action="Patch",this.userService.changePassword(this.dataForm,this.data.pk).subscribe(o=>{this.snackBar.open(this.passChangedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3})},o=>{this.snackBar.open(this.passNotChangedMsg,"\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}),this.dialogRef.close({event:this.action})}close(){this.action="Cancel",console.log("===***Press Close button***==="),this.dialogRef.close({event:this.action})}prepareMsgLanguage(){this.translateService.get("MESSAGE.PasswordChanged").subscribe(o=>{this.passChangedMsg=o}),this.translateService.get("MESSAGE.PasswordNotChanged").subscribe(o=>{this.passNotChangedMsg=o})}}g.\u0275fac=function(o){return new(o||g)(e.Y36(p.so),e.Y36(p.WI),e.Y36(O.sK),e.Y36(D.C),e.Y36(h.K),e.Y36(p.uw),e.Y36(x.ux),e.Y36(l.QS))},g.\u0275cmp=e.Xpm({type:g,selectors:[["app-change-password"]],features:[e._Bn([h.K])],decls:22,vars:16,consts:[["autocomplete","off",3,"formGroup"],["mat-dialog-content",""],["fxLayout","row wrap"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["fxFlex","100","fxFlex.gt-sm","99.8",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","password","type","password","required","",3,"placeholder"],[4,"ngIf"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-raised-button","","color","warn",3,"click"]],template:function(o,c){1&o&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e._UZ(9,"input",6),e.ALo(10,"translate"),e.YNc(11,E,3,3,"mat-error",7),e.YNc(12,M,3,3,"mat-error",7),e.qZA()()()()(),e.TgZ(13,"div",8)(14,"div",3)(15,"button",9),e.NdJ("click",function(){return c.onSave()}),e.TgZ(16,"span"),e._uU(17),e.ALo(18,"translate"),e.qZA()(),e.TgZ(19,"button",10),e.NdJ("click",function(){return c.close()}),e._uU(20),e.ALo(21,"translate"),e.qZA()()()()),2&o&&(e.Q6J("formGroup",c.dataForm),e.xp6(7),e.hij(" ",e.lcZ(8,8,"HTML.PASSWORD"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(10,10,"HTML.PASSWORD")),e.xp6(2),e.Q6J("ngIf",null==c.dataForm.controls.password.errors?null:c.dataForm.controls.password.errors.required),e.xp6(1),e.Q6J("ngIf",c.dataForm.controls.password.hasError("minlength")),e.xp6(3),e.Q6J("disabled",!c.dataForm.valid),e.xp6(2),e.Oqu(e.lcZ(18,12,"BTN.OK")),e.xp6(3),e.Oqu(e.lcZ(21,14,"BTN.CANCEL")))},dependencies:[A.O5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.sg,l.u,u.xw,u.Wh,u.yH,T.lW,p.xY,p.H8,b.Nt,P.KE,P.hX,P.TO,O.X$]})}}]);