"use strict";(self.webpackChunkemporium=self.webpackChunkemporium||[]).push([[589],{8959:(ee,L,c)=>{c.d(L,{W:()=>v});var m=c(5521),b=c(2340),f=c(4650),N=c(529),e=c(7465);class v{constructor(t,d){this.http=t,this.globalServ=d,this.baseUrl=(new m.P).api_Ip,this.secondPartUrl=(new m.P).api_constant,this.curCOMId=b.N.comid}getAllOwners(t,d){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/owner/allOwners/?M="+t+"&C="+d,this.globalServ.getAuthHeaders())}getOwnersPerParent(t,d,o){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/owner/ownersPerSpec/?M="+t+"&C="+d+"&getrelated=T&owner="+o,this.globalServ.getAuthHeaders())}getAllContracts(t,d){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/contract/allRentContracts/?M="+t+"&C="+d,this.globalServ.getAuthHeaders())}getContractsPerCustomer(t,d,o){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/contract/rentContractsPerSpec/?M="+t+"&C="+d+"&customer="+o,this.globalServ.getAuthHeaders())}getContractsPerBranch(t,d,o){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/contract/rentContractsPerSpec/?M="+t+"&C="+d+"&branch="+o,this.globalServ.getAuthHeaders())}getOneContract(t){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/contract/"+t,this.globalServ.getAuthHeaders())}getOneContractDocs(t,d,o){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/contractdocs/ContractDocsPerSpec?M="+t+"&C="+d+"&rcontract="+o,this.globalServ.getAuthHeaders())}deleteContract(t){return this.http.delete(this.baseUrl+this.secondPartUrl+"contracts/contract/"+t,this.globalServ.getAuthHeaders())}addContractDocs(t,d){var o=this.baseUrl+this.secondPartUrl+"contracts/contractdocs/";const n=new FormData;return null!==d&&n.append("RCDPic",d),null!==t&&n.append("contract_KeyField",t.toString()),this.http.post(o,n,this.globalServ.getAuthHeaders_for_files())}addContract(t){var d=this.baseUrl+this.secondPartUrl+"contracts/contract/";const o=new FormData;return t.Related_RCOKeyField&&o.append("Related_RCOKeyField",t.Related_RCOKeyField.toString()),t.RCOCode&&o.append("RCOCode",t.RCOCode.toString()),t.RCOSubCode&&o.append("RCOSubCode",t.RCOSubCode.toString()),t.RCODate&&o.append("RCODate",t.RCODate.toString()),t.RCOStartDate&&o.append("RCOStartDate",t.RCOStartDate.toString()),t.RCOEndDate&&o.append("RCOEndDate",t.RCOEndDate.toString()),o.append("RCOContractStatus",t.RCOContractStatus),t.branch_KeyField&&o.append("branch_KeyField",t.branch_KeyField.toString()),t.build_KeyField&&o.append("build_KeyField",t.build_KeyField.toString()),t.unit_KeyField&&o.append("unit_KeyField",t.unit_KeyField.toString()),t.owner_KeyField&&o.append("owner_KeyField",t.owner_KeyField.toString()),t.owner_representative_KeyField&&o.append("owner_representative_KeyField",t.owner_representative_KeyField.toString()),t.customer_KeyField&&o.append("customer_KeyField",t.customer_KeyField.toString()),t.customer_representative_KeyField&&o.append("customer_representative_KeyField",t.customer_representative_KeyField.toString()),t.RCOContractValue&&o.append("RCOContractValue",t.RCOContractValue.toString()),t.RCOPayEveryMonthesNo&&o.append("RCOPayEveryMonthesNo",t.RCOPayEveryMonthesNo.toString()),t.RCOMonthValue&&o.append("RCOMonthValue",t.RCOMonthValue.toString()),t.RCOInsuranceValue&&o.append("RCOInsuranceValue",t.RCOInsuranceValue.toString()),t.RCOSeekingValue&&o.append("RCOSeekingValue",t.RCOSeekingValue.toString()),t.RCOMonthlyExpense&&o.append("RCOMonthlyExpense",t.RCOMonthlyExpense.toString()),t.RCOOtherValue&&o.append("RCOOtherValue",t.RCOOtherValue.toString()),t.RCOMonthlyElectricValue&&o.append("RCOMonthlyElectricValue",t.RCOMonthlyElectricValue.toString()),t.RCOMonthlyWaterValue&&o.append("RCOMonthlyWaterValue",t.RCOMonthlyWaterValue.toString()),t.RCOMonthlyGasValue&&o.append("RCOMonthlyGasValue",t.RCOMonthlyGasValue.toString()),o.append("RCOExpenseDesc",t.RCOExpenseDesc),o.append("RCOElectricCounterReading",t.RCOElectricCounterReading),o.append("RCOWaterCounterReading",t.RCOWaterCounterReading),o.append("RCOGasCounterReading",t.RCOGasCounterReading),o.append("RCOActive",t.RCOActive.toString()),o.append("RowDelete",t.RowDelete.toString()),this.http.post(d,o,this.globalServ.getAuthHeaders_for_files())}editContract(t){var o=this.baseUrl+this.secondPartUrl+"contracts/contract/"+t.id+"/";const n=new FormData;return t.Related_RCOKeyField&&n.append("Related_RCOKeyField",t.Related_RCOKeyField.toString()),t.RCOCode&&n.append("RCOCode",t.RCOCode.toString()),t.RCOSubCode&&n.append("RCOSubCode",t.RCOSubCode.toString()),t.RCODate&&n.append("RCODate",t.RCODate.toString()),t.RCOStartDate&&n.append("RCOStartDate",t.RCOStartDate.toString()),t.RCOEndDate&&n.append("RCOEndDate",t.RCOEndDate.toString()),n.append("RCOContractStatus",t.RCOContractStatus),t.branch_KeyField&&n.append("branch_KeyField",t.branch_KeyField.toString()),t.build_KeyField&&n.append("build_KeyField",t.build_KeyField.toString()),t.unit_KeyField&&n.append("unit_KeyField",t.unit_KeyField.toString()),t.owner_KeyField&&n.append("owner_KeyField",t.owner_KeyField.toString()),t.owner_representative_KeyField&&n.append("owner_representative_KeyField",t.owner_representative_KeyField.toString()),t.customer_KeyField&&n.append("customer_KeyField",t.customer_KeyField.toString()),t.customer_representative_KeyField&&n.append("customer_representative_KeyField",t.customer_representative_KeyField.toString()),t.RCOContractValue&&n.append("RCOContractValue",t.RCOContractValue.toString()),t.RCOPayEveryMonthesNo&&n.append("RCOPayEveryMonthesNo",t.RCOPayEveryMonthesNo.toString()),t.RCOMonthValue&&n.append("RCOMonthValue",t.RCOMonthValue.toString()),t.RCOInsuranceValue&&n.append("RCOInsuranceValue",t.RCOInsuranceValue.toString()),t.RCOSeekingValue&&n.append("RCOSeekingValue",t.RCOSeekingValue.toString()),t.RCOMonthlyExpense&&n.append("RCOMonthlyExpense",t.RCOMonthlyExpense.toString()),t.RCOOtherValue&&n.append("RCOOtherValue",t.RCOOtherValue.toString()),t.RCOMonthlyElectricValue&&n.append("RCOMonthlyElectricValue",t.RCOMonthlyElectricValue.toString()),t.RCOMonthlyWaterValue&&n.append("RCOMonthlyWaterValue",t.RCOMonthlyWaterValue.toString()),t.RCOMonthlyGasValue&&n.append("RCOMonthlyGasValue",t.RCOMonthlyGasValue.toString()),n.append("RCOExpenseDesc",t.RCOExpenseDesc),n.append("RCOElectricCounterReading",t.RCOElectricCounterReading),n.append("RCOWaterCounterReading",t.RCOWaterCounterReading),n.append("RCOGasCounterReading",t.RCOGasCounterReading),n.append("RCOActive",t.RCOActive.toString()),n.append("RowDelete",t.RowDelete.toString()),this.http.put(o,n,this.globalServ.getAuthHeaders_for_files())}getInstallmentsPerContract(t,d,o){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/installment/InstallmentPerSpec/?M="+t+"&C="+d+"&contract="+o,this.globalServ.getAuthHeaders())}getInstallmentsPerCustomer_Payed(t,d,o,n){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/installment/InstallmentPerSpec/?M="+t+"&C="+d+"&payed="+n+"&customer="+o,this.globalServ.getAuthHeaders())}getInstallmentsPerCustomer_All(t,d,o){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/installment/InstallmentPerSpec/?M="+t+"&C="+d+"&customer="+o,this.globalServ.getAuthHeaders())}getOneInstallment(t){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/installment/"+t,this.globalServ.getAuthHeaders())}deleteInstallment(t){return this.http.delete(this.baseUrl+this.secondPartUrl+"contracts/installment/"+t,this.globalServ.getAuthHeaders())}addInstallments(t){return this.http.post(this.baseUrl+this.secondPartUrl+"contracts/installment/",t,this.globalServ.getAuthHeaders_for_files())}addOneInstallment(t){var d=this.baseUrl+this.secondPartUrl+"contracts/installment/";const o=new FormData;return t.contract_KeyField&&o.append("contract_KeyField",t.contract_KeyField.toString()),t.branch_KeyField&&o.append("branch_KeyField",t.branch_KeyField.toString()),t.owner_KeyField&&o.append("owner_KeyField",t.owner_KeyField.toString()),t.build_KeyField&&o.append("build_KeyField",t.build_KeyField.toString()),t.unit_KeyField&&o.append("unit_KeyField",t.unit_KeyField.toString()),t.customer_KeyField&&o.append("customer_KeyField",t.customer_KeyField.toString()),t.INSCode&&o.append("INSCode",t.INSCode.toString()),t.INSValue&&o.append("INSValue",t.INSValue.toString()),t.INSPayedValue&&o.append("INSPayedValue",t.INSPayedValue.toString()),o.append("INSContractTyps",t.INSContractTyps),o.append("INSStatus",t.INSStatus),o.append("INSPersonPayName",t.INSPersonPayName),o.append("INSNotes",t.INSNotes),o.append("RowDelete",t.RowDelete.toString()),o.append("RowConfirm",t.RowConfirm.toString()),o.append("RowStatus",t.RowStatus.toString()),this.http.post(d,o,this.globalServ.getAuthHeaders_for_files())}editInstallments(t){return this.http.patch(this.baseUrl+this.secondPartUrl+"contracts/installment/"+t.id+"/",t,this.globalServ.getAuthHeaders_for_files())}editOneInstallment(t){var o=this.baseUrl+this.secondPartUrl+"contracts/installment/"+t.id+"/";console.log("---editOneInstallment URL:: "+o);const n=new FormData;return t.INSDueDate&&n.append("INSDueDate",t.INSDueDate.toString()),t.INSPayDate&&n.append("INSPayDate",t.INSPayDate.toString()),t.contract_KeyField&&n.append("contract_KeyField",t.contract_KeyField.toString()),t.branch_KeyField&&n.append("branch_KeyField",t.branch_KeyField.toString()),t.owner_KeyField&&n.append("owner_KeyField",t.owner_KeyField.toString()),t.build_KeyField&&n.append("build_KeyField",t.build_KeyField.toString()),t.unit_KeyField&&n.append("unit_KeyField",t.unit_KeyField.toString()),t.customer_KeyField&&n.append("customer_KeyField",t.customer_KeyField.toString()),t.INSCode&&n.append("INSCode",t.INSCode.toString()),t.INSValue&&n.append("INSValue",t.INSValue.toString()),t.INSPayedValue&&n.append("INSPayedValue",t.INSPayedValue.toString()),n.append("INSContractTyps",t.INSContractTyps),n.append("INSStatus",t.INSStatus),n.append("INSPersonPayName",t.INSPersonPayName),n.append("INSNotes",t.INSNotes),n.append("RowDelete",t.RowDelete.toString()),n.append("RowConfirm",t.RowConfirm.toString()),n.append("RowStatus",t.RowStatus.toString()),this.http.put(o,n,this.globalServ.getAuthHeaders_for_files())}updateCustomerUnitFromContract(t,d,o){return this.http.patch(this.baseUrl+this.secondPartUrl+"contracts/customer/"+t+"/",{current_building:d,current_unit:o},this.globalServ.getAuthHeaders_for_files())}addStatement(t){return this.http.post(this.baseUrl+this.secondPartUrl+"contracts/statements/",t,this.globalServ.getAuthHeaders_for_files())}getStatementsIDPerSubjectID(t,d,o,n){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/statements/StatementsPerSpec?M="+t+"&C="+d+"&subject="+o+"&subjectid="+n,this.globalServ.getAuthHeaders())}deleteStatementForSubjectID(t,d,o,n){return this.getStatementsIDPerSubjectID(t,d,o,n).subscribe(D=>{this.stateID=D[0].id}),this.http.delete(this.baseUrl+this.secondPartUrl+"contracts/statements/"+this.stateID,this.globalServ.getAuthHeaders())}deleteStatement(t){return this.http.delete(this.baseUrl+this.secondPartUrl+"contracts/statements/"+t,this.globalServ.getAuthHeaders())}}v.\u0275fac=function(t){return new(t||v)(f.LFG(N.eN),f.LFG(e.U))},v.\u0275prov=f.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"})},1589:(ee,L,c)=>{c.r(L),c.d(L,{PaymentsModule:()=>R,routes:()=>z});var m=c(6895),b=c(2340),f=c(5783),N=c(5521),e=c(4650),v=c(529),C=c(7465);class t{constructor(a,i){this.http=a,this.globalServ=i,this.baseUrl=(new N.P).api_Ip,this.secondPartUrl=(new N.P).api_constant,this.curCOMId=b.N.comid}getAllReceivableDocuments(a,i){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/paydoc/PayDocsPerSpec/?type=R&M="+a+"&C="+i,this.globalServ.getAuthHeaders())}getAllPayableDocuments(a,i){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/paydoc/PayDocsPerSpec/?type=P&M="+a+"&C="+i,this.globalServ.getAuthHeaders())}deleteDocument(a){return this.http.delete(this.baseUrl+this.secondPartUrl+"contracts/paydoc/"+a,this.globalServ.getAuthHeaders())}getOneDocs(a){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/paydoc/"+a,this.globalServ.getAuthHeaders())}addDoc(a){return this.http.post(this.baseUrl+this.secondPartUrl+"contracts/paydoc/",a,this.globalServ.getAuthHeaders_for_files())}editDoc(a){return this.http.patch(this.baseUrl+this.secondPartUrl+"contracts/paydoc/"+a.id+"/",a,this.globalServ.getAuthHeaders_for_files())}}t.\u0275fac=function(a){return new(a||t)(e.LFG(v.eN),e.LFG(C.U))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"});var d=c(2887),o=c(1182),n=c(5412),D=c(9132),w=c(5298),V=c(8959),F=c(3081),E=c(7009),O=c(4333),_=c(1576),P=c(4859),M=c(811),S=c(3546),Y=c(7392),B=c(4850),J=c(1572),G=c(266);const te=function(s){return["/payments/receivable-add/",s]};function ae(s,a){if(1&s){const i=e.EpF();e.TgZ(0,"div",17)(1,"div",18),e._uU(2),e.qZA(),e.TgZ(3,"div",18),e._uU(4),e.qZA(),e.TgZ(5,"div",18),e._uU(6),e.qZA(),e.TgZ(7,"div",18),e._uU(8),e.qZA(),e.TgZ(9,"div",18),e._uU(10),e.qZA(),e.TgZ(11,"div",18),e._uU(12),e.qZA(),e.TgZ(13,"div",18),e._uU(14),e.qZA(),e.TgZ(15,"div",18)(16,"div",19)(17,"a",20),e.ALo(18,"translate"),e.TgZ(19,"mat-icon"),e._uU(20,"edit"),e.qZA()(),e.TgZ(21,"button",21),e.NdJ("click",function(){const u=e.CHM(i).$implicit,h=e.oxw();return e.KtG(h.removeDocument(u.id))}),e.ALo(22,"translate"),e.TgZ(23,"mat-icon"),e._uU(24,"delete"),e.qZA()()()()()}if(2&s){const i=a.$implicit;e.xp6(2),e.Oqu(i.branch_KeyField),e.xp6(2),e.Oqu(i.build_Name),e.xp6(2),e.Oqu(i.unit_UnitNumber),e.xp6(2),e.hij(" ",i.customer_Name," "),e.xp6(2),e.hij(" ",i.PDODocDate," "),e.xp6(2),e.hij(" ",i.PDOValue," "),e.xp6(2),e.hij(" ",i.PDOPrintedCode," "),e.xp6(3),e.s9C("matTooltip",e.lcZ(18,10,"BTN.EDIT")),e.Q6J("routerLink",e.VKq(14,te,i.id)),e.xp6(4),e.s9C("matTooltip",e.lcZ(22,12,"BTN.REMOVE"))}}function ie(s,a){if(1&s){const i=e.EpF();e.TgZ(0,"div",22)(1,"div",23)(2,"mat-card",24)(3,"pagination-controls",25),e.NdJ("pageChange",function(r){e.CHM(i);const u=e.oxw();return e.KtG(u.onPageChanged(r))}),e.qZA()()()()}}function oe(s,a){1&s&&(e.TgZ(0,"div",26),e._UZ(1,"mat-spinner",27),e.qZA())}const le=function(s,a){return{itemsPerPage:s,currentPage:a}};class Z{constructor(a,i,l,r,u,h,g,y,I){this.appSettings=a,this.dialog=i,this.paymentService=l,this.router=r,this.global=u,this.localStore=h,this.contractService=g,this.translateService=y,this.snackBar=I,this.curCOMId=b.N.comid,this.account=new f.n,this.count=4,this.settings=this.appSettings.settings}ngOnInit(){this.userSUb=this.global.user.subscribe(a=>{this.account=a}),this.localStore.getItem("token")&&this.localStore.getItem("account")?(this.global.me=JSON.parse(this.localStore.getItem("account")),this.prepareMsgLanguage(),this.getDocuments()):this.router.navigate(["/sign-in"])}getDocuments(){this.documentsAll=null,this.paymentService.getAllReceivableDocuments(this.curCOMId,this.account.periorty).subscribe(a=>this.documentsAll=a)}removeDocument(a){this.dialog.open(d.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(l=>{l&&(this.paymentService.getOneDocs(a).subscribe(r=>{null!=r.installment_KeyField&&(this.oneDocValue=r.PDOValue,this.contractService.getOneInstallment(r.installment_KeyField).subscribe(u=>{this.curInstallmentValue=u.INSValue,this.curInstallmentPayedValue=u.INSPayedValue,null==this.curInstallmentValue&&(this.curInstallmentValue=0),null==this.curInstallmentPayedValue&&(this.curInstallmentPayedValue=0),this.manageInstallmetPayedValue(r.installment_KeyField,this.curInstallmentValue,this.curInstallmentPayedValue,this.oneDocValue)}))}),this.paymentService.deleteDocument(a).subscribe(r=>this.getDocuments()))})}manageInstallmetPayedValue(a,i,l,r){null==l&&(l=0),null==r&&(r=0),null==i&&(i=0);let u=+l-+r;u<=0&&(u=0),this.insStatus=0==u?"N":"T";let h={id:a,INSStatus:this.insStatus,INSPayedValue:u};console.log("===installData:: "+h),this.contractService.editInstallments(h).subscribe(g=>{console.log("==installment after Update:: "+g)},g=>{console.log(g)})}onPageChanged(a){this.page=a,this.getDocuments(),window.scrollTo(0,0)}gotoNewDocument(){this.router.navigate(["/payments/receivable-add/"])}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(a=>{this.errorRetrieveMsg=a}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(a=>{this.askToDeletedMsg=a}),this.translateService.get("MESSAGE.DELETED").subscribe(a=>{this.deletedMsg=a}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(a=>{this.deletedTitleMsg=a})}}Z.\u0275fac=function(a){return new(a||Z)(e.Y36(o.d),e.Y36(n.uw),e.Y36(t),e.Y36(D.F0),e.Y36(C.U),e.Y36(w.C),e.Y36(V.W),e.Y36(F.sK),e.Y36(E.ux))},Z.\u0275cmp=e.Xpm({type:Z,selectors:[["app-receivable-doc-list"]],features:[e._Bn([t])],decls:58,vars:33,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","list"],["viewType","matButtonToggleGroup"],["value","list"],["value","grid"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100",1,"p-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(a,i){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-button-toggle-group",2,3)(4,"mat-button-toggle",4),e.NdJ("click",function(){return i.gotoNewDocument()}),e.TgZ(5,"mat-icon"),e._uU(6,"note_add"),e.qZA()()()(),e.TgZ(7,"div",5)(8,"mat-button-toggle-group",6,7)(10,"mat-button-toggle",8)(11,"mat-icon"),e._uU(12,"view_list"),e.qZA()(),e.TgZ(13,"mat-button-toggle",9)(14,"mat-icon"),e._uU(15,"view_module"),e.qZA()()()()(),e._UZ(16,"mat-divider"),e.TgZ(17,"mat-card")(18,"div",10)(19,"h2"),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e._UZ(22,"mat-divider"),e.TgZ(23,"div",11)(24,"div",12)(25,"div",13)(26,"h2"),e._uU(27),e.ALo(28,"translate"),e.qZA()(),e.TgZ(29,"div",13)(30,"h2"),e._uU(31),e.ALo(32,"translate"),e.qZA()(),e.TgZ(33,"div",13)(34,"h2"),e._uU(35),e.ALo(36,"translate"),e.qZA()(),e.TgZ(37,"div",13)(38,"h2"),e._uU(39),e.ALo(40,"translate"),e.qZA()(),e.TgZ(41,"div",13)(42,"h2"),e._uU(43),e.ALo(44,"translate"),e.qZA()(),e.TgZ(45,"div",13)(46,"h2"),e._uU(47),e.ALo(48,"translate"),e.qZA()(),e.TgZ(49,"div",13)(50,"h2"),e._uU(51),e.ALo(52,"translate"),e.qZA()(),e._UZ(53,"div",13),e.qZA(),e.YNc(54,ae,25,16,"div",14),e.ALo(55,"paginate"),e.qZA()(),e.YNc(56,ie,4,0,"div",15),e.YNc(57,oe,2,0,"div",16)),2&a&&(e.xp6(20),e.Oqu(e.lcZ(21,11,"HTML.ReceivableDoc_List")),e.xp6(7),e.hij(" ",e.lcZ(28,13,"HTML.BRANCH")," "),e.xp6(4),e.hij(" ",e.lcZ(32,15,"HTML.BUILDING")," "),e.xp6(4),e.hij(" ",e.lcZ(36,17,"HTML.UnitNumber")," "),e.xp6(4),e.hij(" ",e.lcZ(40,19,"HTML.TENANT")," "),e.xp6(4),e.hij(" ",e.lcZ(44,21,"HTML.DocDate")," "),e.xp6(4),e.hij(" ",e.lcZ(48,23,"HTML.DocValue")," "),e.xp6(4),e.hij(" ",e.lcZ(52,25,"HTML.DocPrintedNo")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(55,27,i.documentsAll,e.WLB(30,le,i.count,i.page))),e.xp6(2),e.Q6J("ngIf",i.documentsAll),e.xp6(1),e.Q6J("ngIf",!i.documentsAll))},dependencies:[O.LS,m.sg,m.O5,D.rH,_.xw,_.Wh,_.yH,P.Tq,P.nh,M.A9,M.Yi,S.a8,Y.Hw,B.d,J.Ou,G.gM,O._s,F.X$],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}\n"],encapsulation:2});class j{}var W=c(6381),k=c(5726),p=c(4006),Q=c(3238),T=c(9602),X=c(4144),x=c(9549),$=c(4385);function ne(s,a){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.ADD")))}function se(s,a){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function re(s,a){if(1&s&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&s){const i=a.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.CUSName," ")}}class A{constructor(a,i,l,r,u,h,g,y,I,q,H){this.activatedRoute=a,this.localStore=i,this._companyService=l,this.global=r,this.router=u,this.snackBar=h,this.docsService=g,this.tenantsService=y,this.contractService=I,this.translateService=q,this.fb=H,this.curCOMId=b.N.comid,this.account=new f.n,this.curDocValue=0,this.curDocPayedValue=0,this.AllNotPayedInstallments=[],this.AllTenants=[]}ngOnInit(){this.userSUb=this.global.user.subscribe(a=>{this.account=a}),this.localStore.getItem("token")&&this.localStore.getItem("account")?(this.global.me=JSON.parse(this.localStore.getItem("account")),this.getTenants(),this.sub=this.activatedRoute.params.subscribe(a=>{a.id?(this.id=+a.id,this.getDocById(this.id)):this.payDocForDisplay=new j,this.docData_Form=this.fb.group({id:null,PDOCode:null,PDOValue:{value:null,disabled:this.id},PDODocDate:null,PDODocType:"R",PDODocClassType:"A",PDOPrintedCode:null,PDODocSecondPerson:null,PDONotes:null,contract_KeyField:null,branch_KeyField:null,owner_KeyField:null,build_KeyField:null,unit_KeyField:null,installment_KeyField:null,customer_KeyField:null})})):this.router.navigate(["/sign-in"])}getDocById(a){this.docsService.getOneDocs(a).subscribe(i=>{this.fillForm(i),this.payDocForDisplay=i})}fillForm(a){null!=a.PDODocDate&&(this.s_docDate=a.PDODocDate),this.docData_Form.patchValue({id:a.id,contract_KeyField:a.contract_KeyField,branch_KeyField:a.branch_KeyField,owner_KeyField:a.owner_KeyField,build_KeyField:a.build_KeyField,unit_KeyField:a.unit_KeyField,installment_KeyField:a.installment_KeyField,customer_KeyField:a.customer_KeyField,PDOCode:a.PDOCode,PDOValue:a.PDOValue,PDODocType:a.PDODocType,PDODocDate:a.PDODocDate,PDODocClassType:a.PDODocClassType,PDOPrintedCode:a.PDOPrintedCode,PDODocSecondPerson:a.PDODocSecondPerson,PDONotes:a.PDONotes})}readCustumer(a){this.tenantsService.getOneCustomer(a.value).subscribe(i=>{console.log("==tenantName:: "+i.CUSName),this.docData_Form.patchValue({PDODocSecondPerson:i.CUSName})}),this.getCustomerInstallmentsNotPayed(this.curCOMId,this.account.periorty,a.value)}getCustomerInstallmentsNotPayed(a,i,l){this.contractService.getInstallmentsPerCustomer_Payed(a,i,l,"F").subscribe(r=>{this.AllNotPayedInstallments=r,this.curOwnerId=r[0].owner_KeyField,this.curContract=r[0].contract_KeyField,this.curBranch=r[0].branch_KeyField,this.curBuild=r[0].build_KeyField,this.curUnit=r[0].unit_KeyField,this.curInstallment=r[0].id,this.curDocValue=r[0].INSValue,this.curDocPayedValue=r[0].INSPayedValue,null==this.curDocValue&&(this.curDocValue=0),null==this.curDocPayedValue&&(this.curDocPayedValue=0),this.docData_Form.patchValue({contract_KeyField:this.curContract,branch_KeyField:this.curBranch,build_KeyField:this.curBuild,unit_KeyField:this.curUnit,owner_KeyField:this.curOwnerId,installment_KeyField:this.curInstallment,PDOValue:this.curDocValue-this.curDocPayedValue})},r=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0623\u0642\u0633\u0627\u0637","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getTenants(){this.AllTenants=null,this.tenantsService.getCustomers(this.curCOMId,this.account.periorty).subscribe(a=>this.AllTenants=a)}mappingFormValue_ToPayDocClass(){const a=new m.uU("en-GB").transform(this.docData_Form.value.PDODocDate,"dd/MM/yyyy");this.payDocForDisplay.id=this.docData_Form.value.id,this.payDocForDisplay.contract_KeyField=this.docData_Form.value.contract_KeyField,this.payDocForDisplay.branch_KeyField=this.docData_Form.value.branch_KeyField,this.payDocForDisplay.owner_KeyField=this.docData_Form.value.owner_KeyField,this.payDocForDisplay.build_KeyField=this.docData_Form.value.build_KeyField,this.payDocForDisplay.unit_KeyField=this.docData_Form.value.unit_KeyField,this.payDocForDisplay.installment_KeyField=this.docData_Form.value.installment_KeyField,this.payDocForDisplay.customer_KeyField=this.docData_Form.value.customer_KeyField,null!=this.docData_Form.value.PDODocDate&&(this.payDocForDisplay.PDODocDate=a),this.payDocForDisplay.PDOCode=this.docData_Form.value.PDOCode,this.payDocForDisplay.PDOValue=this.docData_Form.value.PDOValue,this.payDocForDisplay.PDODocType=this.docData_Form.value.PDODocType,this.payDocForDisplay.PDODocClassType=this.docData_Form.value.PDODocClassType,this.payDocForDisplay.PDOPrintedCode=this.docData_Form.value.PDOPrintedCode,this.payDocForDisplay.PDODocSecondPerson=this.docData_Form.value.PDODocSecondPerson,this.payDocForDisplay.PDONotes=this.docData_Form.value.PDONotes}manageInstallmetPayedValue(a,i,l,r,u){null==l&&(l=0),null==r&&(r=0),null==i&&(i=0);let h=+l+ +r;this.insStatus=h<i?"T":"P";let g={id:a,INSStatus:this.insStatus,INSPayedValue:h,INSPayDate:u,INSPersonPayName:this.payDocForDisplay.PDODocSecondPerson};console.log("===installData:: "+g),this.contractService.editInstallments(g).subscribe(y=>{console.log("==installment after Update:: "+y)},y=>{console.log(y)})}saveEditDocData(a){const i=new m.uU("en-GB").transform(this.docData_Form.value.PDODocDate,"dd/MM/yyyy");this.mappingFormValue_ToPayDocClass(),a?this.docsService.editDoc(this.payDocForDisplay).subscribe(l=>{let r={contract_KeyField:l.contract_KeyField,branch_KeyField:l.branch_KeyField,owner_KeyField:l.owner_KeyField,build_KeyField:l.build_KeyField,unit_KeyField:l.unit_KeyField,installment_KeyField:l.installment_KeyField,customer_KeyField:l.customer_KeyField,TSTCreditValue:l.PDOValue,TSTDebitValue:0,TSTDate:l.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0642\u0628\u0636 \u0631\u0642\u0645 "+l.PDOCode,TSTSubject:"RECEIVABLE",TSTSubjectID:l.ID};this.contractService.deleteStatementForSubjectID(this.curCOMId,this.account.periorty,"RECEIVABLE",l.id).subscribe(u=>{this.contractService.addStatement(r).subscribe(h=>{})}),this.snackBar.open("\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/receivable-list"])},l=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}):this.docsService.addDoc(this.payDocForDisplay).subscribe(l=>{this.contractService.addStatement({contract_KeyField:l.contract_KeyField,branch_KeyField:l.branch_KeyField,owner_KeyField:l.owner_KeyField,build_KeyField:l.build_KeyField,unit_KeyField:l.unit_KeyField,installment_KeyField:l.installment_KeyField,customer_KeyField:l.customer_KeyField,TSTCreditValue:l.PDOValue,TSTDebitValue:0,TSTDate:l.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0642\u0628\u0636 \u0631\u0642\u0645 "+l.PDOCode,TSTSubject:"RECEIVABLE",TSTSubjectID:l.ID}).subscribe(u=>{}),this.manageInstallmetPayedValue(this.curInstallment,this.curDocValue,this.curDocPayedValue,this.payDocForDisplay.PDOValue,i),this.snackBar.open("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/receivable-list"])},l=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u0627\u0636\u0627\u0641\u0647 \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(a=>{this.errorRetrieveMsg=a}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(a=>{this.askToDeletedMsg=a}),this.translateService.get("MESSAGE.DELETED").subscribe(a=>{this.deletedMsg=a})}}A.\u0275fac=function(a){return new(a||A)(e.Y36(D.gz),e.Y36(w.C),e.Y36(W.J),e.Y36(C.U),e.Y36(D.F0),e.Y36(E.ux),e.Y36(t),e.Y36(k.v),e.Y36(V.W),e.Y36(F.sK),e.Y36(p.qu))},A.\u0275cmp=e.Xpm({type:A,selectors:[["app-receivable-doc-dialog"]],decls:68,vars:38,consts:[[1,"p-2"],[4,"ngIf"],[1,"pt-3"],["autocomplete","off","fxLayout","row wrap",3,"formGroup","ngSubmit"],["fxFlex","100","fxFlex.gt-sm","40",1,"px-2"],["width","400","height","300","id","campanyLogo",3,"src"],["fxFlex","100","fxFlex.gt-sm","60",1,"px-2"],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-sm","25",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","PDOCode"],["fxFlex","100","fxFlex.gt-sm","75",1,"px-1"],["formControlName","customer_KeyField","id","oneCustomOpSel","required","",3,"placeholder","selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","PDODocDate","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["pdoDocDate",""],["fxFlex","100","fxFlex.gt-sm","50",1,"px-1"],["matInput","","formControlName","PDOValue","required",""],["matInput","","formControlName","PDOPrintedCode"],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","PDODocSecondPerson","required",""],["fxFlex","100",1,"px-1"],["matInput","","formControlName","PDONotes","rows","3"],["fxFlex","100",1,"mt-2","text-center","w-100"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(a,i){if(1&a&&(e.TgZ(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"h1"),e.YNc(5,ne,3,3,"span",1),e.YNc(6,se,3,3,"span",1),e._uU(7),e.ALo(8,"translate"),e.qZA()()(),e.TgZ(9,"mat-card-content",2)(10,"form",3),e.NdJ("ngSubmit",function(){return i.saveEditDocData(i.payDocForDisplay.id)}),e.TgZ(11,"div",4),e._UZ(12,"img",5),e.qZA(),e.TgZ(13,"div",6)(14,"div",7)(15,"div",8)(16,"mat-form-field",9)(17,"mat-label"),e._uU(18),e.ALo(19,"translate"),e.qZA(),e._UZ(20,"input",10),e.qZA()(),e.TgZ(21,"div",11)(22,"mat-form-field",9)(23,"mat-label"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"mat-select",12),e.NdJ("selectionChange",function(r){return i.readCustumer(r)}),e.ALo(27,"translate"),e.TgZ(28,"mat-option",13),e._uU(29,"-"),e.qZA(),e.YNc(30,re,2,2,"mat-option",14),e.qZA()()(),e.TgZ(31,"div",8)(32,"mat-form-field",9)(33,"mat-label"),e._uU(34),e.ALo(35,"translate"),e.qZA(),e._UZ(36,"input",15)(37,"mat-datepicker-toggle",16)(38,"mat-datepicker",null,17),e.qZA()(),e.TgZ(40,"div",18)(41,"mat-form-field",9)(42,"mat-label"),e._uU(43),e.ALo(44,"translate"),e.qZA(),e._UZ(45,"input",19),e.qZA()(),e.TgZ(46,"div",8)(47,"mat-form-field",9)(48,"mat-label"),e._uU(49),e.ALo(50,"translate"),e.qZA(),e._UZ(51,"input",20),e.qZA()(),e.TgZ(52,"div",21)(53,"mat-form-field",9)(54,"mat-label"),e._uU(55),e.ALo(56,"translate"),e.qZA(),e._UZ(57,"input",22),e.qZA()(),e.TgZ(58,"div",23)(59,"mat-form-field",9)(60,"mat-label"),e._uU(61),e.ALo(62,"translate"),e.qZA(),e._UZ(63,"textarea",24),e.qZA()(),e.TgZ(64,"div",25)(65,"button",26),e._uU(66),e.ALo(67,"translate"),e.qZA()()()()()()()()),2&a){const l=e.MAs(39);e.xp6(5),e.Q6J("ngIf",!i.payDocForDisplay.id),e.xp6(1),e.Q6J("ngIf",i.payDocForDisplay.id),e.xp6(1),e.hij(" ",e.lcZ(8,18,"HTML.ReceivableDoc"),""),e.xp6(3),e.Q6J("formGroup",i.docData_Form),e.xp6(2),e.Q6J("src","assets/images/paymentDocs/receivable.png",e.LSH),e.xp6(6),e.Oqu(e.lcZ(19,20,"HTML.CODE")),e.xp6(6),e.hij(" ",e.lcZ(25,22,"HTML.TENANT"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(27,24,"HTML.TENANT")),e.xp6(4),e.Q6J("ngForOf",i.AllTenants),e.xp6(4),e.Oqu(e.lcZ(35,26,"HTML.DocDate")),e.xp6(2),e.Q6J("matDatepicker",l),e.xp6(1),e.Q6J("for",l),e.xp6(6),e.Oqu(e.lcZ(44,28,"HTML.DocValue")),e.xp6(6),e.Oqu(e.lcZ(50,30,"HTML.DocPrintedNo")),e.xp6(6),e.Oqu(e.lcZ(56,32,"HTML.DocSecondPart_ReceivableDoc")),e.xp6(6),e.Oqu(e.lcZ(62,34,"HTML.Notes")),e.xp6(4),e.Q6J("disabled",!i.docData_Form.valid),e.xp6(1),e.Oqu(e.lcZ(67,36,"BTN.SAVE"))}},dependencies:[p._Y,p.Fj,p.JJ,p.JL,p.Q7,m.sg,m.O5,p.sg,p.u,_.xw,_.yH,Q.ey,P.lW,S.a8,S.dn,S.dk,S.n5,T.Mq,T.hl,T.nW,X.Nt,x.KE,x.hX,x.R9,$.gD,F.X$]});var de=c(589),ce=c(9045);const ue=function(s){return["/payments/payable-add/",s]};function pe(s,a){if(1&s){const i=e.EpF();e.TgZ(0,"div",17)(1,"div",18),e._uU(2),e.qZA(),e.TgZ(3,"div",18),e._uU(4),e.qZA(),e.TgZ(5,"div",18),e._uU(6),e.qZA(),e.TgZ(7,"div",18),e._uU(8),e.qZA(),e.TgZ(9,"div",18)(10,"div",19)(11,"a",20),e.ALo(12,"translate"),e.TgZ(13,"mat-icon"),e._uU(14,"edit"),e.qZA()(),e.TgZ(15,"button",21),e.NdJ("click",function(){const u=e.CHM(i).$implicit,h=e.oxw();return e.KtG(h.removeDocument(u.id))}),e.ALo(16,"translate"),e.TgZ(17,"mat-icon"),e._uU(18,"delete"),e.qZA()()()()()}if(2&s){const i=a.$implicit;e.xp6(2),e.hij(" ",i.customer_Name," "),e.xp6(2),e.hij(" ",i.PDODocDate," "),e.xp6(2),e.hij(" ",i.PDOValue," "),e.xp6(2),e.hij(" ",i.PDOPrintedCode," "),e.xp6(3),e.s9C("matTooltip",e.lcZ(12,7,"BTN.EDIT")),e.Q6J("routerLink",e.VKq(11,ue,i.id)),e.xp6(4),e.s9C("matTooltip",e.lcZ(16,9,"BTN.REMOVE"))}}function he(s,a){if(1&s){const i=e.EpF();e.TgZ(0,"div",22)(1,"div",23)(2,"mat-card",24)(3,"pagination-controls",25),e.NdJ("pageChange",function(r){e.CHM(i);const u=e.oxw();return e.KtG(u.onPageChanged(r))}),e.qZA()()()()}}function me(s,a){1&s&&(e.TgZ(0,"div",26),e._UZ(1,"mat-spinner",27),e.qZA())}const ge=function(s,a){return{itemsPerPage:s,currentPage:a}};class U{constructor(a,i,l,r,u,h,g,y){this.appSettings=a,this.dialog=i,this.paymentService=l,this.router=r,this.global=u,this.localStore=h,this.translateService=g,this.snackBar=y,this.curCOMId=b.N.comid,this.account=new f.n,this.count=4,this.settings=this.appSettings.settings}ngOnInit(){this.userSUb=this.global.user.subscribe(a=>{this.account=a}),this.localStore.getItem("token")&&this.localStore.getItem("account")?(this.global.me=JSON.parse(this.localStore.getItem("account")),this.prepareMsgLanguage(),this.getDocuments()):this.router.navigate(["/sign-in"])}getDocuments(){this.documentsAll=null,this.paymentService.getAllPayableDocuments(this.curCOMId,this.account.periorty).subscribe(a=>this.documentsAll=a)}removeDocument(a){this.dialog.open(d.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(l=>{l&&this.paymentService.deleteDocument(a).subscribe(r=>this.getDocuments())})}onPageChanged(a){this.page=a,this.getDocuments(),window.scrollTo(0,0)}gotoNewDocument(){this.router.navigate(["/payments/payable-add/"])}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(a=>{this.errorRetrieveMsg=a}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(a=>{this.askToDeletedMsg=a}),this.translateService.get("MESSAGE.DELETED").subscribe(a=>{this.deletedMsg=a}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(a=>{this.deletedTitleMsg=a})}}function De(s,a){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.ADD")))}function ye(s,a){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function _e(s,a){if(1&s&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&s){const i=a.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.CUSName," ")}}U.\u0275fac=function(a){return new(a||U)(e.Y36(o.d),e.Y36(n.uw),e.Y36(t),e.Y36(D.F0),e.Y36(C.U),e.Y36(w.C),e.Y36(F.sK),e.Y36(E.ux))},U.\u0275cmp=e.Xpm({type:U,selectors:[["app-payable-doc-list"]],features:[e._Bn([t])],decls:46,vars:24,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","list"],["viewType","matButtonToggleGroup"],["value","list"],["value","grid"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100",1,"p-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(a,i){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-button-toggle-group",2,3)(4,"mat-button-toggle",4),e.NdJ("click",function(){return i.gotoNewDocument()}),e.TgZ(5,"mat-icon"),e._uU(6,"note_add"),e.qZA()()()(),e.TgZ(7,"div",5)(8,"mat-button-toggle-group",6,7)(10,"mat-button-toggle",8)(11,"mat-icon"),e._uU(12,"view_list"),e.qZA()(),e.TgZ(13,"mat-button-toggle",9)(14,"mat-icon"),e._uU(15,"view_module"),e.qZA()()()()(),e._UZ(16,"mat-divider"),e.TgZ(17,"mat-card")(18,"div",10)(19,"h2"),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e._UZ(22,"mat-divider"),e.TgZ(23,"div",11)(24,"div",12)(25,"div",13)(26,"h2"),e._uU(27),e.ALo(28,"translate"),e.qZA()(),e.TgZ(29,"div",13)(30,"h2"),e._uU(31),e.ALo(32,"translate"),e.qZA()(),e.TgZ(33,"div",13)(34,"h2"),e._uU(35),e.ALo(36,"translate"),e.qZA()(),e.TgZ(37,"div",13)(38,"h2"),e._uU(39),e.ALo(40,"translate"),e.qZA()(),e._UZ(41,"div",13),e.qZA(),e.YNc(42,pe,19,13,"div",14),e.ALo(43,"paginate"),e.qZA()(),e.YNc(44,he,4,0,"div",15),e.YNc(45,me,2,0,"div",16)),2&a&&(e.xp6(20),e.Oqu(e.lcZ(21,8,"HTML.PayableDoc_List")),e.xp6(7),e.hij(" ",e.lcZ(28,10,"HTML.TENANT")," "),e.xp6(4),e.hij(" ",e.lcZ(32,12,"HTML.DocDate")," "),e.xp6(4),e.hij(" ",e.lcZ(36,14,"HTML.DocValue")," "),e.xp6(4),e.hij(" ",e.lcZ(40,16,"HTML.DocPrintedNo")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(43,18,i.documentsAll,e.WLB(21,ge,i.count,i.page))),e.xp6(2),e.Q6J("ngIf",i.documentsAll),e.xp6(1),e.Q6J("ngIf",!i.documentsAll))},dependencies:[O.LS,m.sg,m.O5,D.rH,_.xw,_.Wh,_.yH,P.Tq,P.nh,M.A9,M.Yi,S.a8,Y.Hw,B.d,J.Ou,G.gM,O._s,F.X$],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}\n"],encapsulation:2});class K{constructor(a,i,l,r,u,h,g,y,I,q,H){this.activatedRoute=a,this.localStore=i,this._companyService=l,this.global=r,this.router=u,this.snackBar=h,this.docsService=g,this.tenantsService=y,this.contractService=I,this.translateService=q,this.fb=H,this.curCOMId=b.N.comid,this.account=new f.n,this.AllTenants=[]}ngOnInit(){this.userSUb=this.global.user.subscribe(a=>{this.account=a}),this.localStore.getItem("token")&&this.localStore.getItem("account")?(this.global.me=JSON.parse(this.localStore.getItem("account")),this.getTenants(),this.sub=this.activatedRoute.params.subscribe(a=>{a.id?(this.id=+a.id,this.getDocById(this.id)):this.payDocForDisplay=new j,this.docData_Form=this.fb.group({id:null,PDOCode:null,PDOValue:{value:null,disabled:this.id},PDODocDate:null,PDODocType:"P",PDODocClassType:"H",PDOPrintedCode:null,PDODocSecondPerson:null,PDONotes:null,contract_KeyField:null,branch_KeyField:null,owner_KeyField:null,build_KeyField:null,unit_KeyField:null,installment_KeyField:null,customer_KeyField:null})})):this.router.navigate(["/sign-in"])}getDocById(a){this.docsService.getOneDocs(a).subscribe(i=>{this.fillForm(i),this.payDocForDisplay=i})}fillForm(a){null!=a.PDODocDate&&(this.s_docDate=a.PDODocDate),this.docData_Form.patchValue({id:a.id,contract_KeyField:a.contract_KeyField,branch_KeyField:a.branch_KeyField,owner_KeyField:a.owner_KeyField,build_KeyField:a.build_KeyField,unit_KeyField:a.unit_KeyField,installment_KeyField:a.installment_KeyField,customer_KeyField:a.customer_KeyField,PDOCode:a.PDOCode,PDOValue:a.PDOValue,PDODocType:a.PDODocType,PDODocDate:a.PDODocDate,PDODocClassType:a.PDODocClassType,PDOPrintedCode:a.PDOPrintedCode,PDODocSecondPerson:a.PDODocSecondPerson,PDONotes:a.PDONotes})}readCustumer(a){this.tenantsService.getOneCustomer(a.value).subscribe(i=>{this.docData_Form.patchValue({PDODocSecondPerson:i.CUSName,contract_KeyField:i.current_contract,branch_KeyField:i.current_branch,build_KeyField:i.current_building,unit_KeyField:i.current_unit,owner_KeyField:i.current_owner})})}getTenants(){this.AllTenants=null,this.tenantsService.getCustomers(this.curCOMId,this.account.periorty).subscribe(a=>this.AllTenants=a)}mappingFormValue_ToPayDocClass(){const a=new m.uU("en-GB").transform(this.docData_Form.value.PDODocDate,"dd/MM/yyyy");this.payDocForDisplay.id=this.docData_Form.value.id,this.payDocForDisplay.contract_KeyField=this.docData_Form.value.contract_KeyField,this.payDocForDisplay.branch_KeyField=this.docData_Form.value.branch_KeyField,this.payDocForDisplay.owner_KeyField=this.docData_Form.value.owner_KeyField,this.payDocForDisplay.build_KeyField=this.docData_Form.value.build_KeyField,this.payDocForDisplay.unit_KeyField=this.docData_Form.value.unit_KeyField,this.payDocForDisplay.installment_KeyField=this.docData_Form.value.installment_KeyField,this.payDocForDisplay.customer_KeyField=this.docData_Form.value.customer_KeyField,null!=this.docData_Form.value.PDODocDate&&(this.payDocForDisplay.PDODocDate=a),this.payDocForDisplay.PDOCode=this.docData_Form.value.PDOCode,this.payDocForDisplay.PDOValue=this.docData_Form.value.PDOValue,this.payDocForDisplay.PDODocType=this.docData_Form.value.PDODocType,this.payDocForDisplay.PDODocClassType=this.docData_Form.value.PDODocClassType,this.payDocForDisplay.PDOPrintedCode=this.docData_Form.value.PDOPrintedCode,this.payDocForDisplay.PDODocSecondPerson=this.docData_Form.value.PDODocSecondPerson,this.payDocForDisplay.PDONotes=this.docData_Form.value.PDONotes}saveEditDocData(a){this.mappingFormValue_ToPayDocClass(),a?this.docsService.editDoc(this.payDocForDisplay).subscribe(i=>{let l={contract_KeyField:i.contract_KeyField,branch_KeyField:i.branch_KeyField,owner_KeyField:i.owner_KeyField,build_KeyField:i.build_KeyField,unit_KeyField:i.unit_KeyField,installment_KeyField:null,customer_KeyField:i.customer_KeyField,TSTCreditValue:0,TSTDebitValue:i.PDOValue,TSTDate:i.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0635\u0631\u0641 \u0631\u0642\u0645 "+i.PDOCode,TSTSubject:"PAYABLE",TSTSubjectID:i.ID};this.contractService.deleteStatementForSubjectID(this.curCOMId,this.account.periorty,"PAYABLE",i.id).subscribe(r=>{this.contractService.addStatement(l).subscribe(u=>{})}),this.snackBar.open("\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/payable-list"])},i=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}):this.docsService.addDoc(this.payDocForDisplay).subscribe(i=>{this.contractService.addStatement({contract_KeyField:i.contract_KeyField,branch_KeyField:i.branch_KeyField,owner_KeyField:i.owner_KeyField,build_KeyField:i.build_KeyField,unit_KeyField:i.unit_KeyField,installment_KeyField:null,customer_KeyField:i.customer_KeyField,TSTCreditValue:0,TSTDebitValue:i.PDOValue,TSTDate:i.PDODocDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0633\u0646\u062f \u0627\u0644\u0635\u0631\u0641 \u0631\u0642\u0645 "+i.PDOCode,TSTSubject:"PAYABLE",TSTSubjectID:i.ID}).subscribe(r=>{}),this.snackBar.open("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["payments/payable-list"])},i=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u0627\u0636\u0627\u0641\u0647 \u0645\u0633\u062a\u0646\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(a=>{this.errorRetrieveMsg=a}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(a=>{this.askToDeletedMsg=a}),this.translateService.get("MESSAGE.DELETED").subscribe(a=>{this.deletedMsg=a})}}K.\u0275fac=function(a){return new(a||K)(e.Y36(D.gz),e.Y36(w.C),e.Y36(W.J),e.Y36(C.U),e.Y36(D.F0),e.Y36(E.ux),e.Y36(t),e.Y36(k.v),e.Y36(V.W),e.Y36(F.sK),e.Y36(p.qu))},K.\u0275cmp=e.Xpm({type:K,selectors:[["app-payable-doc-dialog"]],decls:68,vars:38,consts:[[1,"p-2"],[4,"ngIf"],[1,"pt-3"],["autocomplete","off","fxLayout","row wrap",3,"formGroup","ngSubmit"],["fxFlex","100","fxFlex.gt-sm","40",1,"px-2"],["width","400","height","300","id","campanyLogo",3,"src"],["fxFlex","100","fxFlex.gt-sm","60",1,"px-2"],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-sm","25",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","PDOCode"],["fxFlex","100","fxFlex.gt-sm","75",1,"px-1"],["formControlName","customer_KeyField","id","oneCustomOpSel",3,"placeholder","selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","PDODocDate","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["pdoDocDate",""],["fxFlex","100","fxFlex.gt-sm","50",1,"px-1"],["matInput","","formControlName","PDOValue","required",""],["matInput","","formControlName","PDOPrintedCode"],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","PDODocSecondPerson","required",""],["fxFlex","100",1,"px-1"],["matInput","","formControlName","PDONotes","rows","3"],["fxFlex","100",1,"mt-2","text-center","w-100"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(a,i){if(1&a&&(e.TgZ(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"h1"),e.YNc(5,De,3,3,"span",1),e.YNc(6,ye,3,3,"span",1),e._uU(7),e.ALo(8,"translate"),e.qZA()()(),e.TgZ(9,"mat-card-content",2)(10,"form",3),e.NdJ("ngSubmit",function(){return i.saveEditDocData(i.payDocForDisplay.id)}),e.TgZ(11,"div",4),e._UZ(12,"img",5),e.qZA(),e.TgZ(13,"div",6)(14,"div",7)(15,"div",8)(16,"mat-form-field",9)(17,"mat-label"),e._uU(18),e.ALo(19,"translate"),e.qZA(),e._UZ(20,"input",10),e.qZA()(),e.TgZ(21,"div",11)(22,"mat-form-field",9)(23,"mat-label"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"mat-select",12),e.NdJ("selectionChange",function(r){return i.readCustumer(r)}),e.ALo(27,"translate"),e.TgZ(28,"mat-option",13),e._uU(29,"-"),e.qZA(),e.YNc(30,_e,2,2,"mat-option",14),e.qZA()()(),e.TgZ(31,"div",8)(32,"mat-form-field",9)(33,"mat-label"),e._uU(34),e.ALo(35,"translate"),e.qZA(),e._UZ(36,"input",15)(37,"mat-datepicker-toggle",16)(38,"mat-datepicker",null,17),e.qZA()(),e.TgZ(40,"div",18)(41,"mat-form-field",9)(42,"mat-label"),e._uU(43),e.ALo(44,"translate"),e.qZA(),e._UZ(45,"input",19),e.qZA()(),e.TgZ(46,"div",8)(47,"mat-form-field",9)(48,"mat-label"),e._uU(49),e.ALo(50,"translate"),e.qZA(),e._UZ(51,"input",20),e.qZA()(),e.TgZ(52,"div",21)(53,"mat-form-field",9)(54,"mat-label"),e._uU(55),e.ALo(56,"translate"),e.qZA(),e._UZ(57,"input",22),e.qZA()(),e.TgZ(58,"div",23)(59,"mat-form-field",9)(60,"mat-label"),e._uU(61),e.ALo(62,"translate"),e.qZA(),e._UZ(63,"textarea",24),e.qZA()(),e.TgZ(64,"div",25)(65,"button",26),e._uU(66),e.ALo(67,"translate"),e.qZA()()()()()()()()),2&a){const l=e.MAs(39);e.xp6(5),e.Q6J("ngIf",!i.payDocForDisplay.id),e.xp6(1),e.Q6J("ngIf",i.payDocForDisplay.id),e.xp6(1),e.hij(" ",e.lcZ(8,18,"HTML.PayableDoc"),""),e.xp6(3),e.Q6J("formGroup",i.docData_Form),e.xp6(2),e.Q6J("src","assets/images/paymentDocs/payable.png",e.LSH),e.xp6(6),e.Oqu(e.lcZ(19,20,"HTML.CODE")),e.xp6(6),e.hij(" ",e.lcZ(25,22,"HTML.TENANT"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(27,24,"HTML.TENANT")),e.xp6(4),e.Q6J("ngForOf",i.AllTenants),e.xp6(4),e.Oqu(e.lcZ(35,26,"HTML.DocDate")),e.xp6(2),e.Q6J("matDatepicker",l),e.xp6(1),e.Q6J("for",l),e.xp6(6),e.Oqu(e.lcZ(44,28,"HTML.DocValue")),e.xp6(6),e.Oqu(e.lcZ(50,30,"HTML.DocPrintedNo")),e.xp6(6),e.Oqu(e.lcZ(56,32,"HTML.DocSecondPart_PayableDoc")),e.xp6(6),e.Oqu(e.lcZ(62,34,"HTML.Notes")),e.xp6(4),e.Q6J("disabled",!i.docData_Form.valid),e.xp6(1),e.Oqu(e.lcZ(67,36,"BTN.SAVE"))}},dependencies:[p._Y,p.Fj,p.JJ,p.JL,p.Q7,m.sg,m.O5,p.sg,p.u,_.xw,_.yH,Q.ey,P.lW,S.a8,S.dn,S.dk,S.n5,T.Mq,T.hl,T.nW,X.Nt,x.KE,x.hX,x.R9,$.gD,F.X$]});const z=[{path:"",redirectTo:"receivable-list",pathMatch:"full"},{path:"receivable-list",component:Z,data:{breadcrumb:"ReceiptVouchers"}},{path:"receivable-add/:id",component:A,data:{breadcrumb:"EditReceiptVoucher"}},{path:"receivable-add",component:A,data:{breadcrumb:"AddReceiptVoucher"}},{path:"payable-list",component:U,data:{breadcrumb:"PaymentVouchers"}},{path:"payable-add/:id",component:K,data:{breadcrumb:"EditPaymentVoucher"}},{path:"payable-add",component:K,data:{breadcrumb:"AddPaymentVoucher"}}];class R{}R.\u0275fac=function(a){return new(a||R)},R.\u0275mod=e.oAB({type:R}),R.\u0275inj=e.cJS({imports:[v.JF,p.u5,O.JX,ce.D,m.ez,D.Bz.forChild(z),p.UX,de.m,O.JX]})}}]);