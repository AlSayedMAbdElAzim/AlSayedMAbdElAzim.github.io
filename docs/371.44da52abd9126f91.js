"use strict";(self.webpackChunkemporium=self.webpackChunkemporium||[]).push([[371],{6002:(N,T,l)=>{l.d(T,{Z:()=>f});var _=l(5521),m=l(2340),g=l(4650),p=l(529),Z=l(7465);class f{constructor(e,u){this.http=e,this.globalServ=u,this.baseUrl=(new _.P).api_Ip,this.secondPartUrl=(new _.P).api_constant,this.curCOMId=m.N.comid}getAllBranch(e,u){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/allBranches/?M="+e+"&C="+u,this.globalServ.getAuthHeaders())}getOneBranch(e){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/"+e+"/",this.globalServ.getAuthHeaders())}getMainBranch(e,u){return this.http.get(this.baseUrl+this.secondPartUrl+"atlas/branch/branchPerSpec/?M="+e+"&C="+u+"&Main=T",this.globalServ.getAuthHeaders())}sendSms(e,u,c){return this.http.post(e,u,this.globalServ.smsHeaders(c))}sendSmsData(e,u){console.log("-----smsUrl:: "+e),console.log("-----smsToken:: "+u);const c=new FormData;return c.append("bearerTokens",u),c.append("sender","Jeddah Lake"),c.append("recipients","966503002323"),c.append("body","125478"),this.http.post(e,c,this.globalServ.smsHeaders(u))}sendSmsGet(e){return this.http.get(e)}sendSmsGetToken(e,u){return this.http.get(e,this.globalServ.smsHeaders(u))}addBranch(e){return this.http.post(this.baseUrl+this.secondPartUrl+"atlas/branch/",e,this.globalServ.getAuthHeaders())}editBranch(e,u){return this.http.put(this.baseUrl+this.secondPartUrl+"atlas/branch/"+u+"/",e,this.globalServ.getAuthHeaders())}deleteBranch(e){return this.http.delete(this.baseUrl+this.secondPartUrl+"atlas/branch/"+e+"/",this.globalServ.getAuthHeaders())}softDeleteBranch(e){return this.http.put(this.baseUrl+this.secondPartUrl+"atlas/branch/"+e+"/",{RowDelete:1},this.globalServ.getAuthHeaders())}}f.\u0275fac=function(e){return new(e||f)(g.LFG(p.eN),g.LFG(Z.U))},f.\u0275prov=g.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"})},3371:(N,T,l)=>{l.r(T),l.d(T,{EmployeesModule:()=>A,routes:()=>R});var _=l(6895),m=l(3071),g=l(5412),p=l(4006);class Z{}var f=l(2340),x=l(5521),e=l(4650),u=l(6002),c=l(5298),h=l(7009),a=l(1576),n=l(3238),E=l(4859),k=l(6709),D=l(9602),M=l(7392),S=l(4144),v=l(9549),q=l(1948),I=l(4385),F=l(3848),L=l(3081);function Q(o,t){1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.ADD")))}function j(o,t){1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function K(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Username is required"),e.qZA())}function G(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Username isn't long enough, minimum of 3 characters"),e.qZA())}function $(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Password is required"),e.qZA())}function W(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Password isn't long enough, minimum of 6 characters"),e.qZA())}function X(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"mat-form-field",12)(1,"mat-label")(2,"mat-icon"),e._uU(3,"vpn_key"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"input",46),e.TgZ(7,"mat-icon",47),e.NdJ("click",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.passwordHide=!r.passwordHide)}),e._uU(8),e.qZA(),e.YNc(9,$,2,0,"mat-error",1),e.YNc(10,W,2,0,"mat-error",1),e.qZA()}if(2&o){const i=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,5,"HTML.PASSWORD"),""),e.xp6(2),e.Q6J("type",i.passwordHide?"password":"text"),e.xp6(2),e.Oqu(i.passwordHide?"visibility":"visibility_off"),e.xp6(1),e.Q6J("ngIf",null==i.form.controls.password.errors?null:i.form.controls.password.errors.required),e.xp6(1),e.Q6J("ngIf",i.form.controls.password.hasError("minlength"))}}function z(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"First name is required"),e.qZA())}function V(o,t){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Last name is required"),e.qZA())}function ee(o,t){if(1&o&&(e.TgZ(0,"mat-option",27),e._uU(1),e.qZA()),2&o){const i=t.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.BRAArbName," ")}}function te(o,t){if(1&o&&(e.TgZ(0,"p")(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"i"),e._uU(5),e.ALo(6,"date"),e.qZA()()),2&o){const i=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"HTML.RegisterDate")," "),e.xp6(3),e.hij("(",e.xi3(6,4,i.user.EntryDate,"dd-MM-yyyy"),")")}}function ie(o,t){if(1&o&&(e.TgZ(0,"p")(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"i"),e._uU(5),e.qZA()()),2&o){const i=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"HTML.LastSeen")," "),e.xp6(3),e.hij("(",i.user.joinDate,")")}}function oe(o,t){1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.SAVE")))}function ne(o,t){1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BTN.EDIT")))}function se(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.onSave())}),e.YNc(1,oe,3,3,"span",1),e.YNc(2,ne,3,3,"span",1),e.qZA()}if(2&o){const i=e.oxw();e.Q6J("mat-dialog-close",i.form.value)("disabled",!i.form.valid),e.xp6(1),e.Q6J("ngIf",!i.user.id),e.xp6(1),e.Q6J("ngIf",i.user.id)}}class b{constructor(t,i,s,r,d,U){this.dialogRef=t,this.user=i,this.atlasService=s,this.localStore=r,this.snackBar=d,this.fb=U,this.passwordHide=!0,this.defaultCusImage=(new x.P).noImage,this.CusImageToUpload=null,this.curCOMId=f.N.comid,this.userPerm=[],this.AllBranches=[]}handelEmpImgInput(t){this.CusImageToUpload=t.item(0);var i=new FileReader;i.onload=s=>{this.defaultCusImage=s.target.result},i.readAsDataURL(this.CusImageToUpload)}ngOnInit(){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.form=this.fb.group({id:null,username:[null,p.kI.compose([p.kI.required,p.kI.minLength(3)])],password:null,UserCode:null,first_name:null,last_name:null,UserBirthDate:null,gender:null,userPicture:null,work:this.fb.group({userJobName:null,branch_KeyField:null,is_superuser:!1,is_staff:!1,is_active:!0,is_employee:!0}),contacts:this.fb.group({email:[null,p.kI.required],UserMobile:[null,p.kI.required],userAddress:null}),social:this.fb.group({userFacebook:null,userTwitter:null,userGoogle:null}),settings:this.fb.group({isActive:!1,isDeleted:!1,EntryDate:null,joinedDate:null})}),this.user?(this.curPeriority=this.user.periorty,this.action="Patch",this.fillForm(this.user)):(this.curPeriority=0,this.action="Post",this.user=new Z),this.getAllBranches(this.curCOMId,this.curPeriority)}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}fillForm(t){this.defaultCusImage=null!=t.userPicture?t.userPicture:(new x.P).noImage,this.is_delete=1==t.RowDelete,this.is_Employee="T"==t.is_employee,this.form.patchValue({id:t.id,username:t.username,password:t.password,UserCode:t.UserCode,first_name:t.first_name,last_name:t.last_name,UserBirthDate:t.UserBirthDate,gender:t.gender,userPicture:t.userPicture,work:{userJobName:t.userJobName,branch_KeyField:t.branch_KeyField,is_superuser:t.is_superuser,is_staff:t.is_staff,is_active:t.is_active,is_employee:this.is_Employee},contacts:{email:t.email,UserMobile:t.UserMobile,userAddress:t.userAddress},settings:{isDeleted:this.is_delete,EntryDate:t.EntryDate,joinedDate:t.joinedDate}})}getAllBranches(t,i){this.atlasService.getAllBranch(t,i).subscribe(s=>{this.AllBranches=s},s=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0641\u0631\u0648\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}onChangeActive(){console.log(this.form.value)}onSave(){console.log("===***Press Save button***==="),this.form.valid&&this.dialogRef.close({event:this.action,data:this.form.value,empPic:this.CusImageToUpload})}close(){this.action="Cancel",console.log("===***Press Close button***==="),this.dialogRef.close({event:this.action})}}b.\u0275fac=function(t){return new(t||b)(e.Y36(g.so),e.Y36(g.WI),e.Y36(u.Z),e.Y36(c.C),e.Y36(h.ux),e.Y36(p.QS))},b.\u0275cmp=e.Xpm({type:b,selectors:[["app-employee-dialog"]],decls:135,vars:81,consts:[["mat-dialog-title",""],[4,"ngIf"],["mat-dialog-content",""],[1,"user-form",3,"formGroup"],[1,"vertical-tabs","tab-content-wrapped"],[3,"label"],["fxLayout","column",1,"form-field-outer"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],[1,"w-50"],["matInput","","formControlName","username","required",""],["class","w-45",4,"ngIf"],["matInput","","formControlName","first_name","required",""],[1,"w-45"],["matInput","","formControlName","last_name","required",""],["formControlName","gender"],["value","M","labelPosition","after"],["value","F","labelPosition","after"],["matInput","","formControlName","UserBirthDate",3,"matDatepicker"],["matSuffix","",3,"for"],["birthday",""],[1,"p-2"],[2,"width","150px","height","200px",3,"src"],["formControlName","userPicture","name","userPicture","id","EmpPicupload","type","file","accept","image/*",1,"user-img",3,"change"],["formGroupName","work",3,"label"],["fxFlex","100","fxFlex.gt-sm","49.8",1,"px-1"],[1,"w-100"],["formControlName","branch_KeyField","id","emp_branchContOpSel","required","",3,"placeholder"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","userJobName"],["formControlName","is_superuser"],["formControlName","is_staff"],["formControlName","is_active",3,"change"],["formControlName","is_employee"],["formGroupName","contacts",3,"label"],["matInput","","formControlName","email"],["matInput","","formControlName","UserMobile"],["matInput","","formControlName","userAddress"],["formGroupName","social",3,"label"],["matInput","","formControlName","userFacebook"],["matInput","","formControlName","userTwitter"],["matInput","","formControlName","userGoogle"],["formGroupName","settings",3,"label"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],["matInput","","formControlName","password","required","",3,"type"],["matSuffix","",3,"click"],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"h1",0),e.YNc(1,Q,3,3,"span",1),e.YNc(2,j,3,3,"span",1),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2)(6,"form",3)(7,"mat-tab-group",4)(8,"mat-tab",5),e.ALo(9,"translate"),e.TgZ(10,"div",6)(11,"div",7)(12,"mat-form-field",8)(13,"mat-label")(14,"mat-icon"),e._uU(15,"person"),e.qZA(),e._uU(16),e.ALo(17,"translate"),e.qZA(),e._UZ(18,"input",9),e.YNc(19,K,2,0,"mat-error",1),e.YNc(20,G,2,0,"mat-error",1),e.qZA(),e.YNc(21,X,11,7,"mat-form-field",10),e.qZA(),e.TgZ(22,"div",7)(23,"mat-form-field",8)(24,"mat-label")(25,"mat-icon"),e._uU(26,"person"),e.qZA(),e._uU(27),e.ALo(28,"translate"),e.qZA(),e._UZ(29,"input",11),e.YNc(30,z,2,0,"mat-error",1),e.qZA(),e.TgZ(31,"mat-form-field",12)(32,"mat-label")(33,"mat-icon"),e._uU(34,"person"),e.qZA(),e._uU(35),e.ALo(36,"translate"),e.qZA(),e._UZ(37,"input",13),e.YNc(38,V,2,0,"mat-error",1),e.qZA()(),e.TgZ(39,"div",7)(40,"mat-radio-group",14)(41,"mat-radio-button",15),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"mat-radio-button",16),e._uU(45),e.ALo(46,"translate"),e.qZA()(),e.TgZ(47,"mat-form-field",12)(48,"mat-label"),e._uU(49),e.ALo(50,"translate"),e.qZA(),e._UZ(51,"input",17)(52,"mat-datepicker-toggle",18)(53,"mat-datepicker",null,19),e.qZA()(),e.TgZ(55,"div",20),e._UZ(56,"img",21),e.TgZ(57,"input",22),e.NdJ("change",function(r){return i.handelEmpImgInput(r.target.files)}),e.qZA()()()(),e.TgZ(58,"mat-tab",23),e.ALo(59,"translate"),e.TgZ(60,"div",6)(61,"div",7)(62,"div",24)(63,"mat-form-field",25)(64,"mat-label"),e._uU(65),e.ALo(66,"translate"),e.qZA(),e.TgZ(67,"mat-select",26),e.ALo(68,"translate"),e.TgZ(69,"mat-option",27),e._uU(70,"-"),e.qZA(),e.YNc(71,ee,2,2,"mat-option",28),e.qZA()()(),e.TgZ(72,"div",24)(73,"mat-form-field",25)(74,"mat-label"),e._uU(75,"Job"),e.qZA(),e._UZ(76,"input",29),e.qZA()()(),e.TgZ(77,"div",7)(78,"mat-checkbox",30),e._uU(79),e.ALo(80,"translate"),e.qZA(),e.TgZ(81,"mat-checkbox",31),e._uU(82),e.ALo(83,"translate"),e.qZA()(),e.TgZ(84,"div",7)(85,"mat-checkbox",32),e.NdJ("change",function(){return i.onChangeActive()}),e._uU(86),e.ALo(87,"translate"),e.qZA(),e.TgZ(88,"mat-checkbox",33),e._uU(89),e.ALo(90,"translate"),e.qZA()()()(),e.TgZ(91,"mat-tab",34),e.ALo(92,"translate"),e.TgZ(93,"div",6)(94,"mat-form-field",25)(95,"mat-label"),e._uU(96),e.ALo(97,"translate"),e.qZA(),e._UZ(98,"input",35),e.qZA(),e.TgZ(99,"mat-form-field",25)(100,"mat-label"),e._uU(101),e.ALo(102,"translate"),e.qZA(),e._UZ(103,"input",36),e.qZA(),e.TgZ(104,"mat-form-field",25)(105,"mat-label"),e._uU(106),e.ALo(107,"translate"),e.qZA(),e._UZ(108,"input",37),e.qZA()()(),e.TgZ(109,"mat-tab",38),e.ALo(110,"translate"),e.TgZ(111,"div",6)(112,"mat-form-field",25)(113,"mat-label"),e._uU(114,"Facebook"),e.qZA(),e._UZ(115,"input",39),e.qZA(),e.TgZ(116,"mat-form-field",25)(117,"mat-label"),e._uU(118,"Twitter"),e.qZA(),e._UZ(119,"input",40),e.qZA(),e.TgZ(120,"mat-form-field",25)(121,"mat-label"),e._uU(122,"Google"),e.qZA(),e._UZ(123,"input",41),e.qZA()()(),e.TgZ(124,"mat-tab",42),e.ALo(125,"translate"),e.TgZ(126,"div",6),e.YNc(127,te,7,7,"p",1),e.YNc(128,ie,6,4,"p",1),e.qZA()()()()(),e.TgZ(129,"div",43)(130,"div",7),e.YNc(131,se,3,4,"button",44),e.TgZ(132,"button",45),e.NdJ("click",function(){return i.close()}),e._uU(133),e.ALo(134,"translate"),e.qZA()()()),2&t){const s=e.MAs(54);e.xp6(1),e.Q6J("ngIf",!i.user.id),e.xp6(1),e.Q6J("ngIf",i.user.id),e.xp6(1),e.hij(" ",e.lcZ(4,37,"HTML.EMPLOYEE"),""),e.xp6(3),e.Q6J("formGroup",i.form),e.xp6(2),e.s9C("label",e.lcZ(9,39,"HTML.TAB_BASIC")),e.xp6(8),e.hij(" ",e.lcZ(17,41,"HTML.USERNAME"),""),e.xp6(3),e.Q6J("ngIf",null==i.form.controls.username.errors?null:i.form.controls.username.errors.required),e.xp6(1),e.Q6J("ngIf",i.form.controls.username.hasError("minlength")),e.xp6(1),e.Q6J("ngIf",!i.user.id),e.xp6(6),e.hij(" ",e.lcZ(28,43,"HTML.FIRST_NAME"),""),e.xp6(3),e.Q6J("ngIf",null==i.form.controls.first_name.errors?null:i.form.controls.first_name.errors.required),e.xp6(5),e.hij(" ",e.lcZ(36,45,"HTML.LAST_NAME"),""),e.xp6(3),e.Q6J("ngIf",null==i.form.controls.last_name.errors?null:i.form.controls.last_name.errors.required),e.xp6(4),e.Oqu(e.lcZ(43,47,"HTML.MALE")),e.xp6(3),e.Oqu(e.lcZ(46,49,"HTML.FEMALE")),e.xp6(4),e.Oqu(e.lcZ(50,51,"HTML.BIRTH_DATE")),e.xp6(2),e.Q6J("matDatepicker",s),e.xp6(1),e.Q6J("for",s),e.xp6(4),e.Q6J("src",i.defaultCusImage,e.LSH),e.xp6(2),e.s9C("label",e.lcZ(59,53,"HTML.TAB_WORK")),e.xp6(7),e.hij(" ",e.lcZ(66,55,"HTML.BRANCH"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(68,57,"HTML.BRANCH")),e.xp6(4),e.Q6J("ngForOf",i.AllBranches),e.xp6(8),e.Oqu(e.lcZ(80,59,"HTML.IsSUPERUSER")),e.xp6(3),e.Oqu(e.lcZ(83,61,"HTML.IsSTAFF")),e.xp6(4),e.Oqu(e.lcZ(87,63,"HTML.ACTIVE")),e.xp6(3),e.Oqu(e.lcZ(90,65,"HTML.IsEMPLOYEE")),e.xp6(2),e.s9C("label",e.lcZ(92,67,"HTML.TAB_CONTACTS")),e.xp6(5),e.Oqu(e.lcZ(97,69,"HTML.EMAIL")),e.xp6(5),e.Oqu(e.lcZ(102,71,"HTML.MOBILE")),e.xp6(5),e.Oqu(e.lcZ(107,73,"HTML.ADDRESS")),e.xp6(3),e.s9C("label",e.lcZ(110,75,"HTML.TAB_SOCIAL_LIFE")),e.xp6(15),e.s9C("label",e.lcZ(125,77,"HTML.TAB_SETTINGS")),e.xp6(3),e.Q6J("ngIf",i.user.id),e.xp6(1),e.Q6J("ngIf",i.user.id),e.xp6(3),e.Q6J("ngIf",i.can("change_employee")),e.xp6(2),e.Oqu(e.lcZ(134,79,"BTN.CANCEL"))}},dependencies:[_.sg,_.O5,p._Y,p.Fj,p.JJ,p.JL,p.Q7,p.sg,p.u,p.x0,a.xw,a.Wh,a.yH,n.ey,E.lW,k.oG,D.Mq,D.hl,D.nW,g.ZT,g.uh,g.xY,g.H8,M.Hw,S.Nt,v.KE,v.hX,v.TO,v.R9,q.VQ,q.U0,I.gD,F.uX,F.SP,_.uU,L.X$],styles:[".user-form[_ngcontent-%COMP%]   .form-field-outer[_ngcontent-%COMP%]{width:480px}.user-form[_ngcontent-%COMP%]   .mat-mdc-radio-button[_ngcontent-%COMP%]{margin-right:12px}"]});var ae=l(2887),re=l(7288),le=l(3705),O=l(3546),B=l(4850),ce=l(266);function ue(o,t){if(1&o&&(e.TgZ(0,"mat-option",7),e._uU(1),e.qZA()),2&o){const i=t.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.BRAArbName," ")}}function me(o,t){if(1&o&&(e.TgZ(0,"mat-option",7),e._uU(1),e.qZA()),2&o){const i=t.$implicit;e.Q6J("value",i.id),e.xp6(1),e.hij(" ",i.BUIName," ")}}function pe(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.onSave())}),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()}if(2&o){const i=e.oxw();e.Q6J("disabled",!i.dataForm.valid),e.xp6(2),e.Oqu(e.lcZ(3,2,"BTN.SAVE"))}}function de(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(i);const r=e.oxw().$implicit,d=e.oxw();return e.KtG(d.remove(r.id))}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA()()}2&o&&e.s9C("matTooltip",e.lcZ(1,1,"BTN.REMOVE"))}function _e(o,t){if(1&o&&(e.TgZ(0,"div",20)(1,"div",21),e._uU(2),e.qZA(),e.TgZ(3,"div",21),e._uU(4),e.qZA(),e.TgZ(5,"div",21)(6,"div",22),e.YNc(7,de,4,3,"button",23),e.qZA()()()),2&o){const i=t.$implicit,s=e.oxw();e.xp6(2),e.Oqu(i.branch_Name),e.xp6(2),e.hij("",i.build_Name," "),e.xp6(3),e.Q6J("ngIf",s.can("delete_emp_security_onebuilding"))}}class y{constructor(t,i,s,r,d,U,ze,Ve,et){this.dialogRef=t,this.user=i,this.atlasService=s,this.unitsService=r,this.translateService=d,this.localStore=U,this.dialog=ze,this.snackBar=Ve,this.fb=et,this.passwordHide=!0,this.curCOMId=f.N.comid,this.userPerm=[],this.AllBranches=[],this.AllBuilding=[]}ngOnInit(){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.dataForm=this.fb.group({branch_KeyField:[null,p.kI.required],build_KeyField:[null,p.kI.required]}),this.Builds=new re.j,this.curPeriority=this.user.periorty,this.action="Patch",this.getAllBranches(this.curCOMId,this.curPeriority),this.getEmpBuilds(),this.prepareMsgLanguage()}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getEmpBuilds(){this.empBuildings=null,this.unitsService.getAllBuildingForUser(this.curCOMId,this.curPeriority,this.user.id).subscribe(t=>this.empBuildings=t)}getAllBranches(t,i){this.atlasService.getAllBranch(t,i).subscribe(s=>{this.AllBranches=s},s=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0641\u0631\u0648\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getBuildings(t){this.getBuildingPerBranch(this.curCOMId,this.curPeriority,t.value)}getBuildingPerBranch(t,i,s){this.unitsService.getBuildingsPerBranch(t,i,s).subscribe(r=>{this.AllBuilding=r},r=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0639\u0642\u0627\u0631\u0627\u062a \u0644\u0644\u0641\u0631\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}mapFormValue_toTable(){this.Builds.user_KeyField=this.user.id,this.Builds.build_KeyField=this.dataForm.value.build_KeyField}onSave(){this.mapFormValue_toTable(),this.unitsService.addBuildForEmployee(this.Builds).subscribe(()=>{this.snackBar.open(this.dataSavedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getEmpBuilds()})}close(){this.action="Cancel",console.log("===***Press Close button***==="),this.dialogRef.close({event:this.action})}remove(t){this.dialog.open(ae.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(s=>{s&&this.unitsService.deleteBuildingForUser(t).subscribe(()=>{this.snackBar.open(this.deletedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getEmpBuilds()})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.DataSaved").subscribe(t=>{this.dataSavedMsg=t}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(t=>{this.askToDeletedMsg=t}),this.translateService.get("MESSAGE.DELETED").subscribe(t=>{this.deletedMsg=t}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(t=>{this.deletedTitleMsg=t})}}y.\u0275fac=function(t){return new(t||y)(e.Y36(g.so),e.Y36(g.WI),e.Y36(u.Z),e.Y36(le.X),e.Y36(L.sK),e.Y36(c.C),e.Y36(g.uw),e.Y36(h.ux),e.Y36(p.QS))},y.\u0275cmp=e.Xpm({type:y,selectors:[["app-emp-builds-dialog"]],decls:50,vars:29,consts:[["autocomplete","off",3,"formGroup"],["mat-dialog-content",""],["fxLayout","row wrap"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["fxFlex","100","fxFlex.gt-sm","49.8",1,"px-1"],["appearance","outline",1,"w-100"],["formControlName","branch_KeyField","id","branchContOpSel",3,"placeholder","selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["formControlName","build_KeyField","id","build_OneOpSel",3,"placeholder"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],[1,"p-2"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","warn","class","mx-1",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","warn",1,"mx-1",3,"matTooltip","click"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"mat-select",6),e.NdJ("selectionChange",function(r){return i.getBuildings(r)}),e.ALo(10,"translate"),e.TgZ(11,"mat-option",7),e._uU(12,"-"),e.qZA(),e.YNc(13,ue,2,2,"mat-option",8),e.qZA()()(),e.TgZ(14,"div",4)(15,"mat-form-field",5)(16,"mat-label"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"mat-select",9),e.ALo(20,"translate"),e.TgZ(21,"mat-option",7),e._uU(22,"-"),e.qZA(),e.YNc(23,me,2,2,"mat-option",8),e.qZA()()()()()(),e.TgZ(24,"div",10)(25,"div",3),e.YNc(26,pe,4,4,"button",11),e.TgZ(27,"button",12),e.NdJ("click",function(){return i.close()}),e._uU(28),e.ALo(29,"translate"),e.qZA()()(),e._UZ(30,"mat-divider"),e.TgZ(31,"div",13)(32,"mat-card")(33,"div",14)(34,"h2"),e._uU(35),e.ALo(36,"translate"),e.qZA()(),e._UZ(37,"mat-divider"),e.TgZ(38,"div",15)(39,"div",16)(40,"div",17)(41,"h2"),e._uU(42),e.ALo(43,"translate"),e.qZA()(),e.TgZ(44,"div",17)(45,"h2"),e._uU(46),e.ALo(47,"translate"),e.qZA()(),e._UZ(48,"div",17),e.qZA(),e.YNc(49,_e,8,3,"div",18),e.qZA()()()()),2&t&&(e.Q6J("formGroup",i.dataForm),e.xp6(7),e.hij(" ",e.lcZ(8,13,"HTML.BRANCH"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(10,15,"HTML.BRANCH")),e.xp6(4),e.Q6J("ngForOf",i.AllBranches),e.xp6(4),e.hij(" ",e.lcZ(18,17,"HTML.BUILDING"),""),e.xp6(2),e.s9C("placeholder",e.lcZ(20,19,"HTML.BUILDING")),e.xp6(4),e.Q6J("ngForOf",i.AllBuilding),e.xp6(3),e.Q6J("ngIf",i.can("add_emp_security_onebuilding")),e.xp6(2),e.Oqu(e.lcZ(29,21,"BTN.CANCEL")),e.xp6(7),e.Oqu(e.lcZ(36,23,"HTML.EmpBuildings")),e.xp6(7),e.hij(" ",e.lcZ(43,25,"HTML.BRANCH")," "),e.xp6(4),e.hij(" ",e.lcZ(47,27,"HTML.BUILDING")," "),e.xp6(3),e.Q6J("ngForOf",i.empBuildings))},dependencies:[_.sg,_.O5,p._Y,p.JJ,p.JL,p.sg,p.u,a.xw,a.Wh,a.yH,n.ey,E.lW,E.nh,O.a8,g.xY,g.H8,M.Hw,v.KE,v.hX,B.d,I.gD,ce.gM,L.X$],styles:[".user-form[_ngcontent-%COMP%]   .form-field-outer[_ngcontent-%COMP%]{width:680px}.user-form[_ngcontent-%COMP%]   .mat-mdc-radio-button[_ngcontent-%COMP%]{margin-right:12px}.auth[_ngcontent-%COMP%]{white-space:nowrap;padding:7px 14px;font-weight:500}"]});var ge=l(3221),fe=l(5783),he=l(1182),J=l(9132),xe=l(7465),w=l(4333),H=l(811),P=l(8255),Ze=l(1572),Te=l(455),ve=l(1419);function Ae(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"mat-button-toggle",16),e.NdJ("click",function(){e.CHM(i);const r=e.oxw();return e.KtG(r.openUserDialog(null))}),e.TgZ(1,"mat-icon"),e._uU(2,"person_add"),e.qZA()()}}function be(o,t){if(1&o&&(e.TgZ(0,"h3",39),e._uU(1),e.qZA()),2&o){const i=e.oxw().$implicit;e.xp6(1),e.AsE("",i.first_name," ",i.last_name,"")}}function ye(o,t){if(1&o&&(e.TgZ(0,"h3",39),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const i=e.oxw().$implicit;e.xp6(1),e.lnq("",i.first_name," ",i.last_name," (",e.lcZ(2,3,"HTML.BLOCKED"),")")}}function Ce(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const r=e.oxw().$implicit,d=e.oxw(2);return e.KtG(d.openUserDialog(r))}),e.TgZ(1,"mat-icon"),e._uU(2,"mode_edit"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.EDIT")))}function Ue(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const r=e.oxw().$implicit,d=e.oxw(2);return e.KtG(d.deleteUser(r))}),e.TgZ(1,"mat-icon"),e._uU(2,"delete"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.REMOVE")))}function Ee(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const r=e.oxw().$implicit,d=e.oxw(2);return e.KtG(d.openBuildingDialog(r))}),e.TgZ(1,"mat-icon"),e._uU(2,"business"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.Building")))}function Le(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const r=e.oxw().$implicit,d=e.oxw(2);return e.KtG(d.openUserPermission(r.id))}),e.TgZ(1,"mat-icon"),e._uU(2,"security"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.Security")))}function Ne(o,t){if(1&o&&e._UZ(0,"img",41),2&o){const i=e.oxw().$implicit;e.ekj("blocked",!i.is_active),e.Q6J("src",i.userPicture,e.LSH)}}function De(o,t){if(1&o&&e._UZ(0,"img",42),2&o){const i=e.oxw().$implicit;e.ekj("blocked",!i.is_active)}}function Me(o,t){1&o&&(e.TgZ(0,"mat-icon",43),e._uU(1,"block"),e.qZA())}function we(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",19)(1,"mat-card")(2,"div",20),e.YNc(3,be,2,2,"h3",21),e.YNc(4,ye,3,5,"h3",21),e.TgZ(5,"button",22,23)(7,"mat-icon"),e._uU(8,"more_vert"),e.qZA()()(),e.TgZ(9,"mat-menu",24,25)(11,"span",26),e.NdJ("mouseleave",function(){e.CHM(i);const r=e.MAs(6);return e.KtG(r.closeMenu())}),e.YNc(12,Ce,6,3,"button",27),e.YNc(13,Ue,6,3,"button",27),e._UZ(14,"mat-divider"),e.YNc(15,Ee,6,3,"button",27),e.YNc(16,Le,6,3,"button",27),e.qZA()(),e.TgZ(17,"div",28)(18,"div",29)(19,"div",30),e.YNc(20,Ne,1,3,"img",31),e.YNc(21,De,1,2,"img",32),e.YNc(22,Me,2,0,"mat-icon",33),e.qZA(),e.TgZ(23,"div",34)(24,"mat-slide-toggle",35),e.NdJ("change",function(){const d=e.CHM(i).$implicit;return e.KtG(d.is_active=!d.is_active)}),e.qZA()()(),e.TgZ(25,"div",36)(26,"p",37)(27,"mat-icon",38),e._uU(28,"card_membership"),e.qZA(),e.TgZ(29,"span"),e._uU(30),e.qZA()(),e.TgZ(31,"p",37)(32,"mat-icon",38),e._uU(33,"mail_outline"),e.qZA(),e.TgZ(34,"span"),e._uU(35),e.qZA()(),e.TgZ(36,"p",37)(37,"mat-icon",38),e._uU(38,"call"),e.qZA(),e.TgZ(39,"span"),e._uU(40),e.qZA()(),e.TgZ(41,"p",37)(42,"mat-icon",38),e._uU(43,"location_on"),e.qZA(),e.TgZ(44,"span"),e._uU(45),e.qZA()(),e.TgZ(46,"p",37)(47,"mat-icon",38),e._uU(48,"date_range"),e.qZA(),e.TgZ(49,"span"),e._uU(50),e.ALo(51,"translate"),e.qZA()()()()()()}if(2&o){const i=t.$implicit,s=e.MAs(10),r=e.oxw(2);e.xp6(3),e.Q6J("ngIf",i.is_active),e.xp6(1),e.Q6J("ngIf",!i.is_active),e.xp6(1),e.Q6J("matMenuTriggerFor",s),e.xp6(7),e.Q6J("ngIf",r.can("view_oneemployee")),e.xp6(1),e.Q6J("ngIf",r.can("delete_employee")),e.xp6(2),e.Q6J("ngIf",r.can("view_emp_securitybuildings")),e.xp6(1),e.Q6J("ngIf",r.can("view_emp_securitypermissions")),e.xp6(4),e.Q6J("ngIf",i.userPicture),e.xp6(1),e.Q6J("ngIf",!i.userPicture),e.xp6(1),e.Q6J("ngIf",!i.is_active),e.xp6(2),e.Q6J("checked",i.is_active),e.xp6(1),e.ekj("blocked",!i.is_active),e.xp6(5),e.Oqu(i.userJobName),e.xp6(5),e.Oqu(i.email),e.xp6(5),e.Oqu(i.UserMobile),e.xp6(5),e.Oqu(i.userAddress),e.xp6(5),e.AsE("",e.lcZ(51,19,"HTML.LastSeen")," (",i.joinDate,")")}}const Y=function(o,t){return{itemsPerPage:o,currentPage:t}};function Pe(o,t){if(1&o&&(e.TgZ(0,"div",17),e.YNc(1,we,52,21,"div",18),e.ALo(2,"paginate"),e.ALo(3,"EmpSearchPipe"),e.qZA()),2&o){const i=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,e.xi3(3,4,i.users,i.searchText),e.WLB(7,Y,i.count,i.page)))}}function Se(o,t){if(1&o&&(e.TgZ(0,"h3",39),e._uU(1),e.qZA()),2&o){const i=e.oxw().$implicit;e.xp6(1),e.AsE("",i.first_name," ",i.last_name,"")}}function qe(o,t){1&o&&(e.TgZ(0,"h3",39),e._uU(1,"User blocked"),e.qZA())}function Ie(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const r=e.oxw().$implicit,d=e.oxw(2);return e.KtG(d.openUserDialog(r))}),e.TgZ(1,"mat-icon"),e._uU(2,"mode_edit"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.EDIT")))}function Fe(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const r=e.oxw().$implicit,d=e.oxw(2);return e.KtG(d.deleteUser(r))}),e.TgZ(1,"mat-icon"),e._uU(2,"delete"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.REMOVE")))}function Oe(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const r=e.oxw().$implicit,d=e.oxw(2);return e.KtG(d.openBuildingDialog(r))}),e.TgZ(1,"mat-icon"),e._uU(2,"business"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.Building")))}function Be(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(i);const r=e.oxw().$implicit,d=e.oxw(2);return e.KtG(d.openUserPermission(r.id))}),e.TgZ(1,"mat-icon"),e._uU(2,"security"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"BTN.Security")))}function Je(o,t){if(1&o&&e._UZ(0,"img",41),2&o){const i=e.oxw().$implicit;e.ekj("blocked",1==i.RowDelete),e.Q6J("src",i.userPicture,e.LSH)}}function He(o,t){if(1&o&&e._UZ(0,"img",52),2&o){const i=e.oxw().$implicit;e.ekj("blocked",1==i.RowDelete)}}function Ye(o,t){1&o&&(e.TgZ(0,"mat-icon",43),e._uU(1,"block"),e.qZA())}function Re(o,t){1&o&&(e.TgZ(0,"mat-icon",38),e._uU(1,"person_outline"),e.qZA())}function ke(o,t){1&o&&(e.TgZ(0,"mat-icon",38),e._uU(1,"person"),e.qZA())}function Qe(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",45)(1,"mat-card")(2,"div",20),e.YNc(3,Se,2,2,"h3",21),e.YNc(4,qe,2,0,"h3",21),e.TgZ(5,"button",22,23)(7,"mat-icon"),e._uU(8,"more_vert"),e.qZA()()(),e.TgZ(9,"mat-menu",24,25)(11,"span",26),e.NdJ("mouseleave",function(){e.CHM(i);const r=e.MAs(6);return e.KtG(r.closeMenu())}),e.YNc(12,Ie,6,3,"button",27),e.YNc(13,Fe,6,3,"button",27),e._UZ(14,"mat-divider"),e.YNc(15,Oe,6,3,"button",27),e.YNc(16,Be,6,3,"button",27),e.qZA()(),e.TgZ(17,"div",28)(18,"div",46)(19,"div",30),e.YNc(20,Je,1,3,"img",31),e.YNc(21,He,1,2,"img",47),e.YNc(22,Ye,2,0,"mat-icon",33),e.qZA(),e.TgZ(23,"div",34)(24,"mat-slide-toggle",35),e.NdJ("change",function(){const d=e.CHM(i).$implicit;return e.KtG(d.RowDelete=!d.RowDelete)}),e.qZA()()(),e.TgZ(25,"div",48)(26,"div",49)(27,"p",37)(28,"mat-icon",38),e._uU(29,"card_membership"),e.qZA(),e.TgZ(30,"span"),e._uU(31),e.qZA()()(),e.TgZ(32,"div",49)(33,"p",37)(34,"mat-icon",38),e._uU(35,"mail_outline"),e.qZA(),e.TgZ(36,"span"),e._uU(37),e.qZA()(),e.TgZ(38,"p",37)(39,"mat-icon",38),e._uU(40,"call"),e.qZA(),e.TgZ(41,"span"),e._uU(42),e.qZA()(),e.TgZ(43,"p",37)(44,"mat-icon",38),e._uU(45,"location_on"),e.qZA(),e.TgZ(46,"span"),e._uU(47),e.qZA()()(),e.TgZ(48,"div",50)(49,"p",37)(50,"mat-icon",38),e._uU(51,"event_available"),e.qZA(),e.TgZ(52,"span"),e._uU(53),e.ALo(54,"date"),e.qZA()(),e.TgZ(55,"p",37)(56,"mat-icon",38),e._uU(57,"date_range"),e.qZA(),e.TgZ(58,"span"),e._uU(59),e.ALo(60,"date"),e.qZA()(),e.TgZ(61,"p",37),e.YNc(62,Re,2,0,"mat-icon",51),e.YNc(63,ke,2,0,"mat-icon",51),e.TgZ(64,"span"),e._uU(65),e.qZA()()()()()()()}if(2&o){const i=t.$implicit,s=e.MAs(10),r=e.oxw(2);e.xp6(3),e.Q6J("ngIf",0==i.RowDelete),e.xp6(1),e.Q6J("ngIf",1==i.RowDelete),e.xp6(1),e.Q6J("matMenuTriggerFor",s),e.xp6(7),e.Q6J("ngIf",r.can("view_oneemployee")),e.xp6(1),e.Q6J("ngIf",r.can("delete_employee")),e.xp6(2),e.Q6J("ngIf",r.can("view_emp_securitybuildings")),e.xp6(1),e.Q6J("ngIf",r.can("view_emp_securitypermissions")),e.xp6(4),e.Q6J("ngIf",i.userPicture),e.xp6(1),e.Q6J("ngIf",!i.userPicture),e.xp6(1),e.Q6J("ngIf",1==i.RowDelete),e.xp6(2),e.Q6J("checked",1==i.RowDelete),e.xp6(1),e.ekj("blocked",1==i.RowDelete),e.xp6(6),e.Oqu(i.userJobName),e.xp6(6),e.Oqu(i.email),e.xp6(5),e.Oqu(i.UserMobile),e.xp6(5),e.Oqu(i.userAddress),e.xp6(6),e.hij("Registration ",e.xi3(54,22,i.EntryDate,"dd MMMM, yyyy 'at' HH:mm"),""),e.xp6(6),e.hij("Joined ",e.xi3(60,25,i.joinedDate,"dd MMMM, yyyy 'at' HH:mm"),""),e.xp6(3),e.Q6J("ngIf",1==i.RowDelete),e.xp6(1),e.Q6J("ngIf",0==i.RowDelete),e.xp6(2),e.Oqu(1==i.RowDelete?"Blocked":"Active")}}function je(o,t){if(1&o&&(e.TgZ(0,"div",17),e.YNc(1,Qe,66,28,"div",44),e.ALo(2,"paginate"),e.ALo(3,"EmpSearchPipe"),e.qZA()),2&o){const i=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,e.xi3(3,4,i.users,i.searchText),e.WLB(7,Y,i.count,i.page)))}}function Ke(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",17)(1,"div",45)(2,"mat-card",53)(3,"pagination-controls",54),e.NdJ("pageChange",function(r){e.CHM(i);const d=e.oxw();return e.KtG(d.onPageChanged(r))}),e.qZA()()()()}}function Ge(o,t){1&o&&(e.TgZ(0,"div",55),e._UZ(1,"mat-spinner",56),e.qZA())}class C{constructor(t,i,s,r,d,U){this.appSettings=t,this.dialog=i,this.router=s,this.global=r,this.localStore=d,this.usersService=U,this.count=9,this.curCOMId=f.N.comid,this.account=new fe.n,this.userPerm=[],this.employeesForDisplay={id:void 0,username:void 0,password:void 0,UserCode:void 0,first_name:void 0,last_name:void 0,UserBirthDate:void 0,EntryDate:void 0,joinedDate:void 0,joinDate:void 0,UserMobile:void 0,email:void 0,is_superuser:void 0,is_staff:void 0,is_active:void 0,is_employee:void 0,is_teacher:void 0,periorty:void 0,COMId:void 0,branch_KeyField:void 0,userPicture:void 0,gender:void 0,RowDelete:void 0,LoginFrom:void 0,userJobName:void 0,userFacebook:void 0,userTwitter:void 0,userGoogle:void 0,userAddress:void 0,is_from_customer_table:void 0,customer_KeyField:void 0},this.settings=this.appSettings.settings}ngOnInit(){if(this.userSUb=this.global.user.subscribe(t=>{this.account=t}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let t=0;t<this.curUserPermissions.length;t++)this.userPerm[t]=this.curUserPermissions[t].codename;this.getUsers()}else this.router.navigate(["/sign-in"])}can(t){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(t))}getUsers(){this.users=null,this.curUserData.is_superuser?this.usersService.getAllStaff().subscribe(t=>{this.users=t}):this.usersService.getStaffPerBranch(this.curCOMId,this.account.periorty,this.curUserData.branch_KeyField).subscribe(t=>{this.users=t})}addUser(t,i){console.log("====inside addUser== ==="),this.usersService.addEmployee(t,i).subscribe(s=>this.getUsers())}updateUser(t,i){console.log("====inside updateTenant====="),console.log(t),this.usersService.editEmployee(t,i).subscribe(s=>{console.log("/*-/*-/*-"+s.is_active+"-*/-*/-*/"),this.getUsers()})}deleteUser(t){this.usersService.deleteOneUser(t.id).subscribe(i=>this.getUsers())}onPageChanged(t){this.page=t,this.getUsers(),window.scrollTo(0,0)}openUserDialog(t){this.dialog.open(b,{data:t}).afterClosed().subscribe(s=>{"Cancel"==s.event||("Patch"==s.event?(this.mapFormvalue_to_EmpClass(s.data,"Patch"),this.updateUser(this.employeesForDisplay,s.empPic)):"Post"==s.event&&(this.mapFormvalue_to_EmpClass(s.data,"Post"),this.addUser(this.employeesForDisplay,s.empPic)))})}openBuildingDialog(t){this.dialog.open(y,{data:t,panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr"}).afterClosed().subscribe(s=>{})}openSecurityDialog(t){this.dialog.open(ge.y,{data:t}).afterClosed().subscribe(s=>{})}openUserPermission(t){this.router.navigate(["/settings/permissions-all/"+t+"/"])}toDateString(t){return t.getFullYear().toString()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)+"T"+t.toTimeString().slice(0,5)}formatDate(t){const i=new Date;let s=""+(i.getMonth()+1),r=""+i.getDate();const d=i.getFullYear();return s.length<2&&(s="0"+s),r.length<2&&(r="0"+r),[d,s,r].join("-")}mapFormvalue_to_EmpClass(t,i){console.log(t),console.log("=================formValue==========================");const s=new _.uU("en-GB").transform(t.UserBirthDate,"dd/MM/yyyy");this.is_Employee=t.work.is_employee?"T":"F",this.empDeleted=t.settings.isDeleted?1:0,this.employeesForDisplay.id=t.id,this.employeesForDisplay.username=t.username,this.employeesForDisplay.password=t.password,this.employeesForDisplay.UserCode=t.UserCode,this.employeesForDisplay.first_name=t.first_name,this.employeesForDisplay.last_name=t.last_name,this.employeesForDisplay.userPicture=t.userPicture,this.employeesForDisplay.gender=t.gender,null!=t.UserBirthDate&&(this.employeesForDisplay.UserBirthDate=s),this.employeesForDisplay.userJobName=t.work.userJobName,this.employeesForDisplay.branch_KeyField=t.work.branch_KeyField,this.employeesForDisplay.is_superuser=t.work.is_superuser,this.employeesForDisplay.is_staff=t.work.is_staff,this.employeesForDisplay.is_active=t.work.is_active,this.employeesForDisplay.is_employee=this.is_Employee,this.employeesForDisplay.email=t.contacts.email,this.employeesForDisplay.UserMobile=t.contacts.UserMobile,this.employeesForDisplay.userAddress=t.contacts.userAddress,this.employeesForDisplay.RowDelete=this.empDeleted}}C.\u0275fac=function(t){return new(t||C)(e.Y36(he.d),e.Y36(g.uw),e.Y36(J.F0),e.Y36(xe.U),e.Y36(c.C),e.Y36(m.K))},C.\u0275cmp=e.Xpm({type:C,selectors:[["app-employee-list"]],features:[e._Bn([m.K])],decls:25,vars:11,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click",4,"ngIf"],["value","search"],[1,"user-search"],[1,"user-search-input"],["matInput","","name","search","autocomplete","off",3,"placeholder","ngModel","ngModelChange"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","grid"],["viewType","matButtonToggleGroup"],["value","grid"],["value","list"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],["value","add",3,"click"],["fxLayout","row wrap"],["fxFlex","100","fxFlex.gt-md","33.3","fxFlex.md","50","class","p-2",4,"ngFor","ngForOf"],["fxFlex","100","fxFlex.gt-md","33.3","fxFlex.md","50",1,"p-2"],["fxLayout","row","fxLayoutAlign","space-between center",1,"bg-primary"],["class","user-name",4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["menuTrigger","matMenuTrigger"],["xPosition","before","overlapTrigger","true"],["menu","matMenu"],[3,"mouseleave"],["mat-menu-item","",3,"click",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-around center",1,"user-content"],["fxFlex","30","fxLayout","column","fxLayoutAlign","center center"],[1,"user-img"],["class","transition-2",3,"src","blocked",4,"ngIf"],["src","assets/images/others/user.jpg","class","transition-2",3,"blocked",4,"ngIf"],["color","warn",4,"ngIf"],[1,"user-social"],["color","primary",3,"checked","change"],["fxFlex","70","fxLayout","column",1,"user-details","transition-2"],["fxLayout","row","fxLayoutAlign","start center"],[1,"text-muted"],[1,"user-name"],["mat-menu-item","",3,"click"],[1,"transition-2",3,"src"],["src","assets/images/others/user.jpg",1,"transition-2"],["color","warn"],["fxFlex","100","class","p-2",4,"ngFor","ngForOf"],["fxFlex","100",1,"p-2"],["fxFlex","20","fxFlex.xs","30","fxLayout","column","fxLayoutAlign","center center"],["src","assets/img/users/default-user.jpg","class","transition-2",3,"blocked",4,"ngIf"],["fxFlex","80","fxFlex.xs","70","fxLayout","row","fxLayout.xs","column",1,"user-details","transition-2"],["fxFlex","30","fxFlex.xs","100","fxLayout","column"],["fxFlex","40","fxFlex.xs","100","fxLayout","column"],["class","text-muted",4,"ngIf"],["src","assets/img/users/default-user.jpg",1,"transition-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-button-toggle-group",2,3),e.YNc(4,Ae,3,0,"mat-button-toggle",4),e.TgZ(5,"mat-button-toggle",5)(6,"mat-icon"),e._uU(7,"search"),e.qZA()()()(),e.TgZ(8,"form",6)(9,"mat-form-field",7)(10,"input",8),e.NdJ("ngModelChange",function(r){return i.searchText=r}),e.ALo(11,"translate"),e.qZA()()(),e.TgZ(12,"div",9)(13,"mat-button-toggle-group",10,11)(15,"mat-button-toggle",12)(16,"mat-icon"),e._uU(17,"view_module"),e.qZA()(),e.TgZ(18,"mat-button-toggle",13)(19,"mat-icon"),e._uU(20,"view_list"),e.qZA()()()()(),e.YNc(21,Pe,4,10,"div",14),e.YNc(22,je,4,10,"div",14),e.YNc(23,Ke,4,0,"div",14),e.YNc(24,Ge,2,0,"div",15)),2&t){const s=e.MAs(3),r=e.MAs(14);e.xp6(4),e.Q6J("ngIf",i.can("add_employee")),e.xp6(4),e.ekj("show","search"==s.value),e.xp6(2),e.s9C("placeholder",e.lcZ(11,9,"HTML.SEARCH_Employee")),e.Q6J("ngModel",i.searchText),e.xp6(11),e.Q6J("ngIf","grid"==r.value),e.xp6(1),e.Q6J("ngIf","list"==r.value),e.xp6(1),e.Q6J("ngIf",i.users),e.xp6(1),e.Q6J("ngIf",!i.users)}},dependencies:[_.sg,_.O5,p._Y,p.Fj,p.JJ,p.JL,p.On,p.F,w.LS,a.xw,a.Wh,a.yH,E.RK,H.A9,H.Yi,O.a8,M.Hw,S.Nt,v.KE,B.d,P.VK,P.OP,P.p6,Ze.Ou,Te.Rr,_.uU,w._s,L.X$,ve.mo],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}\n"],encapsulation:2});var $e=l(529),We=l(589),Xe=l(9045);const R=[{path:"",redirectTo:"employee",pathMatch:"full"},{path:"employee",component:C,pathMatch:"full",data:{breadcrumb:"Employees"}}];class A{}A.\u0275fac=function(t){return new(t||A)},A.\u0275mod=e.oAB({type:A}),A.\u0275inj=e.cJS({imports:[_.ez,$e.JF,J.Bz.forChild(R),p.u5,p.UX,w.JX,We.m,Xe.D]})},2887:(N,T,l)=>{l.d(T,{$:()=>f});var _=l(5412),m=l(4650),g=l(1576),p=l(4859),Z=l(3081);class f{constructor(e,u){this.dialogRef=e,this.data=u}ngOnInit(){}onConfirm(){this.dialogRef.close(!0)}onDismiss(){this.dialogRef.close(!1)}}f.\u0275fac=function(e){return new(e||f)(m.Y36(_.so),m.Y36(_.WI))},f.\u0275cmp=m.Xpm({type:f,selectors:[["app-confirm-dialog"]],decls:13,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,u){1&e&&(m.TgZ(0,"h1",0),m._uU(1),m.qZA(),m.TgZ(2,"div",1)(3,"p"),m._uU(4),m.qZA()(),m.TgZ(5,"div",2)(6,"div",3)(7,"button",4),m.NdJ("click",function(){return u.onDismiss()}),m._uU(8),m.ALo(9,"translate"),m.qZA(),m.TgZ(10,"button",5),m.NdJ("click",function(){return u.onConfirm()}),m._uU(11),m.ALo(12,"translate"),m.qZA()()()),2&e&&(m.xp6(1),m.Oqu(null==u.data?null:u.data.title),m.xp6(3),m.Oqu(null==u.data?null:u.data.message),m.xp6(4),m.Oqu(m.lcZ(9,4,"BTN.NO")),m.xp6(3),m.Oqu(m.lcZ(12,6,"BTN.YES")))},dependencies:[g.xw,g.Wh,p.lW,_.uh,_.xY,_.H8,Z.X$]})},1419:(N,T,l)=>{l.d(T,{DA:()=>x,JQ:()=>f,dg:()=>Z,go:()=>m,mo:()=>g});var _=l(4650);class m{transform(c,h){let a=new RegExp(h,"ig");if(c)return c.filter(n=>n.profile.name?-1!==n.profile.name.search(a):-1!==n.username.search(a))}}m.\u0275fac=function(c){return new(c||m)},m.\u0275pipe=_.Yjl({name:"UserSearchPipe",type:m,pure:!1});class g{transform(c,h){let a=new RegExp(h,"ig");if(c)return c.filter(n=>n.first_name?-1!==n.first_name.search(a):n.last_name?-1!==n.last_name.search(a):-1!==n.username.search(a))}}g.\u0275fac=function(c){return new(c||g)},g.\u0275pipe=_.Yjl({name:"EmpSearchPipe",type:g,pure:!1});class p{transform(c,h){let a=new RegExp(h,"ig");if(c)return c.filter(n=>n.ownFirstName?-1!==n.ownFirstName.search(a):-1!==n.ownLastName.search(a))}}p.\u0275fac=function(c){return new(c||p)},p.\u0275pipe=_.Yjl({name:"OwnerSearchPipe",type:p,pure:!1});class Z{transform(c,h){if(!c)return null;if(!h)return c;let a=new RegExp(h,"ig");return c?c.filter(n=>n.branch_ArbName&&-1!==n.branch_ArbName.search(a)?-1!==n.branch_ArbName.search(a):n.unit_UnitNumber&&-1!==n.unit_UnitNumber.search(a)?-1!==n.unit_UnitNumber.search(a):n.build_Name&&-1!==n.build_Name.search(a)?-1!==n.build_Name.search(a):n.customer_Name&&-1!==n.customer_Name.search(a)?-1!==n.customer_Name.search(a):n.PDOPrintedCode&&-1!==n.PDOPrintedCode.search(a)?-1!==n.PDOPrintedCode.search(a):n.contract_Code&&-1!==n.contract_Code.toString().search(a)?-1!==n.contract_Code.toString().search(a):n.contract_EjarCode?-1!==n.contract_EjarCode.toString().search(a)?-1!==n.contract_EjarCode.toString().search(a):-1!==n.build_Name.search(a):-1!=n.unit_UnitNumber.search(a)):void 0}}Z.\u0275fac=function(c){return new(c||Z)},Z.\u0275pipe=_.Yjl({name:"PayDocumentsSearchPipe",type:Z,pure:!1});class f{transform(c,h){if(!c)return null;if(!h)return c;let a=new RegExp(h,"ig");return c?c.filter(n=>n.build_Name&&-1!==n.build_Name.search(a)?-1!==n.build_Name.search(a):n.unit_UnitNumber&&-1!==n.unit_UnitNumber.search(a)?-1!==n.unit_UnitNumber.search(a):n.customer_Name&&-1!==n.customer_Name.search(a)?-1!==n.customer_Name.search(a):n.customer_Mobile&&-1!==n.customer_Mobile.search(a)?-1!==n.customer_Mobile.search(a):n.RCOCode&&-1!==n.RCOCode.toString().search(a)?-1!==n.RCOCode.toString().search(a):n.RCOEjarCode?-1!==n.RCOEjarCode.toString().search(a)?-1!==n.RCOEjarCode.toString().search(a):-1!==n.build_Name.search(a):-1!=n.unit_UnitNumber.search(a)):void 0}}f.\u0275fac=function(c){return new(c||f)},f.\u0275pipe=_.Yjl({name:"ContractSearchPipe",type:f,pure:!1});class x{transform(c,h){if(!c)return null;if(!h)return c;let a=new RegExp(h,"ig");return c?c.filter(n=>n.CUSName&&-1!==n.CUSName.search(a)?-1!==n.CUSName.search(a):n.CUSMobile&&-1!==n.CUSMobile.search(a)?-1!==n.CUSMobile.search(a):n.unit_Name&&-1!==n.unit_Name.search(a)?-1!==n.unit_Name.search(a):n.build_Name&&-1!==n.build_Name.search(a)?-1!==n.build_Name.search(a):n.job_Name&&-1!==n.job_Name.search(a)?-1!==n.job_Name.search(a):n.workplace_Name?-1!==n.workplace_Name.search(a)?-1!==n.workplace_Name.search(a):-1!==n.CUSName.search(a):-1!=n.CUSName.search(a)):void 0}}x.\u0275fac=function(c){return new(c||x)},x.\u0275pipe=_.Yjl({name:"TenantSearchPipe",type:x,pure:!1});class e{transform(c,h){let a=new RegExp(h,"ig");if(c)return c.filter(n=>n.CUSMobile?-1!==n.CUSMobile.search(a):-1!==n.CUSName.search(a))}}e.\u0275fac=function(c){return new(c||e)},e.\u0275pipe=_.Yjl({name:"TenantMobileSearchPipe",type:e,pure:!1})}}]);