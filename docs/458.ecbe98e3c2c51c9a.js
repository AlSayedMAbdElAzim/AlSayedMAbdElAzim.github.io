"use strict";(self.webpackChunkemporium=self.webpackChunkemporium||[]).push([[458],{1458:(ua,st,l)=>{l.r(st),l.d(st,{ContractsModule:()=>q,routes:()=>pt});var c=l(6895),m=l(5412),s=l(4006),lt=l(8955),S=l(2340),t=l(4650),W=l(6002),b=l(5298),at=l(3705),U=l(7009),u=l(1576),w=l(3238),_=l(4859),D=l(4144),h=l(9549),E=l(4385),f=l(3081);function ht(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"HTML.USERNAMEREQ")))}function gt(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"MESSAGE.MinLength")))}function Ct(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"HTML.EmailREQ")))}function ft(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"HTML.InvalidEmail")))}function _t(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"HTML.FirstNameREQ")))}function Tt(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"MESSAGE.MinLength")))}function Zt(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"HTML.LastNameREQ")))}function vt(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"MESSAGE.MinLength")))}function At(i,e){if(1&i&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.BRAArbName," ")}}function bt(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Mobile is required"),t.qZA())}function yt(i,e){if(1&i&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.BUIName," ")}}function St(i,e){if(1&i&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.UNTUnitNumber," ")}}function Ut(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"HTML.PasswordREQ")))}function Ot(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"MESSAGE.MinLength6")))}function xt(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"HTML.ConfirmPasswordREQ")))}function It(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"HTML.MismatchPassword")))}function Dt(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.onSave())}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA()()}if(2&i){const a=t.oxw();t.Q6J("mat-dialog-close",a.registerForm.value)("disabled",!a.registerForm.valid),t.xp6(2),t.Oqu(t.lcZ(3,3,"BTN.SAVE"))}}class N{constructor(e,a,o,n,r,d,p){this.dialogRef=e,this.data=a,this.atlasService=o,this.localStore=n,this.unitsService=r,this.snackBar=d,this.fb=p,this.curCOMId=S.N.comid,this.userPerm=[],this.AllBranches=[],this.AllBuilding=[],this.AllUnitsForBuilding=[]}ngOnInit(){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let e=0;e<this.curUserPermissions.length;e++)this.userPerm[e]=this.curUserPermissions[e].codename;this.curperiorty=this.data.periorty,this.registerForm=this.fb.group({username:["",s.kI.compose([s.kI.required,s.kI.minLength(3)])],first_name:["",s.kI.compose([s.kI.required,s.kI.minLength(2)])],last_name:["",s.kI.compose([s.kI.required,s.kI.minLength(2)])],email:["",s.kI.compose([s.kI.required,lt.L])],branch_KeyField:[null,s.kI.required],UserMobile:[null,s.kI.required],build_KeyField:[null,s.kI.required],unit_KeyField:[null,s.kI.required],password:["",s.kI.required],confirmPassword:["",s.kI.required]},{validator:(0,lt.z)("password","confirmPassword")}),this.getAllBranches(this.curCOMId,this.curperiorty)}can(e){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(e))}getAllBranches(e,a){this.atlasService.getAllBranch(e,a).subscribe(o=>{this.AllBranches=o},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0641\u0631\u0648\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getBuildings(e){this.getBuildingPerBranch(this.curCOMId,this.curperiorty,e.value)}getBuildingPerBranch(e,a,o){this.unitsService.getBuildingsPerBranch(e,a,o).subscribe(n=>{this.AllBuilding=n},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0639\u0642\u0627\u0631\u0627\u062a \u0644\u0644\u0641\u0631\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}readBuilding(e){this.unitsService.getOneBuilding(e.value).subscribe(a=>{this.getUnitsPerBuilding(this.curCOMId,this.curperiorty,e.value,"E")},a=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0639\u0642\u0627\u0631","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getUnitsPerBuilding(e,a,o,n){this.unitsService.getAllUnitsPerBuilding(e,a,o,n).subscribe(r=>{this.AllUnitsForBuilding=r},r=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0648\u062d\u062f\u0627\u062a \u0644\u0644\u0639\u0642\u0627\u0631","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}onSave(){console.log("===***Press Save button***==="),this.action="Post",this.registerForm.valid&&this.dialogRef.close({event:this.action,data:this.registerForm})}close(){console.log("===***Press Close button***==="),this.action="Cancel",this.dialogRef.close({event:this.action})}}N.\u0275fac=function(e){return new(e||N)(t.Y36(m.so),t.Y36(m.WI),t.Y36(W.Z),t.Y36(b.C),t.Y36(at.X),t.Y36(U.ux),t.Y36(s.QS))},N.\u0275cmp=t.Xpm({type:N,selectors:[["app-customers-dialog"]],decls:110,vars:81,consts:[["mat-dialog-title",""],[1,"user-form",3,"formGroup"],["mat-dialog-content",""],["fxLayout","row wrap"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["fxFlex","100","fxFlex.gt-sm","49.8",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","username","required","",3,"placeholder"],[4,"ngIf"],["matInput","","formControlName","email","required","",3,"placeholder"],["matInput","","formControlName","first_name","required","",3,"placeholder"],["matInput","","formControlName","last_name","required","",3,"placeholder"],["formControlName","branch_KeyField","id","branchContOpSel",3,"placeholder","selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","UserMobile","required",""],["formControlName","build_KeyField","id","build_OneOpSel",3,"placeholder","selectionChange"],["formControlName","unit_KeyField","id","unit_OneOpSel",3,"placeholder"],["matInput","","formControlName","password","type","password","minlength","6","required","",3,"placeholder"],["matInput","","formControlName","confirmPassword","type","password","required","",3,"placeholder"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click"]],template:function(e,a){1&e&&(t.TgZ(0,"h2",0),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"form",1)(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),t._uU(10),t.ALo(11,"translate"),t.qZA(),t._UZ(12,"input",7),t.ALo(13,"translate"),t.YNc(14,ht,3,3,"mat-error",8),t.YNc(15,gt,3,3,"mat-error",8),t.qZA()(),t.TgZ(16,"div",5)(17,"mat-form-field",6)(18,"mat-label"),t._uU(19),t.ALo(20,"translate"),t.qZA(),t._UZ(21,"input",9),t.ALo(22,"translate"),t.YNc(23,Ct,3,3,"mat-error",8),t.YNc(24,ft,3,3,"mat-error",8),t.qZA()()(),t.TgZ(25,"div",4)(26,"div",5)(27,"mat-form-field",6)(28,"mat-label"),t._uU(29),t.ALo(30,"translate"),t.qZA(),t._UZ(31,"input",10),t.ALo(32,"translate"),t.YNc(33,_t,3,3,"mat-error",8),t.YNc(34,Tt,3,3,"mat-error",8),t.qZA()(),t.TgZ(35,"div",5)(36,"mat-form-field",6)(37,"mat-label"),t._uU(38),t.ALo(39,"translate"),t.qZA(),t._UZ(40,"input",11),t.ALo(41,"translate"),t.YNc(42,Zt,3,3,"mat-error",8),t.YNc(43,vt,3,3,"mat-error",8),t.qZA()()(),t.TgZ(44,"div",4)(45,"div",5)(46,"mat-form-field",6)(47,"mat-label"),t._uU(48),t.ALo(49,"translate"),t.qZA(),t.TgZ(50,"mat-select",12),t.NdJ("selectionChange",function(n){return a.getBuildings(n)}),t.ALo(51,"translate"),t.TgZ(52,"mat-option",13),t._uU(53,"-"),t.qZA(),t.YNc(54,At,2,2,"mat-option",14),t.qZA()()(),t.TgZ(55,"div",5)(56,"mat-form-field",6)(57,"mat-label"),t._uU(58),t.ALo(59,"translate"),t.qZA(),t.TgZ(60,"mat-hint"),t._uU(61,"0505602221"),t.qZA(),t._UZ(62,"input",15),t.YNc(63,bt,2,0,"mat-error",8),t.qZA()()(),t.TgZ(64,"div",4)(65,"div",5)(66,"mat-form-field",6)(67,"mat-label"),t._uU(68),t.ALo(69,"translate"),t.qZA(),t.TgZ(70,"mat-select",16),t.NdJ("selectionChange",function(n){return a.readBuilding(n)}),t.ALo(71,"translate"),t.TgZ(72,"mat-option",13),t._uU(73,"-"),t.qZA(),t.YNc(74,yt,2,2,"mat-option",14),t.qZA()()(),t.TgZ(75,"div",5)(76,"mat-form-field",6)(77,"mat-label"),t._uU(78),t.ALo(79,"translate"),t.qZA(),t.TgZ(80,"mat-select",17),t.ALo(81,"translate"),t.TgZ(82,"mat-option",13),t._uU(83,"-"),t.qZA(),t.YNc(84,St,2,2,"mat-option",14),t.qZA()()()(),t.TgZ(85,"div",4)(86,"div",5)(87,"mat-form-field",6)(88,"mat-label"),t._uU(89),t.ALo(90,"translate"),t.qZA(),t._UZ(91,"input",18),t.ALo(92,"translate"),t.YNc(93,Ut,3,3,"mat-error",8),t.YNc(94,Ot,3,3,"mat-error",8),t.qZA()(),t.TgZ(95,"div",5)(96,"mat-form-field",6)(97,"mat-label"),t._uU(98),t.ALo(99,"translate"),t.qZA(),t._UZ(100,"input",19),t.ALo(101,"translate"),t.YNc(102,xt,3,3,"mat-error",8),t.YNc(103,It,3,3,"mat-error",8),t.qZA()()()()(),t.TgZ(104,"div",20)(105,"div",4),t.YNc(106,Dt,4,5,"button",21),t.TgZ(107,"button",22),t.NdJ("click",function(){return a.close()}),t._uU(108),t.ALo(109,"translate"),t.qZA()()()()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,39,"MESSAGE.RegisterMsg")),t.xp6(2),t.Q6J("formGroup",a.registerForm),t.xp6(7),t.Oqu(t.lcZ(11,41,"HTML.USERNAME")),t.xp6(2),t.s9C("placeholder",t.lcZ(13,43,"HTML.USERNAME")),t.xp6(2),t.Q6J("ngIf",null==a.registerForm.controls.username.errors?null:a.registerForm.controls.username.errors.required),t.xp6(1),t.Q6J("ngIf",a.registerForm.controls.username.hasError("minlength")),t.xp6(4),t.Oqu(t.lcZ(20,45,"HTML.EMAIL")),t.xp6(2),t.s9C("placeholder",t.lcZ(22,47,"HTML.EMAIL")),t.xp6(2),t.Q6J("ngIf",null==a.registerForm.controls.email.errors?null:a.registerForm.controls.email.errors.required),t.xp6(1),t.Q6J("ngIf",a.registerForm.controls.email.hasError("invalidEmail")),t.xp6(5),t.Oqu(t.lcZ(30,49,"HTML.FIRST_NAME")),t.xp6(2),t.s9C("placeholder",t.lcZ(32,51,"HTML.FIRST_NAME")),t.xp6(2),t.Q6J("ngIf",null==a.registerForm.controls.first_name.errors?null:a.registerForm.controls.first_name.errors.required),t.xp6(1),t.Q6J("ngIf",a.registerForm.controls.first_name.hasError("minlength")),t.xp6(4),t.Oqu(t.lcZ(39,53,"HTML.LAST_NAME")),t.xp6(2),t.s9C("placeholder",t.lcZ(41,55,"HTML.LAST_NAME")),t.xp6(2),t.Q6J("ngIf",null==a.registerForm.controls.last_name.errors?null:a.registerForm.controls.last_name.errors.required),t.xp6(1),t.Q6J("ngIf",a.registerForm.controls.last_name.hasError("minlength")),t.xp6(5),t.hij(" ",t.lcZ(49,57,"HTML.BRANCH"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(51,59,"HTML.BRANCH")),t.xp6(4),t.Q6J("ngForOf",a.AllBranches),t.xp6(4),t.Oqu(t.lcZ(59,61,"HTML.MOBILE")),t.xp6(5),t.Q6J("ngIf",null==a.registerForm.controls.UserMobile.errors?null:a.registerForm.controls.UserMobile.errors.required),t.xp6(5),t.hij(" ",t.lcZ(69,63,"HTML.BUILDING"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(71,65,"HTML.BUILDING")),t.xp6(4),t.Q6J("ngForOf",a.AllBuilding),t.xp6(4),t.hij(" ",t.lcZ(79,67,"HTML.UNIT"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(81,69,"HTML.UNIT")),t.xp6(4),t.Q6J("ngForOf",a.AllUnitsForBuilding),t.xp6(5),t.Oqu(t.lcZ(90,71,"HTML.PASSWORD")),t.xp6(2),t.s9C("placeholder",t.lcZ(92,73,"HTML.PASSWORD")),t.xp6(2),t.Q6J("ngIf",null==a.registerForm.controls.password.errors?null:a.registerForm.controls.password.errors.required),t.xp6(1),t.Q6J("ngIf",a.registerForm.controls.password.hasError("minlength")),t.xp6(4),t.Oqu(t.lcZ(99,75,"HTML.ConfirmPassword")),t.xp6(2),t.s9C("placeholder",t.lcZ(101,77,"HTML.ConfirmPassword")),t.xp6(2),t.Q6J("ngIf",null==a.registerForm.controls.confirmPassword.errors?null:a.registerForm.controls.confirmPassword.errors.required),t.xp6(1),t.Q6J("ngIf",a.registerForm.controls.confirmPassword.hasError("mismatchedPasswords")),t.xp6(3),t.Q6J("ngIf",a.can("add_tenant")),t.xp6(2),t.Oqu(t.lcZ(109,79,"BTN.CANCEL")))},dependencies:[s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.wO,c.sg,c.O5,s.sg,s.u,u.xw,u.Wh,u.yH,w.ey,_.lW,m.ZT,m.uh,m.xY,m.H8,D.Nt,h.KE,h.hX,h.bx,h.TO,E.gD,f.X$],styles:[".user-form[_ngcontent-%COMP%]   .form-field-outer[_ngcontent-%COMP%]{width:280px}.user-form[_ngcontent-%COMP%]   .mat-mdc-radio-button[_ngcontent-%COMP%]{margin-right:12px}.auth[_ngcontent-%COMP%]{white-space:nowrap;padding:7px 14px;font-weight:500}"]});class ${}var R=l(5783),L=l(5726),O=l(5521),P=l(2887),Z=l(4459),k=l(1182),T=l(9132),F=l(7465),Nt=l(3071),A=l(4333),X=l(811),K=l(3546),B=l(7392),x=l(4850),ct=l(1572),z=l(266),Rt=l(1419);function Lt(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"mat-button-toggle",22),t.NdJ("click",function(){t.CHM(a);const n=t.oxw(2);return t.KtG(n.gotoNewTenant())}),t.TgZ(1,"mat-icon"),t._uU(2,"person_add"),t.qZA()()}}function Ft(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"div")(1,"div",8)(2,"div",9)(3,"mat-button-toggle-group",10,11),t.YNc(5,Lt,3,0,"mat-button-toggle",12),t.TgZ(6,"mat-button-toggle",13)(7,"mat-icon"),t._uU(8,"search"),t.qZA()()()(),t.TgZ(9,"form",14)(10,"mat-form-field",15)(11,"input",16),t.NdJ("ngModelChange",function(n){t.CHM(a);const r=t.oxw();return t.KtG(r.searchText=n)}),t.ALo(12,"translate"),t.qZA()()(),t.TgZ(13,"div",17)(14,"mat-button-toggle-group",18,19)(16,"mat-button-toggle",20)(17,"mat-icon"),t._uU(18,"view_list"),t.qZA()(),t.TgZ(19,"mat-button-toggle",21)(20,"mat-icon"),t._uU(21,"view_module"),t.qZA()()()()()()}if(2&i){const a=t.MAs(4),o=t.oxw();t.xp6(5),t.Q6J("ngIf",o.can("add_tenant")),t.xp6(4),t.ekj("show","search"==a.value),t.xp6(2),t.s9C("placeholder",t.lcZ(12,5,"HTML.SEARCH_TENANT")),t.Q6J("ngModel",o.searchText)}}const Mt=function(i){return["/contracts/tenant-add/",i]};function qt(i,e){if(1&i&&(t.TgZ(0,"a",29),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()()),2&i){const a=t.oxw().$implicit;t.s9C("matTooltip",t.lcZ(1,2,"BTN.EDIT")),t.Q6J("routerLink",t.VKq(4,Mt,a.id))}}function wt(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(a);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.removeTenant(n.id))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()}2&i&&t.s9C("matTooltip",t.lcZ(1,1,"BTN.REMOVE"))}const Et=function(i){return["/contracts/statements-list/",i]};function Pt(i,e){if(1&i&&(t.TgZ(0,"a",29),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"receipt"),t.qZA()()),2&i){const a=t.oxw().$implicit;t.s9C("matTooltip",t.lcZ(1,2,"BTN.Statements")),t.Q6J("routerLink",t.VKq(4,Et,a.id))}}function kt(i,e){if(1&i&&(t.TgZ(0,"div",23)(1,"div",24),t._uU(2),t.qZA(),t.TgZ(3,"div",24),t._uU(4),t.qZA(),t.TgZ(5,"div",24),t._uU(6),t.qZA(),t.TgZ(7,"div",24),t._uU(8),t.qZA(),t.TgZ(9,"div",24),t._uU(10),t.qZA(),t.TgZ(11,"div",24)(12,"mat-icon",25),t._uU(13),t.qZA()(),t.TgZ(14,"div",24)(15,"div",26),t.YNc(16,qt,4,6,"a",27),t.YNc(17,wt,4,3,"button",28),t.YNc(18,Pt,4,6,"a",27),t.qZA()()()),2&i){const a=e.$implicit,o=t.oxw();t.xp6(2),t.Oqu(a.CUSName),t.xp6(2),t.Oqu(a.CUSMobile),t.xp6(2),t.Oqu(a.CUSGenderDisplay),t.xp6(2),t.hij(" ",a.build_Name," "),t.xp6(2),t.hij(" ",a.unit_Name," "),t.xp6(3),t.Oqu("T"==a.CUSActive?"check_box":"check_box_outline_blank"),t.xp6(3),t.Q6J("ngIf",o.can("view_onetenant")||0==o.account.periorty&&"T"!==o.account.userDataConfirmed),t.xp6(1),t.Q6J("ngIf",o.can("delete_tenant")),t.xp6(1),t.Q6J("ngIf",o.can("view_tenantstatements"))}}function Kt(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"div",31)(1,"div",32)(2,"mat-card",33)(3,"pagination-controls",34),t.NdJ("pageChange",function(n){t.CHM(a);const r=t.oxw();return t.KtG(r.onPageChanged(n))}),t.qZA()()()()}}function Bt(i,e){1&i&&(t.TgZ(0,"div",35),t._UZ(1,"mat-spinner",36),t.qZA())}const Ht=function(i,e){return{itemsPerPage:i,currentPage:e}};class H{constructor(e,a,o,n,r,d,p,g,C,v){this.appSettings=e,this.dialog=a,this.usersService=o,this.router=n,this.global=r,this.localStore=d,this.snackBar=p,this.translateService=g,this.userService=C,this.datePipe=v,this.curTenant=new $,this.curCOMId=S.N.comid,this.account=new R.n,this.count=8,this.defaultCusImage=(new O.P).noImage,this.CusImageToUpload=null,this.userPerm=[],this.settings=this.appSettings.settings}handelCUSImgInput(e){this.CusImageToUpload=e.item(0);var a=new FileReader;a.onload=o=>{this.defaultCusImage=o.target.result},a.readAsDataURL(this.CusImageToUpload)}ngOnInit(){if(this.securityForApp=(new Z.$).getSecurityType(),this.userSUb=this.global.user.subscribe(e=>{this.account=e}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let e=0;e<this.curUserPermissions.length;e++)this.userPerm[e]=this.curUserPermissions[e].codename;this.prepareMsgLanguage(),this.getTenants(),console.log("====curUserData id:: "+this.curUserData.id)}else this.router.navigate(["/sign-in"])}can(e){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(e))}getTenants(){this.users=null,this.curUserData.is_superuser?this.usersService.getCustomers(this.curCOMId,this.account.periorty).subscribe(e=>this.users=e):0==this.curUserData.periorty?this.usersService.getCustomerPerUser(this.curCOMId,this.account.periorty,this.curUserData.id).subscribe(e=>this.users=e):("N"==this.securityForApp&&this.usersService.getCustomersPerBranch(this.curCOMId,this.account.periorty,this.curUserData.branch_KeyField).subscribe(e=>this.users=e),"D"==this.securityForApp&&this.usersService.getCustomersPerEmployee(this.curCOMId,this.account.periorty,this.curUserData.id).subscribe(e=>this.users=e))}addTenant(e){this.usersService.addOneCustomer(e).subscribe(a=>this.getTenants())}updateTenant(e){this.usersService.editCustomer(e,this.CusImageToUpload,this.CusImageToUpload,this.curUserData.is_employee).subscribe(a=>this.getTenants())}deleteTenant(e){this.dialog.open(P.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(o=>{o&&this.usersService.deleteCustomer(e.id).subscribe(n=>this.getTenants())})}removeTenant(e){this.dialog.open(P.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(o=>{o&&this.usersService.deleteCustomer(e).subscribe(n=>this.getTenants())})}onPageChanged(e){this.page=e,this.getTenants(),window.scrollTo(0,0)}gotoTenantDisplay(e){console.log("===**gotoTenantDisplay**=== "+e),this.router.navigate(["/contracts/tenant-add/"+e])}gotoNewTenant(){this.dialog.open(N,{data:{periorty:this.account.periorty},panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr"}).afterClosed().subscribe(a=>{console.log("=====result.event:: "+a.event),"Cancel"==a.event||"Post"==a.event&&this.userService.registerTenant_with_lastName(a.data).subscribe(o=>{this.getTenants(),this.snackBar.open(this.registeredMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3})},o=>{console.log("error",o),this.snackBar.open(this.notRegisteredMsg,"\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})})}openTenantDialog(e){this.dialog.open(N,{data:e}).afterClosed().subscribe(o=>{o?(console.log("=====if user True:: =============="),console.log(o),this.curTenant=new $,console.log(this.curTenant),this.fromUserToCustomer(o),console.log(this.curTenant),o.id?this.updateTenant(this.curTenant):this.addTenant(this.curTenant)):console.log("=====if user False:: ==============")})}fromUserToCustomer(e){this.curTenant.id=e.id,this.curTenant.RowDelete=e.settings.isDeleted?1:0,this.curTenant.CUSCode=e.code,this.curTenant.CUSPic=e.image,this.curTenant.CUSGender=e.profile.gender,console.log("====Date===="),console.log(e.profile.birthday),this.curTenant.CUSBirthDate=e.profile.birthday,this.curTenant.CUSMobile=e.mobile,this.curTenant.CUSEmail=e.contacts.email,this.curTenant.CUSActive=e.settings.isActive?"T":"F",this.curTenant.CUSAddress=e.contacts.address,this.curTenant.Country_CTTKeyField=e.contacts.country,this.curTenant.CUSusername=e.username,this.curTenant.CUSFirstName=e.firstname,this.curTenant.CUSLastName=e.lastname}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(e=>{this.errorRetrieveMsg=e}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(e=>{this.askToDeletedMsg=e}),this.translateService.get("MESSAGE.DELETED").subscribe(e=>{this.deletedMsg=e}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(e=>{this.deletedTitleMsg=e}),this.translateService.get("MESSAGE.REGISTERD").subscribe(e=>{this.registeredMsg=e}),this.translateService.get("MESSAGE.NOTREGISTERD").subscribe(e=>{this.notRegisteredMsg=e})}}H.\u0275fac=function(e){return new(e||H)(t.Y36(k.d),t.Y36(m.uw),t.Y36(L.v),t.Y36(T.F0),t.Y36(F.U),t.Y36(b.C),t.Y36(U.ux),t.Y36(f.sK),t.Y36(Nt.K),t.Y36(c.uU))},H.\u0275cmp=t.Xpm({type:H,selectors:[["app-customers-list"]],features:[t._Bn([L.v,c.uU])],decls:40,vars:34,consts:[[4,"ngIf"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click",4,"ngIf"],["value","search"],[1,"user-search"],[1,"user-search-input"],["matInput","","name","search","autocomplete","off",3,"placeholder","ngModel","ngModelChange"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","list"],["viewType","matButtonToggleGroup"],["value","list"],["value","grid"],["value","add",3,"click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"text-muted"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip",4,"ngIf"],["mat-mini-fab","","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100",1,"p-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(e,a){1&e&&(t.YNc(0,Ft,22,7,"div",0),t._UZ(1,"mat-divider"),t.TgZ(2,"mat-card")(3,"div",1)(4,"h2"),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t._UZ(7,"mat-divider"),t.TgZ(8,"div",2)(9,"div",3)(10,"div",4)(11,"h2"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"div",4)(15,"h2"),t._uU(16),t.ALo(17,"translate"),t.qZA()(),t.TgZ(18,"div",4)(19,"h2"),t._uU(20),t.ALo(21,"translate"),t.qZA()(),t.TgZ(22,"div",4)(23,"h2"),t._uU(24),t.ALo(25,"translate"),t.qZA()(),t.TgZ(26,"div",4)(27,"h2"),t._uU(28),t.ALo(29,"translate"),t.qZA()(),t.TgZ(30,"div",4)(31,"h2"),t._uU(32),t.ALo(33,"translate"),t.qZA()(),t._UZ(34,"div",4),t.qZA(),t.YNc(35,kt,19,9,"div",5),t.ALo(36,"paginate"),t.ALo(37,"TenantSearchPipe"),t.qZA()(),t.YNc(38,Kt,4,0,"div",6),t.YNc(39,Bt,2,0,"div",7)),2&e&&(t.Q6J("ngIf",a.account.periorty>0),t.xp6(5),t.hij("",t.lcZ(6,11,"HTML.TENANTS_LIST")," "),t.xp6(7),t.hij(" ",t.lcZ(13,13,"FIELD.NAME")," "),t.xp6(4),t.hij(" ",t.lcZ(17,15,"HTML.MOBILE")," "),t.xp6(4),t.hij(" ",t.lcZ(21,17,"HTML.GENDER")," "),t.xp6(4),t.hij(" ",t.lcZ(25,19,"HTML.BUILDING")," "),t.xp6(4),t.hij(" ",t.lcZ(29,21,"HTML.UNIT")," "),t.xp6(4),t.hij(" ",t.lcZ(33,23,"HTML.ACTIVATED")," "),t.xp6(3),t.Q6J("ngForOf",t.xi3(36,25,t.xi3(37,28,a.users,a.searchText),t.WLB(31,Ht,a.count,a.page))),t.xp6(3),t.Q6J("ngIf",a.users),t.xp6(1),t.Q6J("ngIf",!a.users))},dependencies:[s._Y,s.Fj,s.JJ,s.JL,s.On,s.F,A.LS,c.sg,c.O5,T.rH,u.xw,u.Wh,u.yH,_.Tq,_.nh,X.A9,X.Yi,K.a8,B.Hw,D.Nt,h.KE,x.d,ct.Ou,z.gM,A._s,Rt.DA,f.X$],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}\n"],encapsulation:2});var tt=l(8959);function Jt(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"div")(1,"mat-button-toggle-group",15,16)(3,"mat-button-toggle",17),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.gotoNewContract())}),t.TgZ(4,"mat-icon"),t._uU(5,"note_add"),t.qZA()()()()}}const Vt=function(i){return["/contracts/contract-add/",i]};function Yt(i,e){if(1&i&&(t.TgZ(0,"a",23),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()()),2&i){const a=t.oxw().$implicit;t.s9C("matTooltip",t.lcZ(1,2,"BTN.EDIT")),t.Q6J("routerLink",t.VKq(4,Vt,a.id))}}function Qt(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(a);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.removeContract(n.id))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()}2&i&&t.s9C("matTooltip",t.lcZ(1,1,"BTN.REMOVE"))}const Gt=function(i){return["/contracts/installment-list/",i]};function jt(i,e){if(1&i&&(t.TgZ(0,"a",23),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"receipt"),t.qZA()()),2&i){const a=t.oxw().$implicit;t.s9C("matTooltip",t.lcZ(1,2,"BTN.INSTALLMENT")),t.Q6J("routerLink",t.VKq(4,Gt,a.id))}}const Wt=function(i){return["/contracts/contract-add/renew/",i]};function $t(i,e){if(1&i&&(t.TgZ(0,"a",23),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"autorenew"),t.qZA()()),2&i){const a=t.oxw().$implicit;t.s9C("matTooltip",t.lcZ(1,2,"BTN.ReNewContract")),t.Q6J("routerLink",t.VKq(4,Wt,a.id))}}function Xt(i,e){if(1&i&&(t.TgZ(0,"div",18)(1,"div",19),t._uU(2),t.qZA(),t.TgZ(3,"div",19),t._uU(4),t.qZA(),t.TgZ(5,"div",19),t._uU(6),t.qZA(),t.TgZ(7,"div",19),t._uU(8),t.qZA(),t.TgZ(9,"div",19),t._uU(10),t.qZA(),t.TgZ(11,"div",19),t._uU(12),t.qZA(),t.TgZ(13,"div",19),t._uU(14),t.qZA(),t.TgZ(15,"div",19)(16,"div",20),t.YNc(17,Yt,4,6,"a",21),t.YNc(18,Qt,4,3,"button",22),t.YNc(19,jt,4,6,"a",21),t.YNc(20,$t,4,6,"a",21),t.qZA()()()),2&i){const a=e.$implicit,o=t.oxw();t.xp6(1),t.Tol(o.statusColor[a.RCOContractStatus]),t.xp6(1),t.Oqu(a.branch_ArbName),t.xp6(1),t.Tol(o.statusColor[a.RCOContractStatus]),t.xp6(1),t.Oqu(a.build_Name),t.xp6(1),t.Tol(o.statusColor[a.RCOContractStatus]),t.xp6(1),t.Oqu(a.unit_UnitNumber),t.xp6(1),t.Tol(o.statusColor[a.RCOContractStatus]),t.xp6(1),t.hij(" ",a.customer_Name," "),t.xp6(1),t.Tol(o.statusColor[a.RCOContractStatus]),t.xp6(1),t.hij(" ",a.RCODate," "),t.xp6(1),t.Tol(o.statusColor[a.RCOContractStatus]),t.xp6(1),t.AsE(" (",a.RCOCode," / ",a.RCOSubCode,") "),t.xp6(1),t.Tol(o.statusColor[a.RCOContractStatus]),t.xp6(1),t.hij(" ",a.RCOEjarCode," "),t.xp6(3),t.Q6J("ngIf",o.can("view_onecontract")||0==o.account.periorty),t.xp6(1),t.Q6J("ngIf",o.can("delete_rentcontracts")),t.xp6(1),t.Q6J("ngIf",o.can("view_contractinstallments")||0==o.account.periorty),t.xp6(1),t.Q6J("ngIf",o.can("view_renewcontract")&&"N"==a.RCOContractStatus)}}function zt(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"div",25)(1,"div",26)(2,"mat-card",27)(3,"pagination-controls",28),t.NdJ("pageChange",function(n){t.CHM(a);const r=t.oxw();return t.KtG(r.onPageChanged(n))}),t.qZA()()()()}}function te(i,e){1&i&&(t.TgZ(0,"div",29),t._UZ(1,"mat-spinner",30),t.qZA())}const ee=function(i,e){return{itemsPerPage:i,currentPage:e}};class J{constructor(e,a,o,n,r,d,p,g){this.appSettings=e,this.dialog=a,this.contractService=o,this.router=n,this.global=r,this.localStore=d,this.translateService=p,this.snackBar=g,this.statusColor={N:"make-white",R:"make-gold",F:"make-yellowgreen",C:"make-yellow"},this.curCOMId=S.N.comid,this.account=new R.n,this.count=4,this.userPerm=[],this.settings=this.appSettings.settings}ngOnInit(){if(this.securityForApp=(new Z.$).getSecurityType(),this.userSUb=this.global.user.subscribe(e=>{this.account=e}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let e=0;e<this.curUserPermissions.length;e++)this.userPerm[e]=this.curUserPermissions[e].codename;this.prepareMsgLanguage(),this.getContracts()}else this.router.navigate(["/sign-in"])}can(e){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(e))}getContracts(){this.contractsAll=null,this.curUserData.is_superuser?this.contractService.getAllContracts(this.curCOMId,this.account.periorty).subscribe(e=>this.contractsAll=e):0==this.curUserData.periorty?this.contractService.getContractsPerCustomer(this.curCOMId,this.account.periorty,this.account.customer_KeyField).subscribe(e=>this.contractsAll=e):1==this.curUserData.periorty&&("N"==this.securityForApp&&this.contractService.getContractsPerBranch(this.curCOMId,this.account.periorty,this.account.branch_KeyField).subscribe(e=>this.contractsAll=e),"D"==this.securityForApp&&this.contractService.getContractsPerEmp(this.curCOMId,this.account.periorty,this.account.id).subscribe(e=>this.contractsAll=e))}renewContract(e){console.log("===========renewContract")}removeContract(e){this.dialog.open(P.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(o=>{o&&this.contractService.deleteContract(e).subscribe(n=>this.getContracts())})}contractInstallments(e){}onPageChanged(e){this.page=e,this.getContracts(),window.scrollTo(0,0)}gotoNewContract(){this.router.navigate(["/contracts/contract-add/"])}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(e=>{this.errorRetrieveMsg=e}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(e=>{this.askToDeletedMsg=e}),this.translateService.get("MESSAGE.DELETED").subscribe(e=>{this.deletedMsg=e}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(e=>{this.deletedTitleMsg=e})}}J.\u0275fac=function(e){return new(e||J)(t.Y36(k.d),t.Y36(m.uw),t.Y36(tt.W),t.Y36(T.F0),t.Y36(F.U),t.Y36(b.C),t.Y36(f.sK),t.Y36(U.ux))},J.\u0275cmp=t.Xpm({type:J,selectors:[["app-contract-list"]],features:[t._Bn([tt.W])],decls:54,vars:34,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],[4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","list"],["viewType","matButtonToggleGroup"],["value","list"],["value","grid"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip",4,"ngIf"],["mat-mini-fab","","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100",1,"p-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,Jt,6,0,"div",2),t.qZA(),t.TgZ(3,"div",3)(4,"mat-button-toggle-group",4,5)(6,"mat-button-toggle",6)(7,"mat-icon"),t._uU(8,"view_list"),t.qZA()(),t.TgZ(9,"mat-button-toggle",7)(10,"mat-icon"),t._uU(11,"view_module"),t.qZA()()()()(),t._UZ(12,"mat-divider"),t.TgZ(13,"mat-card")(14,"div",8)(15,"h2"),t._uU(16),t.ALo(17,"translate"),t.qZA()(),t._UZ(18,"mat-divider"),t.TgZ(19,"div",9)(20,"div",10)(21,"div",11)(22,"h2"),t._uU(23),t.ALo(24,"translate"),t.qZA()(),t.TgZ(25,"div",11)(26,"h2"),t._uU(27),t.ALo(28,"translate"),t.qZA()(),t.TgZ(29,"div",11)(30,"h2"),t._uU(31),t.ALo(32,"translate"),t.qZA()(),t.TgZ(33,"div",11)(34,"h2"),t._uU(35),t.ALo(36,"translate"),t.qZA()(),t.TgZ(37,"div",11)(38,"h2"),t._uU(39),t.ALo(40,"translate"),t.qZA()(),t.TgZ(41,"div",11)(42,"h2"),t._uU(43),t.ALo(44,"translate"),t.qZA()(),t.TgZ(45,"div",11)(46,"h2"),t._uU(47),t.ALo(48,"translate"),t.qZA()(),t._UZ(49,"div",11),t.qZA(),t.YNc(50,Xt,21,26,"div",12),t.ALo(51,"paginate"),t.qZA()(),t.YNc(52,zt,4,0,"div",13),t.YNc(53,te,2,0,"div",14)),2&e&&(t.xp6(2),t.Q6J("ngIf",a.can("add_rentcontracts")),t.xp6(14),t.Oqu(t.lcZ(17,12,"HTML.Contract_List")),t.xp6(7),t.hij(" ",t.lcZ(24,14,"HTML.BRANCH")," "),t.xp6(4),t.hij(" ",t.lcZ(28,16,"HTML.BUILDING")," "),t.xp6(4),t.hij(" ",t.lcZ(32,18,"HTML.UnitNumber")," "),t.xp6(4),t.hij(" ",t.lcZ(36,20,"HTML.TENANT")," "),t.xp6(4),t.hij(" ",t.lcZ(40,22,"HTML.ContractDate")," "),t.xp6(4),t.hij(" ",t.lcZ(44,24,"HTML.ContractCode")," "),t.xp6(4),t.hij(" ",t.lcZ(48,26,"HTML.ContractEjarCode")," "),t.xp6(3),t.Q6J("ngForOf",t.xi3(51,28,a.contractsAll,t.WLB(31,ee,a.count,a.page))),t.xp6(2),t.Q6J("ngIf",a.contractsAll),t.xp6(1),t.Q6J("ngIf",!a.contractsAll))},dependencies:[A.LS,c.sg,c.O5,T.rH,u.xw,u.Wh,u.yH,_.Tq,_.nh,X.A9,X.Yi,K.a8,B.Hw,x.d,ct.Ou,z.gM,A._s,f.X$],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}table{width:100%}.make-gold{background-color:gold}.make-yellow{background-color:#ff4500}.make-yellowgreen{background-color:#ad7020}.make-white{background-color:#fff}\n"],encapsulation:2});var ae=l(5861);class ie{}var ut=l(6838),oe=l(4165),mt=l(6709),y=l(9602),et=l(3848),it=l(1596),ot=l(8796);function ne(i,e){1&i&&(t.TgZ(0,"h1",72),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"RenewContract")," "))}function re(i,e){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"BTN.ADD")))}function se(i,e){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"BTN.EDIT")))}function le(i,e){if(1&i&&(t.TgZ(0,"h1",72),t.YNc(1,re,3,3,"span",73),t.YNc(2,se,3,3,"span",73),t._uU(3),t.ALo(4,"translate"),t.qZA()),2&i){const a=t.oxw();t.xp6(1),t.Q6J("ngIf",!a.contractForDisplay.id),t.xp6(1),t.Q6J("ngIf",a.contractForDisplay.id),t.xp6(1),t.hij(" ",t.lcZ(4,3,"HTML.RentContract"),"")}}function ce(i,e){if(1&i&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.OWNName," ")}}function ue(i,e){if(1&i&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.OWNName," ")}}function me(i,e){if(1&i&&(t.TgZ(0,"ng-option",23),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.CUSName,"")}}function de(i,e){if(1&i&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.CUSName," ")}}function pe(i,e){if(1&i&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.BRAArbName," ")}}function he(i,e){if(1&i&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.BUIName," ")}}function ge(i,e){if(1&i&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.UNTUnitNumber," ")}}function Ce(i,e){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"BTN.SAVE")))}function fe(i,e){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"BTN.EDIT")))}function _e(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",74),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.saveUpdate(n.contractForDisplay.id))}),t.YNc(1,Ce,3,3,"span",73),t.YNc(2,fe,3,3,"span",73),t.qZA()}if(2&i){const a=t.oxw();t.Q6J("mat-dialog-close",a.form.value)("disabled",!a.form.valid),t.xp6(1),t.Q6J("ngIf",!a.contractForDisplay.id),t.xp6(1),t.Q6J("ngIf",a.contractForDisplay.id)}}class I{constructor(e,a,o,n,r,d,p,g,C,v,j,nt,rt){this.activatedRoute=e,this.codesService=a,this.unitsService=o,this.contractService=n,this.fb=r,this.localStore=d,this.router=p,this.global=g,this.translateService=C,this.atlasService=v,this.settingService=j,this.tenantsService=nt,this.snackBar=rt,this.curCOMId=S.N.comid,this.account=new R.n,this.docType_const=(new Z.I).OwnershipDocTypes,this.country_const=(new Z.I).Countries,this.governorate_const=(new Z.I).Governorates,this.city_const=(new Z.I).City,this.region_const=(new Z.I).Regions,this.buildingFeatures_const=(new Z.I).BuildingFeatures,this.passwordHide=!0,this.userPerm=[],this.DocImageToUpload=null,this.defaultDocImage=(new O.P).noImage,this.defaultCusImage=(new O.P).noImage,this.CusImageToUpload=null,this.DocTypes=[],this.parameters=[],this.Countries=[],this.Governorates=[],this.AllBuilding=[],this.AllUnitsForBuilding=[],this.AllRepresentativeForOwner=[],this.AllBranches=[],this.AllOwners=[],this.AllRepresentativeForCustomer=[],this.AllTenants=[]}isBigEnough(e,a,o){return e>=10}ngOnInit(){if(this.userSUb=this.global.user.subscribe(a=>{this.account=a}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let a=0;a<this.curUserPermissions.length;a++)this.userPerm[a]=this.curUserPermissions[a].codename;var e=JSON.parse(this.localStore.getItem("account"));this.isEmployee="T"==e.is_employee,this.getParamValue(this.curCOMId,this.account.periorty,1),this.getParamValue(this.curCOMId,this.account.periorty,2),this.getParamValue(this.curCOMId,this.account.periorty,3),this.ownerKeyForApp=(new Z.$).ownerKeyField,this.form=this.fb.group({id:null,RCOCode:{value:null,disabled:!0},RCOSubCode:{value:null,disabled:!0},RCOEjarCode:null,Related_RCOKeyField:null,contractDate:null,contractStartDate:[null,s.kI.required],contractEndDate:[null,s.kI.required],RCOContractStatus:"N",RCOAlarmStartDate:{value:[""],disabled:!0},RCONoOfDaysForAlarm:0,RCONoOfDaysForEjarAlarm:0,RCOAlarmCounter:{value:0,disabled:!0},contractUnit:this.fb.group({branch_KeyField:{value:null,disabled:0==this.curUserData.periorty},build_KeyField:{value:null,disabled:0==this.curUserData.periorty},unit_KeyField:{value:null,disabled:0==this.curUserData.periorty}}),contractPerson:this.fb.group({owner_KeyField:this.ownerKeyForApp,owner_representative_KeyField:null,customer_KeyField:null,customer_representative_KeyField:null}),contractValues:this.fb.group({RCOContractValue:[null,s.kI.required],RCOPayEveryMonthesNo:[null,s.kI.required],RCOMonthValue:[null,s.kI.required],RCOInsuranceValue:0,RCOSeekingValue:0,RCOMonthlyExpense:0,RCOExpenseDesc:null,RCOOtherValue:0,RCOMonthlyElectricValue:0,RCOElectricCounterReading:null,RCOMonthlyWaterValue:0,RCOWaterCounterReading:null,RCOMonthlyGasValue:0,RCOGasCounterReading:null}),settings:this.fb.group({isActive:null,isDeleted:null}),docs:this.fb.group({docOnePic:null,docPic:null})}),this.getCountries(this.curCOMId,this.account.periorty),this.getAllBranches(this.curCOMId,this.account.periorty),this.getAllOwnerss(this.curCOMId,this.account.periorty),this.getOwnershipDocType(this.curCOMId,this.account.periorty),this.getTenants(),this.getRepresentativePerOwner(this.curCOMId,this.account.periorty,this.ownerKeyForApp),this.activatedRoute.data.subscribe(a=>{this.isRenewContract=a.parentID}),this.sub=this.activatedRoute.params.subscribe(a=>{a.id?(this.id=+a.id,console.log("params['id']:: "+this.id),this.getContractById(this.id)):this.contractForDisplay=new ie})}else this.router.navigate(["/sign-in"])}can(e){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(e))}onFileChange(e){this.DocImageToUpload=e.item(0);var a=new FileReader;a.onload=o=>{this.defaultDocImage=o.target.result},a.readAsDataURL(this.DocImageToUpload)}handelCUSImgInput(e){this.CusImageToUpload=e.item(0);var a=new FileReader;a.onload=o=>{this.defaultCusImage=o.target.result},a.readAsDataURL(this.CusImageToUpload)}mapFormvalue_to_ContractClass(){this.form.enable();const e=new c.uU("en-GB").transform(this.form.value.contractDate,"dd/MM/yyyy"),a=new c.uU("en-GB").transform(this.form.value.contractStartDate,"dd/MM/yyyy"),o=new c.uU("en-GB").transform(this.form.value.contractEndDate,"dd/MM/yyyy"),n=new c.uU("en-GB").transform(this.form.value.RCOAlarmStartDate,"dd/MM/yyyy");this.tenActive=this.form.value.settings.isActive?"T":"F",this.tenDeleted=this.form.value.settings.isDeleted?1:0,this.contractForDisplay.id=this.form.value.id,this.contractForDisplay.Related_RCOKeyField=this.form.value.Related_RCOKeyField,this.contractForDisplay.RCOCode=this.form.value.RCOCode,this.contractForDisplay.RCOSubCode=this.form.value.RCOSubCode,this.contractForDisplay.RCOEjarCode=this.form.value.RCOEjarCode,null!=this.form.value.contractDate&&(this.contractForDisplay.RCODate=e),null!=this.form.value.contractStartDate&&(this.contractForDisplay.RCOStartDate=a),null!=this.form.value.contractEndDate&&(this.contractForDisplay.RCOEndDate=o),null!=this.form.value.RCOAlarmStartDate&&(this.contractForDisplay.RCOAlarmStartDate=n),this.contractForDisplay.RCOContractStatus=this.form.value.RCOContractStatus,this.contractForDisplay.RCOAlarmCounter=this.form.value.RCOAlarmCounter,this.contractForDisplay.RCONoOfDaysForAlarm=this.form.value.RCONoOfDaysForAlarm,this.contractForDisplay.RCONoOfDaysForEjarAlarm=this.form.value.RCONoOfDaysForEjarAlarm,this.contractForDisplay.branch_KeyField=this.form.value.contractUnit.branch_KeyField,this.contractForDisplay.build_KeyField=this.form.value.contractUnit.build_KeyField,this.contractForDisplay.unit_KeyField=this.form.value.contractUnit.unit_KeyField,this.contractForDisplay.owner_KeyField=this.form.value.contractPerson.owner_KeyField,this.contractForDisplay.owner_representative_KeyField=this.form.value.contractPerson.owner_representative_KeyField,this.contractForDisplay.customer_KeyField=this.form.value.contractPerson.customer_KeyField,this.contractForDisplay.customer_representative_KeyField=this.form.value.contractPerson.customer_representative_KeyField,this.contractForDisplay.RCOContractValue=this.form.value.contractValues.RCOContractValue,this.contractForDisplay.RCOPayEveryMonthesNo=this.form.value.contractValues.RCOPayEveryMonthesNo,this.contractForDisplay.RCOMonthValue=this.form.value.contractValues.RCOMonthValue,this.contractForDisplay.RCOInsuranceValue=this.form.value.contractValues.RCOInsuranceValue,this.contractForDisplay.RCOSeekingValue=this.form.value.contractValues.RCOSeekingValue,this.contractForDisplay.RCOMonthlyExpense=this.form.value.contractValues.RCOMonthlyExpense,this.contractForDisplay.RCOExpenseDesc=this.form.value.contractValues.RCOExpenseDesc,this.contractForDisplay.RCOOtherValue=this.form.value.contractValues.RCOOtherValue,this.contractForDisplay.RCOMonthlyElectricValue=this.form.value.contractValues.RCOMonthlyElectricValue,this.contractForDisplay.RCOElectricCounterReading=this.form.value.contractValues.RCOElectricCounterReading,this.contractForDisplay.RCOMonthlyWaterValue=this.form.value.contractValues.RCOMonthlyWaterValue,this.contractForDisplay.RCOWaterCounterReading=this.form.value.contractValues.RCOWaterCounterReading,this.contractForDisplay.RCOMonthlyGasValue=this.form.value.contractValues.RCOMonthlyGasValue,this.contractForDisplay.RCOGasCounterReading=this.form.value.contractValues.RCOGasCounterReading,this.contractForDisplay.RCOActive=this.tenActive,this.contractForDisplay.RowDelete=this.tenDeleted}getContractById(e){const a=[];this.contractService.getOneContract(e).subscribe(o=>{"T"!=this.isRenewContract&&this.contractService.getOneContractDocs(this.curCOMId,this.account.periorty,e).subscribe(n=>{for(var r of n)a.push({link:r.RCDPic,preview:r.RCDPic})}),this.fillForm(o,a),this.contractForDisplay=o,"T"==this.isRenewContract&&(this.contractForDisplay.id=null)})}fillForm(e,a){this.is_active="T"==e.RCOActive,null!=e.branch_KeyField&&this.getBuildingPerBranch(this.curCOMId,this.account.periorty,e.branch_KeyField),null!=e.build_KeyField&&this.getUnitsPerBuilding(this.curCOMId,this.account.periorty,e.build_KeyField,""),null!=e.owner_KeyField&&this.getRepresentativePerOwner(this.curCOMId,this.account.periorty,e.owner_KeyField),null!=e.customer_KeyField&&this.getRepresentativePerCustomer(this.curCOMId,this.account.periorty,e.customer_KeyField),null!=e.RCODate&&(this.s_rcoDate="T"==this.isRenewContract?new Date:e.RCODate),this.is_delete=1==e.RowDelete,this.form.patchValue("T"!=this.isRenewContract?{id:e.id,Related_RCOKeyField:e.Related_RCOKeyField,RCOCode:e.RCOCode,RCOSubCode:e.RCOSubCode,RCOEjarCode:e.RCOEjarCode,contractDate:e.RCODate,contractStartDate:e.RCOStartDate,contractEndDate:e.RCOEndDate,RCOContractStatus:e.RCOContractStatus,RCOAlarmStartDate:e.RCOAlarmStartDate,RCOAlarmCounter:e.RCOAlarmCounter,RCONoOfDaysForAlarm:e.RCONoOfDaysForAlarm,RCONoOfDaysForEjarAlarm:e.RCONoOfDaysForEjarAlarm,contractUnit:{branch_KeyField:e.branch_KeyField,build_KeyField:e.build_KeyField,unit_KeyField:e.unit_KeyField},contractPerson:{owner_KeyField:e.owner_KeyField,owner_representative_KeyField:e.owner_representative_KeyField,customer_KeyField:e.customer_KeyField,customer_representative_KeyField:e.customer_representative_KeyField},contractValues:{RCOContractValue:e.RCOContractValue,RCOPayEveryMonthesNo:e.RCOPayEveryMonthesNo,RCOMonthValue:e.RCOMonthValue,RCOInsuranceValue:e.RCOInsuranceValue,RCOSeekingValue:e.RCOSeekingValue,RCOMonthlyExpense:e.RCOMonthlyExpense,RCOExpenseDesc:e.RCOExpenseDesc,RCOOtherValue:e.RCOOtherValue,RCOMonthlyElectricValue:e.RCOMonthlyElectricValue,RCOElectricCounterReading:e.RCOElectricCounterReading,RCOMonthlyWaterValue:e.RCOMonthlyWaterValue,RCOWaterCounterReading:e.RCOWaterCounterReading,RCOMonthlyGasValue:e.RCOMonthlyGasValue,RCOGasCounterReading:e.RCOGasCounterReading},settings:{isActive:this.is_active,isDeleted:this.is_delete},docs:{docPic:a}}:{Related_RCOKeyField:e.id,RCOCode:e.RCOCode,RCOSubCode:+e.RCOSubCode+1,RCOEjarCode:e.RCOEjarCode,contractDate:new Date,contractStartDate:this.addDays(e.RCOEndDate,1),RCOContractStatus:e.RCOContractStatus,RCOAlarmCounter:0,RCONoOfDaysForAlarm:e.RCONoOfDaysForAlarm,RCONoOfDaysForEjarAlarm:e.RCONoOfDaysForEjarAlarm,contractUnit:{branch_KeyField:e.branch_KeyField,build_KeyField:e.build_KeyField,unit_KeyField:e.unit_KeyField},contractPerson:{owner_KeyField:e.owner_KeyField,owner_representative_KeyField:e.owner_representative_KeyField,customer_KeyField:e.customer_KeyField,customer_representative_KeyField:e.customer_representative_KeyField},contractValues:{RCOContractValue:e.RCOContractValue,RCOPayEveryMonthesNo:e.RCOPayEveryMonthesNo,RCOMonthValue:e.RCOMonthValue,RCOInsuranceValue:e.RCOInsuranceValue,RCOSeekingValue:e.RCOSeekingValue,RCOMonthlyExpense:e.RCOMonthlyExpense,RCOExpenseDesc:e.RCOExpenseDesc,RCOOtherValue:e.RCOOtherValue,RCOMonthlyElectricValue:e.RCOMonthlyElectricValue,RCOElectricCounterReading:e.RCOElectricCounterReading,RCOMonthlyWaterValue:e.RCOMonthlyWaterValue,RCOWaterCounterReading:e.RCOWaterCounterReading,RCOMonthlyGasValue:e.RCOMonthlyGasValue,RCOGasCounterReading:e.RCOGasCounterReading},settings:{isActive:this.is_active,isDeleted:this.is_delete},docs:{docPic:a}})}handleInstallment(e){var a=this;return(0,ae.Z)(function*(){let o=12/e.RCOPayEveryMonthesNo,n=e.RCOPayEveryMonthesNo,r=e.RCOStartDate,d=e.RCOMonthValue;for(let C=0;C<o;C++){if(0==C)var p=new Date(r);else{const j=new Date(r);p=a.addMonths(j,C*n)}var g=new Date(new c.uU("en-GB").transform(p,"yyyy/MM/dd"));let v={contract_KeyField:e.id,branch_KeyField:e.branch_KeyField,owner_KeyField:e.owner_KeyField,build_KeyField:e.build_KeyField,unit_KeyField:e.unit_KeyField,customer_KeyField:e.customer_KeyField,INSCode:C+1,INSContractTyps:"I",INSStatus:"N",INSValue:d,INSDueDate:g};yield a.insertInstallment(v)}})()}insertInstallment(e){this.contractService.addInstallments(e).subscribe(a=>{})}saveUpdate(e){this.mapFormvalue_to_ContractClass(),e?(console.log("==========Edit Contract============"),this.contractService.editContract(this.contractForDisplay).subscribe(a=>{let o={contract_KeyField:a.id,TSTArrange:1,branch_KeyField:a.branch_KeyField,owner_KeyField:a.owner_KeyField,build_KeyField:a.build_KeyField,unit_KeyField:a.unit_KeyField,installment_KeyField:null,customer_KeyField:a.customer_KeyField,TSTCreditValue:0,TSTDebitValue:a.RCOContractValue,TSTDate:a.RCOStartDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0627\u0644\u062a\u0639\u0627\u0642\u062f \u0644\u0644\u0639\u0642\u062f \u0631\u0642\u0645 "+a.RCOCode+"/"+a.RCOSubCode,TSTSubject:"RCONTRACT",TSTSubjectID:a.ID};this.contractService.deleteStatementForSubjectID(this.curCOMId,this.account.periorty,"RCONTRACT",a.id).subscribe(n=>{this.contractService.addStatement(o).subscribe(r=>{})}),null!=this.DocImageToUpload&&this.contractService.addContractDocs(this.contractForDisplay.id,this.DocImageToUpload).subscribe(n=>{}),this.contractService.updateCustomerUnitFromContract(this.contractForDisplay.customer_KeyField,this.contractForDisplay.build_KeyField,this.contractForDisplay.unit_KeyField,this.contractForDisplay.id).subscribe(n=>{}),this.snackBar.open("\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0639\u0642\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["contracts/contract-list"])},a=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0639\u0642\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})):(console.log("=====AddContract======"),this.contractService.addContract(this.contractForDisplay).subscribe(a=>{this.contractService.addStatement({contract_KeyField:a.id,TSTArrange:1,branch_KeyField:a.branch_KeyField,owner_KeyField:a.owner_KeyField,build_KeyField:a.build_KeyField,unit_KeyField:a.unit_KeyField,installment_KeyField:null,customer_KeyField:a.customer_KeyField,TSTCreditValue:0,TSTDebitValue:a.RCOContractValue,TSTDate:a.RCOStartDate,TSTDescription:"\u0642\u064a\u0645\u0629 \u0627\u0644\u062a\u0639\u0627\u0642\u062f \u0644\u0644\u0639\u0642\u062f \u0631\u0642\u0645 "+a.RCOCode+"/"+a.RCOSubCode,TSTSubject:"RCONTRACT",TSTSubjectID:a.ID}).subscribe(r=>{}),null!=this.DocImageToUpload&&this.contractService.addContractDocs(a.id,this.DocImageToUpload).subscribe(r=>{}),this.contractService.updateCustomerUnitFromContract(a.customer_KeyField,a.build_KeyField,a.unit_KeyField,a.id).subscribe(r=>{}),this.unitsService.editOneUnit({id:a.unit_KeyField,UNTHousingStatus:"R"}).subscribe(r=>{}),"T"==this.isRenewContract&&this.contractService.editOneContract({id:this.id,RCOContractStatus:"R"}).subscribe(d=>{}),this.handleInstallment(a),this.snackBar.open("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0639\u0642\u062f","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["contracts/contract-add/"+a.id+"/"])},a=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u0627\u0636\u0627\u0641\u0647 \u0627\u0644\u0639\u0642\u062f","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3}),this.router.navigate(["contracts/contract-list"])}))}close(){}addDays(e,a){var o=new Date(e);return o.setDate(o.getDate()+a),o}addMonths(e,a){var o=new Date(e);return o.setMonth(o.getMonth()+a),o}addMonths2(e,a){var o=e.getDate();return e.setMonth(e.getMonth()+ +a),e.getDate()!=o&&e.setDate(0),e}compareFunction(e,a){return e.username==a.username&&e.code==a.code}getOwnershipDocType(e,a){this.codesService.getSubForParent(e,a,this.docType_const).subscribe(o=>{this.DocTypes=o},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0646\u0648\u0627\u0639 \u0645\u0633\u062a\u0646\u062f\u0627\u062a \u0627\u0644\u0645\u0644\u0643\u064a\u0629","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}onChangeContractValue(e){let o=this.form.value.contractValues.RCOPayEveryMonthesNo;0==o&&(o=1),this.form.patchValue({contractValues:{RCOMonthValue:e.target.value/(12/o)}})}onChangePayEvery(e){let o=e.target.value;0==o&&(o=1),this.form.patchValue({contractValues:{RCOMonthValue:this.form.value.contractValues.RCOContractValue/(12/o)}})}onChangeDays(e){if(new c.uU("en-GB").transform(this.form.value.contractEndDate,"dd/MM/yyyy"),null!=this.form.value.contractEndDate){let o=this.form.value.contractEndDate,n=e.target.value;this.paramValueForCode1=n,this.calcAlarmStartDate(o,n)}}onChangeEndDate(e){this.calcAlarmStartDate(e.value,this.paramValueForCode1),this.form.get("contractEndDate").patchValue(e.value)}subtractDays(e,a){var o=new Date(e);return o.setDate(o.getDate()-a),o}calcAlarmStartDate(e,a){var o=this.subtractDays(e,a);this.calcDate=new c.uU("en-GB").transform(o,"yyyy-MM-dd"),this.form.patchValue({RCONoOfDaysForAlarm:this.paramValueForCode1,RCONoOfDaysForEjarAlarm:this.paramValueForCode2}),this.form.get("RCOAlarmStartDate").patchValue(this.calcDate)}getParamValue(e,a,o){this.settingService.getValueForCode(e,a,o).subscribe(n=>{this.parameters=n,1==o&&(this.paramValueForCode1=n[0].APAValue),2==o&&(this.paramValueForCode2=n[0].APAValue),3==o&&(this.paramValueForCode3=n[0].APAValue)},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u062e\u064a\u0627\u0631\u0627\u062a \u0627\u0644\u0646\u0638\u0627\u0645","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getCountries(e,a){this.codesService.getSubForParent(e,a,this.country_const).subscribe(o=>{this.Countries=o},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u062f\u0648\u0644","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getBuildings(e){this.getBuildingPerBranch(this.curCOMId,this.account.periorty,e.value)}getBuildingPerBranch(e,a,o){this.unitsService.getBuildingsPerBranch(e,a,o).subscribe(n=>{this.AllBuilding=n},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0639\u0642\u0627\u0631\u0627\u062a \u0644\u0644\u0641\u0631\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}readBuilding(e){this.unitsService.getOneBuilding(e.value).subscribe(a=>{this.curOwnerId=a.owner_KeyField,console.log("====Cur Owner:: "+this.curOwnerId+"  "+a.owner_FullName),this.form.patchValue({contractPerson:{owner_KeyField:this.curOwnerId}}),this.getRepresentativePerOwner(this.curCOMId,this.account.periorty,this.curOwnerId)},a=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0639\u0642\u0627\u0631","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}),this.getUnitsPerBuilding(this.curCOMId,this.account.periorty,e.value,"E")}getUnitsPerBuilding(e,a,o,n){this.unitsService.getAllUnitsPerBuilding(e,a,o,n).subscribe(r=>{this.AllUnitsForBuilding=r},r=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0648\u062d\u062f\u0627\u062a \u0644\u0644\u0639\u0642\u0627\u0631","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}readUnit(e){e.value&&this.unitsService.getOneUnit(e.value).subscribe(a=>{this.form.patchValue({contractValues:{RCOContractValue:a.UNTContractValue,RCOPayEveryMonthesNo:a.UNTPayInstallmentEveryMonths,RCOMonthValue:a.UNTContractValue/(12/a.UNTPayInstallmentEveryMonths),RCOInsuranceValue:a.UNTInsuranceValue,RCOSeekingValue:a.UNTSeekingValue,RCOMonthlyExpense:a.UNTMonthlyExpense,RCOExpenseDesc:a.UNTExpenseDesc,RCOOtherValue:a.UNTOtherValue,RCOMonthlyElectricValue:a.UNTMonthlyElectricityFee,RCOElectricCounterReading:a.UNTLastElectricityReading,RCOMonthlyWaterValue:a.UNTMonthlyWaterFee,RCOWaterCounterReading:a.UNTLastWaterReading,RCOMonthlyGasValue:a.UNTMonthlyGasFee,RCOGasCounterReading:a.UNTLastGasReading}})},a=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0648\u062d\u062f\u0629","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}readUnitById(e){e&&this.unitsService.getOneUnit(e).subscribe(a=>{this.form.patchValue({contractValues:{RCOContractValue:a.UNTContractValue,RCOPayEveryMonthesNo:a.UNTPayInstallmentEveryMonths,RCOMonthValue:a.UNTContractValue/(12/a.UNTPayInstallmentEveryMonths),RCOInsuranceValue:a.UNTInsuranceValue,RCOSeekingValue:a.UNTSeekingValue,RCOMonthlyExpense:a.UNTMonthlyExpense,RCOExpenseDesc:a.UNTExpenseDesc,RCOOtherValue:a.UNTOtherValue,RCOMonthlyElectricValue:a.UNTMonthlyElectricityFee,RCOElectricCounterReading:a.UNTLastElectricityReading,RCOMonthlyWaterValue:a.UNTMonthlyWaterFee,RCOWaterCounterReading:a.UNTLastWaterReading,RCOMonthlyGasValue:a.UNTMonthlyGasFee,RCOGasCounterReading:a.UNTLastGasReading}})},a=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0648\u062d\u062f\u0629","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getRepresentativePerOwner(e,a,o){this.contractService.getOwnersPerParent(e,a,o).subscribe(n=>{this.AllRepresentativeForOwner=n},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0645\u0645\u062b\u0644 \u0627\u0644\u0645\u0627\u0644\u0643","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}readOwner(e){console.log("====Selected readOwner:: "+e.value),this.getRepresentativePerOwner(this.curCOMId,this.account.periorty,e.value)}getAllBranches(e,a){this.atlasService.getAllBranch(e,a).subscribe(o=>{this.AllBranches=o},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0641\u0631\u0648\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getAllOwnerss(e,a){this.contractService.getAllOwners(e,a).subscribe(o=>{this.AllOwners=o},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0645\u0644\u0627\u0643","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}readCustumer(e){console.log("====Selected readCustumer:: "+e),this.tenantsService.getOneCustomer(e).subscribe(a=>{console.log("====Selected branch:: "+a.current_branch),console.log("====Selected building:: "+a.current_building),console.log("====Selected unit:: "+a.current_unit),a.current_unit&&(this.form.patchValue({contractUnit:{branch_KeyField:a.current_branch,build_KeyField:a.current_building,unit_KeyField:a.current_unit}}),this.getBuildingPerBranch(this.curCOMId,this.account.periorty,a.current_branch),this.getUnitsPerBuilding(this.curCOMId,this.account.periorty,a.current_building,"E"),this.readUnitById(a.current_unit))},a=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0623\u062c\u0631","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}),this.getRepresentativePerCustomer(this.curCOMId,this.account.periorty,e)}getRepresentativePerCustomer(e,a,o){this.tenantsService.getCustomersPerParent(e,a,o).subscribe(n=>{this.AllRepresentativeForCustomer=n},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0645\u0645\u062b\u0644 \u0627\u0644\u0645\u0633\u062a\u0623\u062c\u0631","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getTenants(){this.AllTenants=null,this.tenantsService.getCustomersConfirmed(this.curCOMId,this.account.periorty).subscribe(e=>this.AllTenants=e)}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(e=>{this.errorRetrieveMsg=e}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(e=>{this.askToDeletedMsg=e}),this.translateService.get("MESSAGE.DELETED").subscribe(e=>{this.deletedMsg=e})}}I.\u0275fac=function(e){return new(e||I)(t.Y36(T.gz),t.Y36(ut.d),t.Y36(at.X),t.Y36(tt.W),t.Y36(s.QS),t.Y36(b.C),t.Y36(T.F0),t.Y36(F.U),t.Y36(f.sK),t.Y36(W.Z),t.Y36(oe.g),t.Y36(L.v),t.Y36(U.ux))},I.\u0275cmp=t.Xpm({type:I,selectors:[["app-contract-dialog"]],decls:304,vars:183,consts:[["mat-dialog-title","",4,"ngIf"],[1,"user-form",3,"formGroup"],[1,"vertical-tabs","tab-content-wrapped",3,"backgroundColor","color"],[3,"label"],["fxLayout","column",1,"form-field-outer"],["fxLayout","column","fxLayoutGap","10px grid"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["fxFlex","100","fxFlex.gt-sm","27.0",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","RCOCode"],["fxFlex","100","fxFlex.gt-sm","22.8",1,"px-1"],["matInput","","formControlName","RCOSubCode"],["fxFlex","100","fxFlex.gt-sm","50.0",1,"px-1"],["matInput","","formControlName","contractDate",3,"matDatepicker"],["matSuffix","",3,"for"],["contractDate",""],["fxFlex","100","fxFlex.gt-sm","49.8",1,"px-1"],["matInput","","formControlName","contractStartDate",3,"matDatepicker"],["contractStartDate",""],["matInput","","formControlName","contractEndDate",3,"matDatepicker","dateChange"],["contractEndDate",""],["fxFlex","100","fxFlex.gt-sm","33.3",1,"px-1"],["formControlName","RCOContractStatus","id","contStatusOpSel",3,"placeholder"],[3,"value"],["matInput","","formControlName","RCOEjarCode"],["matInput","","type","date","formControlName","RCOAlarmStartDate",1,"form-control"],["matInput","","formControlName","RCONoOfDaysForAlarm",3,"change"],["matInput","","formControlName","RCONoOfDaysForEjarAlarm"],["matInput","","formControlName","RCOAlarmCounter"],["formGroupName","contractPerson",3,"label"],["fxFlex","100","fxFlex.gt-sm","59.8",1,"px-1"],["formControlName","owner_KeyField","id","oneOwnerOpSel",3,"placeholder","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","100","fxFlex.gt-sm","39.8",1,"px-1"],["formControlName","owner_representative_KeyField","id","oneOwnerRepresOpSel",3,"placeholder"],["fxLayout","row wrap"],["appearance","outline","formControlName","customer_KeyField","id","oneCustomOpSel",1,"w-100",3,"placeholder","change"],["formControlName","customer_representative_KeyField","id","CustomRepsOpSel",3,"placeholder"],["formGroupName","contractUnit",3,"label"],["formControlName","branch_KeyField","id","branchContOpSel",3,"placeholder","selectionChange"],["formControlName","build_KeyField","id","buildOneOpSel",3,"placeholder","selectionChange"],["formControlName","unit_KeyField","id","unitOneOpSel",3,"placeholder","selectionChange"],["formGroupName","contractValues",3,"label"],["matInput","","formControlName","RCOContractValue","required","",3,"change"],["matInput","","formControlName","RCOPayEveryMonthesNo","required","",3,"change"],["matInput","","formControlName","RCOMonthValue","required",""],["fxFlex","100","fxFlex.gt-sm","24.9",1,"px-1"],["matInput","","formControlName","RCOInsuranceValue"],["matInput","","formControlName","RCOSeekingValue"],["matInput","","formControlName","RCOMonthlyExpense"],["matInput","","formControlName","RCOOtherValue"],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","RCOExpenseDesc"],["matInput","","formControlName","RCOMonthlyElectricValue"],["matInput","","formControlName","RCOElectricCounterReading"],["matInput","","formControlName","RCOMonthlyWaterValue"],["matInput","","formControlName","RCOWaterCounterReading"],["matInput","","formControlName","RCOMonthlyGasValue"],["matInput","","formControlName","RCOGasCounterReading"],["formGroupName","settings",3,"label"],["formControlName","isActive"],["formControlName","isDeleted"],["formGroupName","docs",3,"label"],["fxFlex","100","fxFlex.gt-sm","100",1,"px-2"],[1,"p-2"],[2,"width","150px","height","200px",3,"src"],["hidden","","formControlName","docOnePic","name","docOnePic","id","uploadonedoc","type","file","accept","image/*",1,"user-img",3,"change"],["fileInput",""],["type","button","mat-raised-button","",3,"click"],["formControlName","docPic","fileAccept","image/*"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click",4,"ngIf"],["mat-dialog-title",""],[4,"ngIf"],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click"]],template:function(e,a){if(1&e){const o=t.EpF();t.YNc(0,ne,3,3,"h1",0),t.YNc(1,le,5,5,"h1",0),t.TgZ(2,"form",1)(3,"mat-tab-group",2)(4,"mat-tab",3),t.ALo(5,"translate"),t.TgZ(6,"div",4)(7,"div",5),t._UZ(8,"mat-label"),t.TgZ(9,"div",6)(10,"div",7)(11,"mat-form-field",8)(12,"mat-label"),t._uU(13),t.ALo(14,"translate"),t.qZA(),t._UZ(15,"input",9),t.qZA()(),t.TgZ(16,"div",10)(17,"mat-form-field",8)(18,"mat-label"),t._uU(19),t.ALo(20,"translate"),t.qZA(),t._UZ(21,"input",11),t.qZA()(),t.TgZ(22,"div",12)(23,"mat-form-field",8)(24,"mat-label"),t._uU(25),t.ALo(26,"translate"),t.qZA(),t._UZ(27,"input",13)(28,"mat-datepicker-toggle",14)(29,"mat-datepicker",null,15),t.qZA()()()(),t.TgZ(31,"div",6)(32,"div",16)(33,"mat-form-field",8)(34,"mat-label"),t._uU(35),t.ALo(36,"translate"),t.qZA(),t._UZ(37,"input",17)(38,"mat-datepicker-toggle",14)(39,"mat-datepicker",null,18),t.qZA()(),t.TgZ(41,"div",16)(42,"mat-form-field",8)(43,"mat-label"),t._uU(44),t.ALo(45,"translate"),t.qZA(),t.TgZ(46,"input",19),t.NdJ("dateChange",function(r){return a.onChangeEndDate(r)}),t.qZA(),t._UZ(47,"mat-datepicker-toggle",14)(48,"mat-datepicker",null,20),t.qZA()()(),t.TgZ(50,"div",6)(51,"div",21)(52,"mat-form-field",8)(53,"mat-label"),t._uU(54),t.ALo(55,"translate"),t.qZA(),t.TgZ(56,"mat-select",22),t.ALo(57,"translate"),t.TgZ(58,"mat-option",23),t._uU(59,"-"),t.qZA(),t.TgZ(60,"mat-option",23),t._uU(61),t.ALo(62,"translate"),t.qZA(),t.TgZ(63,"mat-option",23),t._uU(64),t.ALo(65,"translate"),t.qZA(),t.TgZ(66,"mat-option",23),t._uU(67),t.ALo(68,"translate"),t.qZA(),t.TgZ(69,"mat-option",23),t._uU(70),t.ALo(71,"translate"),t.qZA()()()(),t.TgZ(72,"div",21)(73,"mat-form-field",8)(74,"mat-label"),t._uU(75),t.ALo(76,"translate"),t.qZA(),t._UZ(77,"input",24),t.qZA()(),t.TgZ(78,"div",21)(79,"mat-form-field",8)(80,"mat-label"),t._uU(81),t.ALo(82,"translate"),t.qZA(),t._UZ(83,"input",25),t.qZA()()(),t.TgZ(84,"div",6)(85,"div",21)(86,"mat-form-field",8)(87,"mat-label"),t._uU(88),t.ALo(89,"translate"),t.qZA(),t.TgZ(90,"input",26),t.NdJ("change",function(r){return a.onChangeDays(r)}),t.qZA()()(),t.TgZ(91,"div",21)(92,"mat-form-field",8)(93,"mat-label"),t._uU(94),t.ALo(95,"translate"),t.qZA(),t._UZ(96,"input",27),t.qZA()(),t.TgZ(97,"div",21)(98,"mat-form-field",8)(99,"mat-label"),t._uU(100),t.ALo(101,"translate"),t.qZA(),t._UZ(102,"input",28),t.qZA()()()()(),t.TgZ(103,"mat-tab",29),t.ALo(104,"translate"),t.TgZ(105,"div",4)(106,"div",5),t._UZ(107,"mat-label"),t.TgZ(108,"div",6)(109,"div",30)(110,"mat-form-field",8)(111,"mat-label"),t._uU(112),t.ALo(113,"translate"),t.qZA(),t.TgZ(114,"mat-select",31),t.NdJ("selectionChange",function(r){return a.readOwner(r)}),t.ALo(115,"translate"),t.TgZ(116,"mat-option",23),t._uU(117,"-"),t.qZA(),t.YNc(118,ce,2,2,"mat-option",32),t.qZA()()(),t.TgZ(119,"div",33)(120,"mat-form-field",8)(121,"mat-label"),t._uU(122),t.ALo(123,"translate"),t.qZA(),t.TgZ(124,"mat-select",34),t.ALo(125,"translate"),t.TgZ(126,"mat-option",23),t._uU(127,"-"),t.qZA(),t.YNc(128,ue,2,2,"mat-option",32),t.qZA()()()(),t.TgZ(129,"div",35)(130,"div",30)(131,"label"),t._uU(132),t.ALo(133,"translate"),t.qZA(),t.TgZ(134,"ng-select",36),t.NdJ("change",function(r){return a.readCustumer(r)}),t.ALo(135,"translate"),t.YNc(136,me,2,2,"ng-option",32),t.qZA()(),t.TgZ(137,"div",33)(138,"mat-form-field",8)(139,"mat-label"),t._uU(140),t.ALo(141,"translate"),t.qZA(),t.TgZ(142,"mat-select",37),t.ALo(143,"translate"),t.TgZ(144,"mat-option",23),t._uU(145,"-"),t.qZA(),t.YNc(146,de,2,2,"mat-option",32),t.qZA()()()()()()(),t.TgZ(147,"mat-tab",38),t.ALo(148,"translate"),t.TgZ(149,"div",4)(150,"div",5),t._UZ(151,"mat-label"),t.TgZ(152,"div",6)(153,"div",12)(154,"mat-form-field",8)(155,"mat-label"),t._uU(156),t.ALo(157,"translate"),t.qZA(),t.TgZ(158,"mat-select",39),t.NdJ("selectionChange",function(r){return a.getBuildings(r)}),t.ALo(159,"translate"),t.TgZ(160,"mat-option",23),t._uU(161,"-"),t.qZA(),t.YNc(162,pe,2,2,"mat-option",32),t.qZA()()()(),t.TgZ(163,"div",6)(164,"div",16)(165,"mat-form-field",8)(166,"mat-label"),t._uU(167),t.ALo(168,"translate"),t.qZA(),t.TgZ(169,"mat-select",40),t.NdJ("selectionChange",function(r){return a.readBuilding(r)}),t.ALo(170,"translate"),t.TgZ(171,"mat-option",23),t._uU(172,"-"),t.qZA(),t.YNc(173,he,2,2,"mat-option",32),t.qZA()()(),t.TgZ(174,"div",16)(175,"mat-form-field",8)(176,"mat-label"),t._uU(177),t.ALo(178,"translate"),t.qZA(),t.TgZ(179,"mat-select",41),t.NdJ("selectionChange",function(r){return a.readUnit(r)}),t.ALo(180,"translate"),t.TgZ(181,"mat-option",23),t._uU(182,"-"),t.qZA(),t.YNc(183,ge,2,2,"mat-option",32),t.qZA()()()()()()(),t.TgZ(184,"mat-tab",42),t.ALo(185,"translate"),t.TgZ(186,"div",4)(187,"div",5),t._UZ(188,"mat-label"),t.TgZ(189,"div",6)(190,"div",21)(191,"mat-form-field",8)(192,"mat-label"),t._uU(193),t.ALo(194,"translate"),t.qZA(),t.TgZ(195,"input",43),t.NdJ("change",function(r){return a.onChangeContractValue(r)}),t.qZA()()(),t.TgZ(196,"div",21)(197,"mat-form-field",8)(198,"mat-label"),t._uU(199),t.ALo(200,"translate"),t.qZA(),t.TgZ(201,"input",44),t.NdJ("change",function(r){return a.onChangePayEvery(r)}),t.qZA()()(),t.TgZ(202,"div",21)(203,"mat-form-field",8)(204,"mat-label"),t._uU(205),t.ALo(206,"translate"),t.qZA(),t._UZ(207,"input",45),t.qZA()()()(),t.TgZ(208,"div",6)(209,"div",46)(210,"mat-form-field",8)(211,"mat-label"),t._uU(212),t.ALo(213,"translate"),t.qZA(),t._UZ(214,"input",47),t.qZA()(),t.TgZ(215,"div",46)(216,"mat-form-field",8)(217,"mat-label"),t._uU(218),t.ALo(219,"translate"),t.qZA(),t._UZ(220,"input",48),t.qZA()(),t.TgZ(221,"div",46)(222,"mat-form-field",8)(223,"mat-label"),t._uU(224),t.ALo(225,"translate"),t.qZA(),t._UZ(226,"input",49),t.qZA()(),t.TgZ(227,"div",46)(228,"mat-form-field",8)(229,"mat-label"),t._uU(230),t.ALo(231,"translate"),t.qZA(),t._UZ(232,"input",50),t.qZA()()(),t.TgZ(233,"div",6)(234,"div",51)(235,"mat-form-field",8)(236,"mat-label"),t._uU(237),t.ALo(238,"translate"),t.qZA(),t._UZ(239,"input",52),t.qZA()()(),t.TgZ(240,"div",6)(241,"div",16)(242,"mat-form-field",8)(243,"mat-label"),t._uU(244),t.ALo(245,"translate"),t.qZA(),t._UZ(246,"input",53),t.qZA()(),t.TgZ(247,"div",16)(248,"mat-form-field",8)(249,"mat-label"),t._uU(250),t.ALo(251,"translate"),t.qZA(),t._UZ(252,"input",54),t.qZA()()(),t.TgZ(253,"div",6)(254,"div",16)(255,"mat-form-field",8)(256,"mat-label"),t._uU(257),t.ALo(258,"translate"),t.qZA(),t._UZ(259,"input",55),t.qZA()(),t.TgZ(260,"div",16)(261,"mat-form-field",8)(262,"mat-label"),t._uU(263),t.ALo(264,"translate"),t.qZA(),t._UZ(265,"input",56),t.qZA()()(),t.TgZ(266,"div",6)(267,"div",16)(268,"mat-form-field",8)(269,"mat-label"),t._uU(270),t.ALo(271,"translate"),t.qZA(),t._UZ(272,"input",57),t.qZA()(),t.TgZ(273,"div",16)(274,"mat-form-field",8)(275,"mat-label"),t._uU(276),t.ALo(277,"translate"),t.qZA(),t._UZ(278,"input",58),t.qZA()()()()(),t.TgZ(279,"mat-tab",59),t.ALo(280,"translate"),t.TgZ(281,"div",4)(282,"mat-checkbox",60),t._uU(283),t.ALo(284,"translate"),t.qZA(),t.TgZ(285,"mat-checkbox",61),t._uU(286),t.ALo(287,"translate"),t.qZA()()(),t.TgZ(288,"mat-tab",62),t.ALo(289,"translate"),t.TgZ(290,"div",63)(291,"div",64),t._UZ(292,"img",65),t.TgZ(293,"input",66,67),t.NdJ("change",function(r){return a.onFileChange(r.target.files)}),t.qZA(),t.TgZ(295,"button",68),t.NdJ("click",function(){t.CHM(o);const r=t.MAs(294);return t.KtG(r.click())}),t._uU(296),t.ALo(297,"translate"),t.qZA()(),t._UZ(298,"mat-divider")(299,"input-file",69),t.qZA()()()(),t._UZ(300,"br"),t.TgZ(301,"div",70)(302,"div",6),t.YNc(303,_e,3,4,"button",71),t.qZA()()}if(2&e){const o=t.MAs(30),n=t.MAs(40),r=t.MAs(49);t.Q6J("ngIf","T"==a.isRenewContract),t.xp6(1),t.Q6J("ngIf","T"!=a.isRenewContract),t.xp6(1),t.Q6J("formGroup",a.form),t.xp6(1),t.Q6J("backgroundColor","primary")("color","warn"),t.xp6(1),t.s9C("label",t.lcZ(5,77,"HTML.TAB_BASIC")),t.xp6(9),t.hij(" ",t.lcZ(14,79,"HTML.CODE"),""),t.xp6(6),t.hij(" ",t.lcZ(20,81,"HTML.SUBCODE"),""),t.xp6(6),t.Oqu(t.lcZ(26,83,"HTML.ContractDate")),t.xp6(2),t.Q6J("matDatepicker",o),t.xp6(1),t.Q6J("for",o),t.xp6(7),t.Oqu(t.lcZ(36,85,"HTML.ContractStartDate")),t.xp6(2),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(6),t.Oqu(t.lcZ(45,87,"HTML.ContractEndDate")),t.xp6(2),t.Q6J("matDatepicker",r),t.xp6(1),t.Q6J("for",r),t.xp6(7),t.Oqu(t.lcZ(55,89,"HTML.ContractStatus")),t.xp6(2),t.s9C("placeholder",t.lcZ(57,91,"HTML.ContractStatus")),t.xp6(4),t.Q6J("value","N"),t.xp6(1),t.Oqu(t.lcZ(62,93,"OPTIONS.NEW")),t.xp6(2),t.Q6J("value","R"),t.xp6(1),t.Oqu(t.lcZ(65,95,"OPTIONS.ReNew")),t.xp6(2),t.Q6J("value","C"),t.xp6(1),t.Oqu(t.lcZ(68,97,"OPTIONS.Canceld")),t.xp6(2),t.Q6J("value","F"),t.xp6(1),t.Oqu(t.lcZ(71,99,"OPTIONS.Finished")),t.xp6(5),t.Oqu(t.lcZ(76,101,"HTML.ContractEjarCode")),t.xp6(6),t.Oqu(t.lcZ(82,103,"HTML.ContractAlarmStartDate")),t.xp6(7),t.hij(" ",t.lcZ(89,105,"HTML.ContractNoOfDaysForAlarm"),""),t.xp6(6),t.hij(" ",t.lcZ(95,107,"HTML.ContractNoOfDaysForEjarAlarm"),""),t.xp6(6),t.hij(" ",t.lcZ(101,109,"HTML.ContractAlarmCounter"),""),t.xp6(3),t.s9C("label",t.lcZ(104,111,"HTML.TAB_ContractPersons")),t.xp6(9),t.hij(" ",t.lcZ(113,113,"HTML.OWNER"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(115,115,"HTML.OWNER")),t.xp6(4),t.Q6J("ngForOf",a.AllOwners),t.xp6(4),t.hij(" ",t.lcZ(123,117,"HTML.OwnerRepresentative"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(125,119,"HTML.OwnerRepresentative")),t.xp6(4),t.Q6J("ngForOf",a.AllRepresentativeForOwner),t.xp6(4),t.hij(" ",t.lcZ(133,121,"HTML.TENANT"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(135,123,"HTML.TENANT")),t.xp6(2),t.Q6J("ngForOf",a.AllTenants),t.xp6(4),t.hij(" ",t.lcZ(141,125,"HTML.TenantRepresentative"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(143,127,"HTML.TenantRepresentative")),t.xp6(4),t.Q6J("ngForOf",a.AllRepresentativeForCustomer),t.xp6(1),t.s9C("label",t.lcZ(148,129,"HTML.TAB_ContractUnit")),t.xp6(9),t.hij(" ",t.lcZ(157,131,"HTML.BRANCH"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(159,133,"HTML.BRANCH")),t.xp6(4),t.Q6J("ngForOf",a.AllBranches),t.xp6(5),t.hij(" ",t.lcZ(168,135,"HTML.BUILDING"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(170,137,"HTML.BUILDING")),t.xp6(4),t.Q6J("ngForOf",a.AllBuilding),t.xp6(4),t.hij(" ",t.lcZ(178,139,"HTML.UNIT"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(180,141,"HTML.UNIT")),t.xp6(4),t.Q6J("ngForOf",a.AllUnitsForBuilding),t.xp6(1),t.s9C("label",t.lcZ(185,143,"HTML.TAB_ContractValues")),t.xp6(9),t.Oqu(t.lcZ(194,145,"HTML.ContractValue")),t.xp6(6),t.Oqu(t.lcZ(200,147,"HTML.PayEveryMonthesNo")),t.xp6(6),t.Oqu(t.lcZ(206,149,"HTML.InstallmentValue")),t.xp6(7),t.Oqu(t.lcZ(213,151,"HTML.InsuranceValue")),t.xp6(6),t.Oqu(t.lcZ(219,153,"HTML.SeekingValue")),t.xp6(6),t.Oqu(t.lcZ(225,155,"HTML.MonthlyExpense")),t.xp6(6),t.Oqu(t.lcZ(231,157,"HTML.OtherValue")),t.xp6(7),t.Oqu(t.lcZ(238,159,"HTML.ExpenseDesc")),t.xp6(7),t.Oqu(t.lcZ(245,161,"HTML.MonthlyElectricValue")),t.xp6(6),t.Oqu(t.lcZ(251,163,"HTML.ElectricCounterReading")),t.xp6(7),t.Oqu(t.lcZ(258,165,"HTML.MonthlyWaterValue")),t.xp6(6),t.Oqu(t.lcZ(264,167,"HTML.WaterCounterReading")),t.xp6(7),t.Oqu(t.lcZ(271,169,"HTML.MonthlyGasValue")),t.xp6(6),t.Oqu(t.lcZ(277,171,"HTML.GasCounterReading")),t.xp6(3),t.s9C("label",t.lcZ(280,173,"HTML.TAB_SETTINGS")),t.xp6(4),t.Oqu(t.lcZ(284,175,"HTML.ACTIVE")),t.xp6(3),t.Oqu(t.lcZ(287,177,"HTML.BLOCKED")),t.xp6(2),t.s9C("label",t.lcZ(289,179,"HTML.TAB_DOCS")),t.xp6(4),t.Q6J("src",a.defaultDocImage,t.LSH),t.xp6(4),t.Oqu(t.lcZ(297,181,"HTML.AddPic")),t.xp6(7),t.Q6J("ngIf",a.can("change_rentcontracts"))}},dependencies:[s._Y,s.Fj,s.JJ,s.JL,s.Q7,c.sg,c.O5,s.sg,s.u,s.x0,u.xw,u.SQ,u.Wh,u.yH,w.ey,_.lW,mt.oG,y.Mq,y.hl,y.nW,m.ZT,m.uh,m.H8,D.Nt,h.KE,h.hX,h.R9,x.d,E.gD,et.uX,et.SP,it.tW,ot.w9,ot.jq,f.X$],styles:[".user-form .form-field-outer{width:680px}.user-form .mat-mdc-radio-button{margin-right:12px}.container{background-color:var(--backgroundColorContainer);border-right:2px solid var(--backgroundColorContainerBorder)}\n"],encapsulation:2});var Te=l(529),Ze=l(589),ve=l(9045),Ae=l(7948);class be{}var ye=l(900);function Se(i,e){if(1&i&&(t.TgZ(0,"mat-option",19),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.value),t.xp6(1),t.hij(" ",a.name," ")}}function Ue(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.onSave())}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA()()}if(2&i){const a=t.oxw();t.Q6J("disabled",!a.dataForm.valid),t.xp6(2),t.Oqu(t.lcZ(3,2,"BTN.SAVE"))}}function Oe(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(a);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.remove(n.id))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()}2&i&&t.s9C("matTooltip",t.lcZ(1,1,"BTN.REMOVE"))}function xe(i,e){if(1&i&&(t.TgZ(0,"div",21)(1,"div",22),t._uU(2),t.qZA(),t.TgZ(3,"div",22),t._uU(4),t.qZA(),t.TgZ(5,"div",22),t._uU(6),t.qZA(),t.TgZ(7,"div",22)(8,"div",23),t.YNc(9,Oe,4,3,"button",24),t.qZA()()()),2&i){const a=e.$implicit,o=t.oxw();t.xp6(2),t.Oqu(a.CURRelationTypeDisplay),t.xp6(2),t.Oqu(a.CURName),t.xp6(2),t.hij("",a.CURMobile," "),t.xp6(3),t.Q6J("ngIf",o.can("delete_tenantrelative"))}}class V{constructor(e,a,o,n,r,d,p,g,C,v){this.dialogRef=e,this.dataInjected=a,this.atlasService=o,this._CustomerService=n,this.translateService=r,this.localStore=d,this.appService=p,this.dialog=g,this.snackBar=C,this.fb=v,this.passwordHide=!0,this.relatives=[],this.curCOMId=S.N.comid,this.userPerm=[]}ngOnInit(){this.relatives=this.appService.getRelative(),this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let e=0;e<this.curUserPermissions.length;e++)this.userPerm[e]=this.curUserPermissions[e].codename;this.dataForm=this.fb.group({customer_KeyField:[null,s.kI.required],CURRelationType:[null,s.kI.required],CURName:[null,s.kI.required],CURMobile:null,CURPic:null}),console.log(this.dataInjected.custId),this.dataForm.patchValue({customer_KeyField:this.dataInjected.custId}),this.oneRelated=new be,this.curPeriority=this.dataInjected.periorty,this.action="Patch",this.getTenantRelated(),this.prepareMsgLanguage()}can(e){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(e))}getTenantRelated(){this.cusRelated=null,this._CustomerService.getRelatedPerCustomers(this.curCOMId,this.curPeriority,this.dataInjected.custId).subscribe(e=>this.cusRelated=e)}mapFormValue_toTable(){this.oneRelated.customer_KeyField=this.dataInjected.custId,this.oneRelated.CURRelationType=this.dataForm.value.CURRelationType,this.oneRelated.CURName=this.dataForm.value.CURName,this.oneRelated.CURMobile=this.dataForm.value.CURMobile}onSave(){this.mapFormValue_toTable(),this._CustomerService.addRelatedForTenant(this.oneRelated).subscribe(()=>{this.snackBar.open(this.dataSavedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getTenantRelated()})}close(){this.action="Cancel",console.log("===***Press Close button***==="),this.dialogRef.close({event:this.action})}remove(e){this.dialog.open(P.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(o=>{o&&this._CustomerService.deleteRelativeForTenant(e).subscribe(()=>{this.snackBar.open(this.deletedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getTenantRelated()})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.DataSaved").subscribe(e=>{this.dataSavedMsg=e}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(e=>{this.askToDeletedMsg=e}),this.translateService.get("MESSAGE.DELETED").subscribe(e=>{this.deletedMsg=e}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(e=>{this.deletedTitleMsg=e})}}V.\u0275fac=function(e){return new(e||V)(t.Y36(m.so),t.Y36(m.WI),t.Y36(W.Z),t.Y36(L.v),t.Y36(f.sK),t.Y36(b.C),t.Y36(ye.z),t.Y36(m.uw),t.Y36(U.ux),t.Y36(s.QS))},V.\u0275cmp=t.Xpm({type:V,selectors:[["app-cus-related-dialog"]],decls:54,vars:31,consts:[["autocomplete","off",3,"formGroup"],["mat-dialog-content",""],["fxLayout","row wrap"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["fxFlex","100","fxFlex.gt-sm","33.3",1,"px-1"],["appearance","outline",1,"w-100"],["formControlName","CURRelationType","required","",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","CURName"],["matInput","","formControlName","CURMobile"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],[1,"p-2"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],[3,"value"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","warn","class","mx-1",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","warn",1,"mx-1",3,"matTooltip","click"]],template:function(e,a){1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"mat-select",6),t.ALo(10,"translate"),t.YNc(11,Se,2,2,"mat-option",7),t.qZA()()(),t.TgZ(12,"div",4)(13,"mat-form-field",5)(14,"mat-label"),t._uU(15),t.ALo(16,"translate"),t.qZA(),t._UZ(17,"input",8),t.qZA()(),t.TgZ(18,"div",4)(19,"mat-form-field",5)(20,"mat-label"),t._uU(21),t.ALo(22,"translate"),t.qZA(),t._UZ(23,"input",9),t.qZA()()()()(),t.TgZ(24,"div",10)(25,"div",3),t.YNc(26,Ue,4,4,"button",11),t.TgZ(27,"button",12),t.NdJ("click",function(){return a.close()}),t._uU(28),t.ALo(29,"translate"),t.qZA()()(),t._UZ(30,"mat-divider"),t.TgZ(31,"div",13)(32,"mat-card")(33,"div",14)(34,"h2"),t._uU(35),t.ALo(36,"translate"),t.qZA()(),t._UZ(37,"mat-divider"),t.TgZ(38,"div",15)(39,"div",16)(40,"div",17)(41,"h2"),t._uU(42),t.ALo(43,"translate"),t.qZA()(),t.TgZ(44,"div",17)(45,"h2"),t._uU(46),t.ALo(47,"translate"),t.qZA()(),t.TgZ(48,"div",17)(49,"h2"),t._uU(50),t.ALo(51,"translate"),t.qZA()(),t._UZ(52,"div",17),t.qZA(),t.YNc(53,xe,10,4,"div",18),t.qZA()()()()),2&e&&(t.Q6J("formGroup",a.dataForm),t.xp6(7),t.hij(" ",t.lcZ(8,13,"HTML.Relative"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(10,15,"HTML.Relative")),t.xp6(2),t.Q6J("ngForOf",a.relatives),t.xp6(4),t.Oqu(t.lcZ(16,17,"FIELD.NAME")),t.xp6(6),t.Oqu(t.lcZ(22,19,"HTML.MOBILE")),t.xp6(5),t.Q6J("ngIf",a.can("add_tenantrelative")),t.xp6(2),t.Oqu(t.lcZ(29,21,"BTN.CANCEL")),t.xp6(7),t.Oqu(t.lcZ(36,23,"HTML.Relative")),t.xp6(7),t.hij(" ",t.lcZ(43,25,"HTML.Relative")," "),t.xp6(4),t.hij(" ",t.lcZ(47,27,"FIELD.NAME")," "),t.xp6(4),t.hij(" ",t.lcZ(51,29,"HTML.MOBILE")," "),t.xp6(3),t.Q6J("ngForOf",a.cusRelated))},dependencies:[s._Y,s.Fj,s.JJ,s.JL,s.Q7,c.sg,c.O5,s.sg,s.u,u.xw,u.Wh,u.yH,w.ey,_.lW,_.nh,K.a8,m.xY,m.H8,B.Hw,D.Nt,h.KE,h.hX,x.d,E.gD,z.gM,f.X$],styles:[".user-form[_ngcontent-%COMP%]   .form-field-outer[_ngcontent-%COMP%]{width:680px}.user-form[_ngcontent-%COMP%]   .mat-mdc-radio-button[_ngcontent-%COMP%]{margin-right:12px}.auth[_ngcontent-%COMP%]{white-space:nowrap;padding:7px 14px;font-weight:500}"]});var dt=l(1948);function Ie(i,e){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"BTN.ADD")))}function De(i,e){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"BTN.EDIT")))}function Ne(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Code is required"),t.qZA())}function Re(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Code isn't long enough, minimum of 4 characters"),t.qZA())}function Le(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Password is required"),t.qZA())}function Fe(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Password isn't long enough, minimum of 6 characters"),t.qZA())}function Me(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"mat-form-field",51)(1,"mat-label")(2,"mat-icon"),t._uU(3,"vpn_key"),t.qZA(),t._uU(4),t.ALo(5,"translate"),t.qZA(),t._UZ(6,"input",76),t.TgZ(7,"mat-icon",77),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.passwordHide=!n.passwordHide)}),t._uU(8),t.qZA(),t.YNc(9,Le,2,0,"mat-error",1),t.YNc(10,Fe,2,0,"mat-error",1),t.qZA()}if(2&i){const a=t.oxw();t.xp6(4),t.hij(" ",t.lcZ(5,5,"HTML.PASSWORD"),""),t.xp6(2),t.Q6J("type",a.passwordHide?"password":"text"),t.xp6(2),t.Oqu(a.passwordHide?"visibility":"visibility_off"),t.xp6(1),t.Q6J("ngIf",null==a.form.controls.password.errors?null:a.form.controls.password.errors.required),t.xp6(1),t.Q6J("ngIf",a.form.controls.password.hasError("minlength"))}}function qe(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"First name is required"),t.qZA())}function we(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Last name is required"),t.qZA())}function Ee(i,e){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Mobile is required"),t.qZA())}function Pe(i,e){if(1&i&&(t.TgZ(0,"mat-option",36),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.BRAArbName," ")}}function ke(i,e){if(1&i&&(t.TgZ(0,"mat-option",36),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.BUIName," ")}}function Ke(i,e){if(1&i&&(t.TgZ(0,"mat-option",36),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.UNTUnitNumber," ")}}function Be(i,e){if(1&i&&(t.TgZ(0,"mat-option",36),t._uU(1),t.qZA()),2&i){const a=e.$implicit;t.Q6J("value",a.id),t.xp6(1),t.hij(" ",a.CTTSubjectName," ")}}function He(i,e){1&i&&(t.TgZ(0,"mat-tab",78),t.ALo(1,"translate"),t.TgZ(2,"div",5)(3,"mat-checkbox",79),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"mat-checkbox",80),t._uU(7),t.ALo(8,"translate"),t.qZA()()()),2&i&&(t.s9C("label",t.lcZ(1,3,"HTML.TAB_SETTINGS")),t.xp6(4),t.Oqu(t.lcZ(5,5,"HTML.ACTIVE")),t.xp6(3),t.Oqu(t.lcZ(8,7,"HTML.BLOCKED")))}function Je(i,e){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"BTN.SAVE")))}function Ve(i,e){1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"BTN.EDIT")))}function Ye(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",81),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.saveUpdate(n.CUS.id))}),t.YNc(1,Je,3,3,"span",1),t.YNc(2,Ve,3,3,"span",1),t.qZA()}if(2&i){const a=t.oxw();t.Q6J("mat-dialog-close",a.form.value)("disabled",!a.form.valid),t.xp6(1),t.Q6J("ngIf",!a.CUS.id),t.xp6(1),t.Q6J("ngIf",a.CUS.id)}}function Qe(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",82),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.customerRelated(n.CUS.id))}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA()()}if(2&i){const a=t.oxw();t.Q6J("disabled",!a.form.valid),t.xp6(2),t.Oqu(t.lcZ(3,2,"BTN.Accompany"))}}function Ge(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",82),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.confirmData(n.CUS.id))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&i){const a=t.oxw();t.Q6J("disabled",!a.form.valid),t.xp6(1),t.Oqu(t.lcZ(2,2,"BTN.SUBMIT"))}}class M{constructor(e,a,o,n,r,d,p,g,C,v,j,nt,rt){this.appSettings=e,this.activatedRoute=a,this.codesService=o,this.unitsService=n,this.fb=r,this.localStore=d,this._CustomerService=p,this.router=g,this.dialog=C,this.global=v,this.atlasService=j,this.translateService=nt,this.snackBar=rt,this.curCOMId=S.N.comid,this.account=new R.n,this.country_const=(new Z.I).Countries,this.notificationType_const=(new Z.I).NotificationTypes,this.passwordHide=!0,this.tenant=new $,this.userPerm=[],this.DocImageToUpload=null,this.defaultDocImage=(new O.P).noImage,this.defaultCusImage=(new O.P).noImage,this.CusImageToUpload=null,this.defaultIDImage=(new O.P).noImage,this.IDImageToUpload=null,this.AllBranches=[],this.notificationsObject=new Ae.j,this.Countries=[],this.AllBuildings=[],this.AllUnits=[],this.settings=this.appSettings.settings}ngOnInit(){if(this.userSUb=this.global.user.subscribe(e=>{this.account=e}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let e=0;e<this.curUserPermissions.length;e++)this.userPerm[e]=this.curUserPermissions[e].codename;this.getCountries(this.curCOMId,this.account.periorty),this.getAllBuildings(this.curCOMId,this.account.periorty),this.getNotificationRows(this.curCOMId,this.account.periorty,1),this.sub=this.activatedRoute.params.subscribe(e=>{e.id?(this.id=+e.id,this.getTenantById(this.id)):this.CUS=new $;var a=JSON.parse(this.localStore.getItem("account"));console.log(a.first_name),console.log(a.branch_KeyField),console.log(a.is_employee),console.log(a.RowConfirm),this.form=this.fb.group({id:null,code:[null,s.kI.required],username:{value:null,disabled:this.id},password:null,firstname:[null,s.kI.compose([s.kI.required,s.kI.minLength(3)])],lastname:[null,s.kI.compose([s.kI.required,s.kI.minLength(3)])],image:null,mobile:null,selftype:"P",profile:this.fb.group({birthday:[null,s.kI.required],gender:"M",current_branch:{value:null,disabled:"T"!=a.is_employee},curbuilding:{value:null,disabled:"T"!=a.is_employee},curunit:{value:null,disabled:"T"!=a.is_employee}}),work:this.fb.group({company:[null,s.kI.required],position:[null,s.kI.required],nationalIDType:"F",nationalID:[null,s.kI.required],nationalIDStartDate:null,nationalIDEndDate:null,nationalIDPic:null}),contacts:this.fb.group({email:null,homephone:null,workphone:null,address:null,country:[{value:null}],governorate:[{value:null,disabled:!0}],city:[{value:null,disabled:!0}],area:[{value:null,disabled:!0}]}),social:this.fb.group({facebook:null,twitter:null,google:null}),settings:this.fb.group({isActive:null,isDeleted:null}),docs:this.fb.group({docOnePic:null,docPic:null})}),this.getAllBranches(this.curCOMId,this.account.periorty)})}else this.router.navigate(["/sign-in"])}can(e){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(e))}onFileChange(e){this.DocImageToUpload=e.item(0);var a=new FileReader;a.onload=o=>{this.defaultDocImage=o.target.result},a.readAsDataURL(this.DocImageToUpload)}onFileRemove(e){console.log("====On Remove:: "+e)}handelCUSImgInput(e){this.CusImageToUpload=e.item(0);var a=new FileReader;a.onload=o=>{this.defaultCusImage=o.target.result},a.readAsDataURL(this.CusImageToUpload)}handelIDImgInput(e){this.IDImageToUpload=e.item(0);var a=new FileReader;a.onload=o=>{console.log("=====before====="+this.defaultIDImage),this.defaultIDImage=o.target.result,console.log("=====after====="+this.defaultIDImage)},a.readAsDataURL(this.IDImageToUpload)}mapFormvalue_to_CustomerClass(e){this.form.enable(),this.cur_branch=this.form.value.profile.current_branch,this.cur_building=this.form.value.profile.curbuilding,this.cur_unit=this.form.value.profile.curunit,this.form.disable(),console.log("cur_branch11:: "+this.cur_branch),console.log("cur_building11:: "+this.cur_building),console.log("cur_unit11:: "+this.cur_unit);const a=new c.uU("en-GB").transform(this.form.value.profile.birthday,"dd/MM/yyyy"),o=new c.uU("en-GB").transform(this.form.value.work.nationalIDStartDate,"dd/MM/yyyy"),n=new c.uU("en-GB").transform(this.form.value.work.nationalIDEndDate,"dd/MM/yyyy");this.tenActive=this.form.value.settings.isActive?"T":"F",this.tenDeleted=this.form.value.settings.isDeleted?1:0,null!=this.form.value.profile.birthday&&(this.CUS.CUSBirthDate=a),null!=this.form.value.work.nationalIDStartDate&&(this.CUS.CUSNationalIDStartDate=o),null!=this.form.value.work.nationalIDEndDate&&(this.CUS.CUSNationalIDEndDate=n),this.CUS.CUSCode=+this.form.value.code,this.CUS.CUSFirstName=this.form.value.firstname,this.CUS.CUSLastName=this.form.value.lastname,this.CUS.CUSusername=this.form.value.username,this.CUS.CUSpassword=this.form.value.password,"POST"==e&&(this.CUS.is_create_CustomUser_table="T"),this.CUS.CUSGender=this.form.value.profile.gender,this.CUS.current_branch=this.cur_branch,this.CUS.current_building=this.cur_building,this.CUS.current_unit=this.cur_unit,this.CUS.CUSSelfType=this.form.value.selftype,this.CUS.CUSPic=this.form.value.image,this.CUS.CUSIDPic=this.form.value.work.nationalIDPic,this.CUS.CUSGuarantor=this.form.value.work.company,this.CUS.CUSJobName=this.form.value.work.position,this.CUS.CUSNationalIDType=this.form.value.work.nationalIDType,this.CUS.CUSNationalID=this.form.value.work.nationalID,this.CUS.CUSMobile=this.form.value.mobile,this.CUS.CUSEmail=this.form.value.contacts.email,this.CUS.CUSHomePhone=this.form.value.contacts.homephone,this.CUS.CUSWorkPhone=this.form.value.contacts.workphone,this.CUS.CUSAddress=this.form.value.contacts.address,this.CUS.Country_CTTKeyField=this.form.value.contacts.country,this.CUS.Governorate_CTTKeyField=this.form.value.contacts.governorate,this.CUS.City_CTTKeyField=this.form.value.contacts.city,this.CUS.Area_CTTKeyField=this.form.value.contacts.area,this.CUS.CUSFacebook=this.form.value.social.facebook,this.CUS.CUSTwitter=this.form.value.social.twitter,this.CUS.CUSGoogle=this.form.value.social.google,this.CUS.CUSActive=this.tenActive,this.CUS.RowDelete=this.tenDeleted}getTenantById(e){const a=[];this._CustomerService.getOneCustomer(e).subscribe(o=>{this._CustomerService.getOneCustomerDocs(this.curCOMId,this.account.periorty,e).subscribe(n=>{for(var r of n)a.push({link:r.CUDPic,preview:r.CUDPic})}),this.fillForm(o,a),this.CUS=o})}fillForm(e,a){this.is_active="T"==e.CUSActive,null!=e.current_building&&this.getAllUnits(this.curCOMId,this.account.periorty,e.current_building),this.defaultCusImage=null!=e.CUSPic?e.CUSPic:(new O.P).noImage,this.defaultIDImage=null!=e.CUSIDPic?e.CUSIDPic:(new O.P).noImage,this.is_delete=1==e.RowDelete,this.form.patchValue({id:e.id,code:e.CUSCode,username:e.CUSusername,password:e.CUSpassword,firstname:e.CUSFirstName,lastname:e.CUSLastName,image:e.CUSPic,selftype:e.CUSSelfType,mobile:e.CUSMobile,profile:{birthday:e.CUSBirthDate,gender:e.CUSGender,current_branch:e.current_branch,curbuilding:e.current_building,curunit:e.current_unit},work:{company:e.CUSGuarantor,position:e.CUSJobName,nationalIDType:e.CUSNationalIDType,nationalID:e.CUSNationalID,nationalIDStartDate:e.CUSNationalIDStartDate,nationalIDEndDate:e.CUSNationalIDEndDate,nationalIDPic:e.CUSIDPic},contacts:{email:e.CUSEmail,homephone:e.CUSHomePhone,workphone:e.CUSWorkPhone,address:e.CUSAddress,country:e.Country_CTTKeyField,governorate:e.Governorate_CTTKeyField,city:e.City_CTTKeyField,area:e.Area_CTTKeyField},social:{facebook:e.CUSFacebook,twitter:e.CUSTwitter,google:e.CUSGoogle},settings:{isActive:this.is_active,isDeleted:this.is_delete},docs:{docPic:a}}),this.getUnitFullData(e.current_unit)}getAllBranches(e,a){this.atlasService.getAllBranch(e,a).subscribe(o=>{this.AllBranches=o},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0641\u0631\u0648\u0639","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getNotificationRows(e,a,o){this.codesService.getSubForParentAndArrange(e,a,this.notificationType_const,o).subscribe(n=>{1==o&&(this.cttNotificationType_TenantData=n[0].id),2==o&&(this.cttNotificationType_EndContract=n[0].id)},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0646\u0648\u0639 \u0627\u0644\u062a\u0646\u0628\u064a\u0647","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}mapvaluesToNotificationClass(){this.notificationsObject.notificationType_CTTKeyField=this.cttNotificationType_TenantData,this.notificationsObject.UNOActive="T",this.notificationsObject.UNONotificationFromTenant="T",this.notificationsObject.branch_KeyField=this.cur_branch,this.notificationsObject.UNOTitle="\u0645\u0631\u0627\u062c\u0639\u0629 \u0628\u064a\u0627\u0646\u0627\u062a \u0645\u0633\u062a\u0623\u062c\u0631",this.notificationsObject.build_KeyField=this.cur_building,this.notificationsObject.unit_KeyField=this.cur_unit,this.notificationsObject.customer_KeyField=this.form.value.id,this.notificationsObject.UNOText="\u0628\u0631\u062c\u0627\u0621 \u0645\u0631\u0627\u062c\u0639\u0629 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u0623\u062c\u0631 "+this.form.value.firstname+" "+this.form.value.lastname}confirmData(e){this._CustomerService.editCustomerConfirm({CUSConfirmed:"T",id:e}).subscribe(o=>{this.snackBar.open("\u062a\u0645 \u0625\u0639\u062a\u0645\u0627\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0639\u0645\u064a\u0644","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["contracts/tenant-list"])},o=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u0627\u0639\u062a\u0645\u0627\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0639\u0645\u064a\u0644","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}customerRelated(e){console.log("=============customerRelated()==============="),this.dialog.open(V,{data:{custId:e,periorty:this.account.periorty},panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr"}).afterClosed().subscribe(o=>{})}saveUpdate(e){console.log("=============saveUpdate()==============="),e?(this.mapFormvalue_to_CustomerClass("PATCH"),console.log("=============Update data()==============="),this._CustomerService.editCustomer(this.CUS,this.CusImageToUpload,this.IDImageToUpload,this.curUserData.is_employee).subscribe(a=>{console.log("res=> "+a),"F"==this.curUserData.is_employee&&(this.mapvaluesToNotificationClass(),this.unitsService.addNotificationForUnits(this.notificationsObject).subscribe(o=>{},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0636\u0627\u0641\u0629 \u0627\u0644\u062a\u0646\u0628\u064a\u0647","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})),null!=this.DocImageToUpload&&this._CustomerService.addCustomerDocs(this.CUS.id,this.DocImageToUpload).subscribe(o=>{console.log("====yes from update====",o)}),this.snackBar.open("\u062a\u0645 \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0639\u0645\u064a\u0644","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["contracts/tenant-list"])},a=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u062a\u0639\u062f\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0639\u0645\u064a\u0644","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})):(this.mapFormvalue_to_CustomerClass("POST"),console.log(this.CUS),this._CustomerService.addCustomer(this.CUS,this.CusImageToUpload,this.IDImageToUpload).subscribe(a=>{null!=this.DocImageToUpload&&this._CustomerService.addCustomerDocs(a.id,this.DocImageToUpload).subscribe(o=>{console.log("====yes from insert====",o)}),this.snackBar.open("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0639\u0645\u064a\u0644","\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.router.navigate(["contracts/tenant-list"])},a=>{this.snackBar.open(" \u062e\u0637\u0623 \u0641\u064a \u0627\u0636\u0627\u0641\u0647 \u0639\u0645\u064a\u0644","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})}))}close(){}getGovernorate(){}compareFunction(e,a){return e.username==a.username&&e.code==a.code}getCountries(e,a){this.codesService.getSubForParent(e,a,this.country_const).subscribe(o=>{this.Countries=o},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u062f\u0648\u0644","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getAllBuildings(e,a){this.unitsService.getAllBuilding(e,a).subscribe(o=>{this.AllBuildings=o},o=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0639\u0642\u0627\u0631\u0627\u062a","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getUnitsPerBuild(e){this.getAllUnits(this.curCOMId,this.account.periorty,e.value)}getAllUnits(e,a,o){this.unitsService.getAllUnitsPerBuilding(e,a,o,"").subscribe(n=>{this.AllUnits=n},n=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0648\u062d\u062f\u0627\u062a","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}getUnitData(e){this.getUnitFullData(e.value)}getUnitFullData(e){this.unitsService.getOneUnit(e).subscribe(a=>{this.electricUnit=a.UNTElectricityNumber,this.waterUnit=a.UNTWaterNumber,this.gasUnit=a.UNTGasNumber},a=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0648\u062d\u062f\u0629","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(e=>{this.errorRetrieveMsg=e}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(e=>{this.askToDeletedMsg=e}),this.translateService.get("MESSAGE.DELETED").subscribe(e=>{this.deletedMsg=e})}}M.\u0275fac=function(e){return new(e||M)(t.Y36(k.d),t.Y36(T.gz),t.Y36(ut.d),t.Y36(at.X),t.Y36(s.QS),t.Y36(b.C),t.Y36(L.v),t.Y36(T.F0),t.Y36(m.uw),t.Y36(F.U),t.Y36(W.Z),t.Y36(f.sK),t.Y36(U.ux))},M.\u0275cmp=t.Xpm({type:M,selectors:[["app-customers-details"]],decls:256,vars:163,consts:[["mat-dialog-title",""],[4,"ngIf"],[1,"user-form",3,"formGroup"],[1,"vertical-tabs","tab-content-wrapped",3,"backgroundColor","color"],[3,"label"],["fxLayout","column",1,"form-field-outer"],["fxLayout","column","fxLayoutGap","10px grid"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["appearance","outline",1,"w-20"],["matInput","","formControlName","code","required",""],["appearance","outline",1,"w-30"],["matInput","","formControlName","username","required",""],["class","w-45",4,"ngIf"],["appearance","outline",1,"w-50"],["matInput","","formControlName","firstname","required",""],["appearance","outline",1,"w-45"],["matInput","","formControlName","lastname","required",""],["matInput","","formControlName","mobile","required",""],["formControlName","selftype"],["value","P","labelPosition","after"],["value","C","labelPosition","after"],["value","O","labelPosition","after"],[1,"p-2"],[2,"width","150px","height","200px",3,"src"],["formControlName","image","name","image","id","upload","type","file","accept","image/*",1,"user-img",3,"change"],["formGroupName","profile",3,"label"],["formControlName","gender"],["value","M","labelPosition","after"],["value","F","labelPosition","after"],[1,"w-50"],["matInput","","formControlName","birthday","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["birthday",""],["fxFlex","100","fxFlex.gt-sm","50.0",1,"px-1"],["appearance","outline",1,"w-100"],["formControlName","current_branch","id","curbranchContOpSel","required","",3,"placeholder"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["formControlName","curbuilding","id","buildOpSel",3,"placeholder","selectionChange"],["formControlName","curunit","id","unitOpSel",3,"placeholder","selectionChange"],["formGroupName","work",3,"label"],[1,"w-100"],["matInput","","formControlName","company","required",""],["matInput","","formControlName","position","required",""],["formControlName","nationalIDType"],["value","N","labelPosition","after"],["value","K","labelPosition","after"],["value","S","labelPosition","after"],["matInput","","formControlName","nationalID","required",""],["matInput","","formControlName","nationalIDStartDate",3,"matDatepicker"],["natStartDate",""],[1,"w-45"],["matInput","","formControlName","nationalIDEndDate",3,"matDatepicker"],["natEndDate",""],[2,"width","250px","height","200px",3,"src"],["formControlName","nationalIDPic","id","IDupload","type","file","accept","image/*",1,"user-img",3,"change"],["formGroupName","contacts",3,"label"],["matInput","","formControlName","homephone"],["matInput","","formControlName","workphone"],["matInput","","formControlName","email","required",""],["matInput","","formControlName","address"],["formControlName","country",3,"placeholder"],["formGroupName","social",3,"label"],["matInput","","formControlName","facebook"],["matInput","","formControlName","twitter"],["matInput","","formControlName","google"],["formGroupName","settings",3,"label",4,"ngIf"],["formGroupName","docs",3,"label"],["fxFlex","100","fxFlex.gt-sm","100",1,"px-2"],["hidden","","formControlName","docOnePic","name","docOnePic","id","uploadonedoc","type","file","accept","image/*",1,"user-img",3,"change"],["fileInput",""],["type","button","mat-raised-button","",3,"click"],["formControlName","docPic","fileAccept","image/*"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["matInput","","formControlName","password","required","",3,"type"],["matSuffix","",3,"click"],["formGroupName","settings",3,"label"],["formControlName","isActive"],["formControlName","isDeleted"],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"h1",0),t.YNc(1,Ie,3,3,"span",1),t.YNc(2,De,3,3,"span",1),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"form",2)(6,"mat-tab-group",3)(7,"mat-tab",4),t.ALo(8,"translate"),t.TgZ(9,"div",5)(10,"div",6),t._UZ(11,"mat-label"),t.TgZ(12,"div",7)(13,"mat-form-field",8)(14,"mat-label")(15,"mat-icon"),t._uU(16,"person"),t.qZA(),t._uU(17),t.ALo(18,"translate"),t.qZA(),t._UZ(19,"input",9),t.YNc(20,Ne,2,0,"mat-error",1),t.YNc(21,Re,2,0,"mat-error",1),t.qZA(),t.TgZ(22,"mat-form-field",10)(23,"mat-label")(24,"mat-icon"),t._uU(25,"person"),t.qZA(),t._uU(26),t.ALo(27,"translate"),t.qZA(),t._UZ(28,"input",11),t.qZA(),t.YNc(29,Me,11,7,"mat-form-field",12),t.qZA()(),t.TgZ(30,"div",7)(31,"mat-form-field",13)(32,"mat-label")(33,"mat-icon"),t._uU(34,"person"),t.qZA(),t._uU(35),t.ALo(36,"translate"),t.qZA(),t._UZ(37,"input",14),t.YNc(38,qe,2,0,"mat-error",1),t.qZA(),t.TgZ(39,"mat-form-field",15)(40,"mat-label")(41,"mat-icon"),t._uU(42,"person"),t.qZA(),t._uU(43),t.ALo(44,"translate"),t.qZA(),t._UZ(45,"input",16),t.YNc(46,we,2,0,"mat-error",1),t.qZA()(),t.TgZ(47,"div",7)(48,"mat-form-field",13)(49,"mat-label"),t._uU(50),t.ALo(51,"translate"),t.qZA(),t.TgZ(52,"mat-hint"),t._uU(53,"sample 0505602221"),t.qZA(),t._UZ(54,"input",17),t.YNc(55,Ee,2,0,"mat-error",1),t.qZA()(),t.TgZ(56,"div",7)(57,"mat-radio-group",18)(58,"mat-radio-button",19),t._uU(59),t.ALo(60,"translate"),t.qZA(),t.TgZ(61,"mat-radio-button",20),t._uU(62),t.ALo(63,"translate"),t.qZA(),t.TgZ(64,"mat-radio-button",21),t._uU(65),t.ALo(66,"translate"),t.qZA()()(),t.TgZ(67,"div",22),t._UZ(68,"img",23),t.TgZ(69,"input",24),t.NdJ("change",function(r){return a.handelCUSImgInput(r.target.files)}),t.qZA()()()(),t.TgZ(70,"mat-tab",25),t.ALo(71,"translate"),t.TgZ(72,"div",5)(73,"div",7)(74,"mat-radio-group",26)(75,"mat-radio-button",27),t._uU(76),t.ALo(77,"translate"),t.qZA(),t.TgZ(78,"mat-radio-button",28),t._uU(79),t.ALo(80,"translate"),t.qZA()(),t.TgZ(81,"mat-form-field",29)(82,"mat-label"),t._uU(83),t.ALo(84,"translate"),t.qZA(),t._UZ(85,"input",30)(86,"mat-datepicker-toggle",31)(87,"mat-datepicker",null,32),t.qZA()(),t.TgZ(89,"div",7)(90,"div",33)(91,"mat-form-field",34)(92,"mat-label"),t._uU(93),t.ALo(94,"translate"),t.qZA(),t.TgZ(95,"mat-select",35),t.ALo(96,"translate"),t.TgZ(97,"mat-option",36),t._uU(98,"-"),t.qZA(),t.YNc(99,Pe,2,2,"mat-option",37),t.qZA()()()(),t.TgZ(100,"div",7)(101,"mat-form-field",13)(102,"mat-label"),t._uU(103),t.ALo(104,"translate"),t.qZA(),t.TgZ(105,"mat-select",38),t.NdJ("selectionChange",function(r){return a.getUnitsPerBuild(r)}),t.ALo(106,"translate"),t.TgZ(107,"mat-option",36),t._uU(108,"-"),t.qZA(),t.YNc(109,ke,2,2,"mat-option",37),t.qZA()(),t.TgZ(110,"mat-form-field",15)(111,"mat-label"),t._uU(112),t.ALo(113,"translate"),t.qZA(),t.TgZ(114,"mat-select",39),t.NdJ("selectionChange",function(r){return a.getUnitData(r)}),t.ALo(115,"translate"),t.TgZ(116,"mat-option",36),t._uU(117,"-"),t.qZA(),t.YNc(118,Ke,2,2,"mat-option",37),t.qZA()()(),t.TgZ(119,"div",7)(120,"h4"),t._uU(121),t.ALo(122,"translate"),t.qZA(),t.TgZ(123,"h3"),t._uU(124),t.qZA(),t.TgZ(125,"h4"),t._uU(126),t.ALo(127,"translate"),t.qZA(),t.TgZ(128,"h3"),t._uU(129),t.qZA(),t.TgZ(130,"h4"),t._uU(131),t.ALo(132,"translate"),t.qZA(),t.TgZ(133,"h3"),t._uU(134),t.qZA()()()(),t.TgZ(135,"mat-tab",40),t.ALo(136,"translate"),t.TgZ(137,"div",5)(138,"mat-form-field",41)(139,"mat-label"),t._uU(140),t.ALo(141,"translate"),t.qZA(),t._UZ(142,"input",42),t.qZA(),t.TgZ(143,"mat-form-field",41)(144,"mat-label"),t._uU(145),t.ALo(146,"translate"),t.qZA(),t._UZ(147,"input",43),t.qZA(),t.TgZ(148,"mat-radio-group",44)(149,"mat-radio-button",45),t._uU(150),t.ALo(151,"translate"),t.qZA(),t.TgZ(152,"mat-radio-button",28),t._uU(153),t.ALo(154,"translate"),t.qZA(),t.TgZ(155,"mat-radio-button",46),t._uU(156),t.ALo(157,"translate"),t.qZA(),t.TgZ(158,"mat-radio-button",47),t._uU(159),t.ALo(160,"translate"),t.qZA(),t.TgZ(161,"mat-radio-button",21),t._uU(162),t.ALo(163,"translate"),t.qZA()(),t.TgZ(164,"mat-form-field",41)(165,"mat-label"),t._uU(166),t.ALo(167,"translate"),t.qZA(),t._UZ(168,"input",48),t.qZA(),t.TgZ(169,"div",7)(170,"mat-form-field",29)(171,"mat-label"),t._uU(172),t.ALo(173,"translate"),t.qZA(),t._UZ(174,"input",49)(175,"mat-datepicker-toggle",31)(176,"mat-datepicker",null,50),t.qZA(),t.TgZ(178,"mat-form-field",51)(179,"mat-label"),t._uU(180),t.ALo(181,"translate"),t.qZA(),t._UZ(182,"input",52)(183,"mat-datepicker-toggle",31)(184,"mat-datepicker",null,53),t.qZA()()(),t.TgZ(186,"div",22),t._UZ(187,"img",54),t.TgZ(188,"input",55),t.NdJ("change",function(r){return a.handelIDImgInput(r.target.files)}),t.qZA()()(),t.TgZ(189,"mat-tab",56),t.ALo(190,"translate"),t.TgZ(191,"div",5)(192,"div",7)(193,"mat-form-field",29)(194,"mat-label"),t._uU(195),t.ALo(196,"translate"),t.qZA(),t._UZ(197,"input",57),t.qZA(),t.TgZ(198,"mat-form-field",51)(199,"mat-label"),t._uU(200),t.ALo(201,"translate"),t.qZA(),t._UZ(202,"input",58),t.qZA()(),t.TgZ(203,"mat-form-field",41)(204,"mat-label"),t._uU(205),t.ALo(206,"translate"),t.qZA(),t._UZ(207,"input",59),t.qZA(),t.TgZ(208,"mat-form-field",41)(209,"mat-label"),t._uU(210),t.ALo(211,"translate"),t.qZA(),t._UZ(212,"input",60),t.qZA(),t.TgZ(213,"mat-form-field",34)(214,"mat-label"),t._uU(215),t.ALo(216,"translate"),t.qZA(),t.TgZ(217,"mat-select",61),t.ALo(218,"translate"),t.TgZ(219,"mat-option",36),t._uU(220,"-"),t.qZA(),t.YNc(221,Be,2,2,"mat-option",37),t.qZA()()()(),t.TgZ(222,"mat-tab",62),t.ALo(223,"translate"),t.TgZ(224,"div",5)(225,"mat-form-field",41)(226,"mat-label"),t._uU(227,"Facebook"),t.qZA(),t._UZ(228,"input",63),t.qZA(),t.TgZ(229,"mat-form-field",41)(230,"mat-label"),t._uU(231,"Twitter"),t.qZA(),t._UZ(232,"input",64),t.qZA(),t.TgZ(233,"mat-form-field",41)(234,"mat-label"),t._uU(235,"Google"),t.qZA(),t._UZ(236,"input",65),t.qZA()()(),t.YNc(237,He,9,9,"mat-tab",66),t.TgZ(238,"mat-tab",67),t.ALo(239,"translate"),t.TgZ(240,"div",68)(241,"div",22),t._UZ(242,"img",23),t.TgZ(243,"input",69,70),t.NdJ("change",function(r){return a.onFileChange(r.target.files)}),t.qZA(),t.TgZ(245,"button",71),t.NdJ("click",function(){t.CHM(o);const r=t.MAs(244);return t.KtG(r.click())}),t._uU(246),t.ALo(247,"translate"),t.qZA()(),t._UZ(248,"mat-divider")(249,"input-file",72),t.qZA()()()(),t._UZ(250,"br"),t.TgZ(251,"div",73)(252,"div",7),t.YNc(253,Ye,3,4,"button",74),t.YNc(254,Qe,4,4,"button",75),t.YNc(255,Ge,3,4,"button",75),t.qZA()()}if(2&e){const o=t.MAs(88),n=t.MAs(177),r=t.MAs(185);t.xp6(1),t.Q6J("ngIf",!a.CUS.id),t.xp6(1),t.Q6J("ngIf",a.CUS.id),t.xp6(1),t.hij(" ",t.lcZ(4,75,"HTML.TENANT"),""),t.xp6(2),t.Q6J("formGroup",a.form),t.xp6(1),t.Q6J("backgroundColor","primary")("color","warn"),t.xp6(1),t.s9C("label",t.lcZ(8,77,"HTML.TAB_BASIC")),t.xp6(10),t.hij(" ",t.lcZ(18,79,"HTML.CODE"),""),t.xp6(3),t.Q6J("ngIf",null==a.form.controls.code.errors?null:a.form.controls.code.errors.required),t.xp6(1),t.Q6J("ngIf",a.form.controls.code.hasError("minlength")),t.xp6(5),t.hij(" ",t.lcZ(27,81,"HTML.USERNAME"),""),t.xp6(3),t.Q6J("ngIf",!a.CUS.id),t.xp6(6),t.hij(" ",t.lcZ(36,83,"HTML.FIRST_NAME"),""),t.xp6(3),t.Q6J("ngIf",null==a.form.controls.firstname.errors?null:a.form.controls.firstname.errors.required),t.xp6(5),t.hij(" ",t.lcZ(44,85,"HTML.LAST_NAME"),""),t.xp6(3),t.Q6J("ngIf",null==a.form.controls.lastname.errors?null:a.form.controls.lastname.errors.required),t.xp6(4),t.Oqu(t.lcZ(51,87,"HTML.MOBILE")),t.xp6(5),t.Q6J("ngIf",null==a.form.controls.mobile.errors?null:a.form.controls.mobile.errors.required),t.xp6(4),t.Oqu(t.lcZ(60,89,"HTML.NATURE_PERSON")),t.xp6(3),t.Oqu(t.lcZ(63,91,"HTML.NATURE_COMPANY")),t.xp6(3),t.Oqu(t.lcZ(66,93,"HTML.NATURE_OTHER")),t.xp6(3),t.Q6J("src",a.defaultCusImage,t.LSH),t.xp6(2),t.s9C("label",t.lcZ(71,95,"HTML.TAB_PERSONAL")),t.xp6(6),t.Oqu(t.lcZ(77,97,"HTML.MALE")),t.xp6(3),t.Oqu(t.lcZ(80,99,"HTML.FEMALE")),t.xp6(4),t.Oqu(t.lcZ(84,101,"HTML.BIRTH_DATE")),t.xp6(2),t.Q6J("matDatepicker",o),t.xp6(1),t.Q6J("for",o),t.xp6(7),t.hij(" ",t.lcZ(94,103,"HTML.BRANCH"),""),t.xp6(2),t.s9C("placeholder",t.lcZ(96,105,"HTML.BRANCH")),t.xp6(4),t.Q6J("ngForOf",a.AllBranches),t.xp6(4),t.Oqu(t.lcZ(104,107,"HTML.BUILDING")),t.xp6(2),t.s9C("placeholder",t.lcZ(106,109,"HTML.BUILDING")),t.xp6(4),t.Q6J("ngForOf",a.AllBuildings),t.xp6(3),t.Oqu(t.lcZ(113,111,"HTML.UNIT")),t.xp6(2),t.s9C("placeholder",t.lcZ(115,113,"HTML.UNIT")),t.xp6(4),t.Q6J("ngForOf",a.AllUnits),t.xp6(3),t.hij(" ",t.lcZ(122,115,"HTML.ElectricityCounterNumber")," "),t.xp6(3),t.Oqu(a.electricUnit),t.xp6(2),t.hij(" ",t.lcZ(127,117,"HTML.WaterCounterNumber")," "),t.xp6(3),t.Oqu(a.waterUnit),t.xp6(2),t.hij(" ",t.lcZ(132,119,"HTML.GasCounterNumber")," "),t.xp6(3),t.Oqu(a.gasUnit),t.xp6(1),t.s9C("label",t.lcZ(136,121,"HTML.TAB_ID")),t.xp6(5),t.Oqu(t.lcZ(141,123,"HTML.GUARANTOR")),t.xp6(5),t.Oqu(t.lcZ(146,125,"HTML.POSITION")),t.xp6(5),t.Oqu(t.lcZ(151,127,"OPTIONS.NATIONAL_ID")),t.xp6(3),t.Oqu(t.lcZ(154,129,"OPTIONS.FOREIGN_ID")),t.xp6(3),t.Oqu(t.lcZ(157,131,"OPTIONS.GULF_ID")),t.xp6(3),t.Oqu(t.lcZ(160,133,"OPTIONS.SPECIAL_EQAMA")),t.xp6(3),t.Oqu(t.lcZ(163,135,"OPTIONS.OTHER")),t.xp6(4),t.Oqu(t.lcZ(167,137,"HTML.IDNUMBER")),t.xp6(6),t.Oqu(t.lcZ(173,139,"HTML.START_DATE")),t.xp6(2),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(5),t.Oqu(t.lcZ(181,141,"HTML.END_DATE")),t.xp6(2),t.Q6J("matDatepicker",r),t.xp6(1),t.Q6J("for",r),t.xp6(4),t.Q6J("src",a.defaultIDImage,t.LSH),t.xp6(2),t.s9C("label",t.lcZ(190,143,"HTML.TAB_CONTACTS")),t.xp6(6),t.Oqu(t.lcZ(196,145,"HTML.HOME_PHONE")),t.xp6(5),t.Oqu(t.lcZ(201,147,"HTML.WORK_PHONE")),t.xp6(5),t.Oqu(t.lcZ(206,149,"HTML.EMAIL")),t.xp6(5),t.Oqu(t.lcZ(211,151,"HTML.ADDRESS")),t.xp6(5),t.Oqu(t.lcZ(216,153,"HTML.COUNTRY")),t.xp6(2),t.s9C("placeholder",t.lcZ(218,155,"HTML.COUNTRY")),t.xp6(4),t.Q6J("ngForOf",a.Countries),t.xp6(1),t.s9C("label",t.lcZ(223,157,"HTML.TAB_SOCIAL_LIFE")),t.xp6(15),t.Q6J("ngIf",a.account.periorty>0),t.xp6(1),t.s9C("label",t.lcZ(239,159,"HTML.TAB_DOCS")),t.xp6(4),t.Q6J("src",a.defaultDocImage,t.LSH),t.xp6(4),t.Oqu(t.lcZ(247,161,"HTML.AddPic")),t.xp6(7),t.Q6J("ngIf",a.can("change_tenant")||0==a.account.periorty),t.xp6(1),t.Q6J("ngIf",a.can("view_tenantrelative")||0==a.account.periorty),t.xp6(1),t.Q6J("ngIf",a.can("confirm_tenant"))}},dependencies:[s._Y,s.Fj,s.JJ,s.JL,s.Q7,c.sg,c.O5,s.sg,s.u,s.x0,u.xw,u.SQ,u.Wh,u.yH,w.ey,_.lW,mt.oG,y.Mq,y.hl,y.nW,m.ZT,m.uh,m.H8,B.Hw,D.Nt,h.KE,h.hX,h.bx,h.TO,h.R9,x.d,dt.VQ,dt.U0,E.gD,et.uX,et.SP,it.tW,f.X$],styles:[".user-form .form-field-outer{width:480px}.user-form .mat-mdc-radio-button{margin-right:12px}.container{background-color:var(--backgroundColorContainer);border-right:2px solid var(--backgroundColorContainerBorder)}\n"],encapsulation:2});var je=l(3609);class We{}function $e(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.onSave())}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA()()}if(2&i){const a=t.oxw();t.Q6J("mat-dialog-close",a.form.value)("disabled",!a.form.valid),t.xp6(2),t.Oqu(t.lcZ(3,3,"BTN.SAVE"))}}class Y{constructor(e,a,o,n){this.dialogRef=e,this.data=a,this.localStore=o,this.fb=n,this.userPerm=[]}ngOnInit(){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let e=0;e<this.curUserPermissions.length;e++)this.userPerm[e]=this.curUserPermissions[e].codename;this.form=this.fb.group({id:null,INSCode:[null,s.kI.required],INSContractTyps:"I",INSStatus:"N",INSValue:0,INSPayedValue:0,dueDate:null,payDate:null,INSPersonPayName:null,INSNotes:null,RowConfirm:0,RowDelete:0,RowStatus:0,contract_KeyField:null,branch_KeyField:null,owner_KeyField:null,build_KeyField:null,unit_KeyField:null,customer_KeyField:null}),this.data.cttRow?(console.log("===this.data.cttRow==="),console.log(this.data.cttRow),this.action="Patch",this.form.patchValue({id:this.data.cttRow.id,INSCode:this.data.cttRow.INSCode,dueDate:new Date(this.data.cttRow.INSDueDate),payDate:new Date(this.data.cttRow.INSPayDate),INSPersonPayName:this.data.cttRow.INSPersonPayName,INSNotes:this.data.cttRow.INSNotes,contract_KeyField:this.data.cttRow.contract_KeyField,branch_KeyField:this.data.cttRow.branch_KeyField,owner_KeyField:this.data.cttRow.owner_KeyField,build_KeyField:this.data.cttRow.build_KeyField,unit_KeyField:this.data.cttRow.unit_KeyField,customer_KeyField:this.data.cttRow.customer_KeyField,INSContractTyps:this.data.cttRow.INSContractTyps,INSStatus:this.data.cttRow.INSStatus,INSValue:this.data.cttRow.INSValue,INSPayedValue:this.data.cttRow.INSPayedValue,RowConfirm:this.data.cttRow.RowConfirm,RowDelete:this.data.cttRow.RowDelete,RowStatus:this.data.cttRow.RowStatus})):(console.log("==contract****:: "+this.data.contract),this.action="Post",this.form.patchValue({contract_KeyField:this.data.contract,branch_KeyField:this.data.branch,owner_KeyField:this.data.owner,build_KeyField:this.data.build,unit_KeyField:this.data.unit,customer_KeyField:this.data.customer,INSContractTyps:"I",INSStatus:"N",INSValue:0,INSPayedValue:0,RowConfirm:0,RowDelete:0,RowStatus:0}))}can(e){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(e))}onSave(){console.log("===***Press Save button***==="),this.form.valid&&this.dialogRef.close({event:this.action,data:this.form.value})}close(){console.log("===***Press Close button***==="),this.action="Cancel",this.dialogRef.close({event:this.action})}}function Xe(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.openCategoryDialog(null))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"HTML.AddInstallment")))}function ze(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(a);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.openCategoryDialog(n))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()()}2&i&&t.s9C("matTooltip",t.lcZ(1,1,"BTN.EDIT"))}function ta(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(a);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.remove(n.id))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()}2&i&&t.s9C("matTooltip",t.lcZ(1,1,"BTN.REMOVE"))}function ea(i,e){if(1&i&&(t.TgZ(0,"div",9)(1,"div",10),t._uU(2),t.qZA(),t.TgZ(3,"div",10),t._uU(4),t.qZA(),t.TgZ(5,"div",10),t._uU(6),t.ALo(7,"date"),t.qZA(),t.TgZ(8,"div",10),t._uU(9),t.qZA(),t.TgZ(10,"div",10),t._uU(11),t.qZA(),t.TgZ(12,"div",10)(13,"div",11),t.YNc(14,ze,4,3,"button",12),t.YNc(15,ta,4,3,"button",13),t.qZA()()()),2&i){const a=e.$implicit,o=t.oxw();t.xp6(2),t.Oqu(a.INSCode),t.xp6(2),t.Oqu(a.INSValue),t.xp6(2),t.Oqu(t.xi3(7,7,a.INSDueDate,"yyyy-MM-dd")),t.xp6(3),t.Oqu(a.INSStatusDisplay),t.xp6(2),t.Oqu(a.INSPayedValue),t.xp6(3),t.Q6J("ngIf",o.can("view_installment")),t.xp6(1),t.Q6J("ngIf",o.can("delete_installment"))}}function aa(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"div",16)(1,"div",17)(2,"mat-card",18)(3,"pagination-controls",19),t.NdJ("pageChange",function(n){t.CHM(a);const r=t.oxw();return t.KtG(r.onPageChanged(n))}),t.qZA()()()()}}Y.\u0275fac=function(e){return new(e||Y)(t.Y36(m.so),t.Y36(m.WI),t.Y36(b.C),t.Y36(s.QS))},Y.\u0275cmp=t.Xpm({type:Y,selectors:[["app-installment-dialog"]],decls:68,vars:45,consts:[["mat-dialog-title",""],[1,"user-form",3,"formGroup"],["mat-dialog-content",""],["fxLayout","row wrap"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["fxFlex","100","fxFlex.gt-sm","33.3",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","INSValue","required",""],["matInput","","formControlName","dueDate",3,"matDatepicker"],["matSuffix","",3,"for"],["dueDate",""],["formControlName","INSStatus","id","instStatusOpSel",3,"placeholder"],[3,"value"],["fxFlex","100","fxFlex.gt-sm","49.8",1,"px-1"],["matInput","","formControlName","INSPayedValue"],["matInput","","formControlName","payDate",3,"matDatepicker"],["payDate",""],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","INSNotes"],["mat-dialog-actions",""],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click",4,"ngIf"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled","click"]],template:function(e,a){if(1&e&&(t.TgZ(0,"h1",0),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"form",1)(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),t._uU(10),t.ALo(11,"translate"),t.qZA(),t._UZ(12,"input",7),t.qZA()(),t.TgZ(13,"div",5)(14,"mat-form-field",6)(15,"mat-label"),t._uU(16),t.ALo(17,"translate"),t.qZA(),t._UZ(18,"input",8)(19,"mat-datepicker-toggle",9)(20,"mat-datepicker",null,10),t.qZA()(),t.TgZ(22,"div",5)(23,"mat-form-field",6)(24,"mat-label"),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"mat-select",11),t.ALo(28,"translate"),t.TgZ(29,"mat-option",12),t._uU(30,"-"),t.qZA(),t.TgZ(31,"mat-option",12),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"mat-option",12),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.TgZ(37,"mat-option",12),t._uU(38),t.ALo(39,"translate"),t.qZA()()()()(),t.TgZ(40,"div",4)(41,"div",13)(42,"mat-form-field",6)(43,"mat-label"),t._uU(44),t.ALo(45,"translate"),t.qZA(),t._UZ(46,"input",14),t.qZA()(),t.TgZ(47,"div",13)(48,"mat-form-field",6)(49,"mat-label"),t._uU(50),t.ALo(51,"translate"),t.qZA(),t._UZ(52,"input",15)(53,"mat-datepicker-toggle",9)(54,"mat-datepicker",null,16),t.qZA()()(),t.TgZ(56,"div",17)(57,"mat-form-field",6)(58,"mat-label"),t._uU(59),t.ALo(60,"translate"),t.qZA(),t._UZ(61,"input",18),t.qZA()()()(),t.TgZ(62,"div",19)(63,"div",4),t.YNc(64,$e,4,5,"button",20),t.TgZ(65,"button",21),t.NdJ("click",function(){return a.close()}),t._uU(66),t.ALo(67,"translate"),t.qZA()()()()),2&e){const o=t.MAs(21),n=t.MAs(55);t.xp6(1),t.Oqu(t.lcZ(2,21,"HTML.InstallmentData")),t.xp6(2),t.Q6J("formGroup",a.form),t.xp6(7),t.Oqu(t.lcZ(11,23,"HTML.InstallmentValue")),t.xp6(6),t.Oqu(t.lcZ(17,25,"HTML.DueDate")),t.xp6(2),t.Q6J("matDatepicker",o),t.xp6(1),t.Q6J("for",o),t.xp6(6),t.Oqu(t.lcZ(26,27,"HTML.InstallmentStatus")),t.xp6(2),t.s9C("placeholder",t.lcZ(28,29,"HTML.InstallmentStatus")),t.xp6(4),t.Q6J("value","N"),t.xp6(1),t.Oqu(t.lcZ(33,31,"OPTIONS.NotPayed")),t.xp6(2),t.Q6J("value","P"),t.xp6(1),t.Oqu(t.lcZ(36,33,"OPTIONS.Payed")),t.xp6(2),t.Q6J("value","T"),t.xp6(1),t.Oqu(t.lcZ(39,35,"OPTIONS.PartialPayed")),t.xp6(6),t.Oqu(t.lcZ(45,37,"HTML.PayedValue")),t.xp6(6),t.Oqu(t.lcZ(51,39,"HTML.PayedDate")),t.xp6(2),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(6),t.Oqu(t.lcZ(60,41,"HTML.Notes")),t.xp6(5),t.Q6J("ngIf",a.can("change_installment")),t.xp6(2),t.Oqu(t.lcZ(67,43,"BTN.CANCEL"))}},dependencies:[s._Y,s.Fj,s.JJ,s.JL,s.Q7,c.O5,s.sg,s.u,u.xw,u.Wh,u.yH,w.ey,_.lW,y.Mq,y.hl,y.nW,m.ZT,m.uh,m.xY,m.H8,D.Nt,h.KE,h.hX,h.R9,E.gD,f.X$]});const ia=function(i,e){return{itemsPerPage:i,currentPage:e}};class Q{constructor(e,a,o,n,r,d,p,g,C,v){this.localStore=e,this.global=a,this.router=o,this.activatedRoute=n,this._contractService=r,this.snackBar=d,this.translateService=p,this.fb=g,this.dialog=C,this.appSettings=v,this.contractInstallmentsArray=[],this.count=6,this.curCOMId=S.N.comid,this.account=new R.n,this.installmentForDisplay={id:void 0,COMId:void 0,INSCode:void 0,contract_KeyField:void 0,branch_KeyField:void 0,owner_KeyField:void 0,build_KeyField:void 0,unit_KeyField:void 0,customer_KeyField:void 0,INSContractTyps:void 0,INSStatus:void 0,INSValue:void 0,INSDueDate:void 0,INSPayedValue:void 0,INSPayDate:null,INSPersonPayName:void 0,INSNotes:void 0,EntryDate:void 0,EntryUser:void 0,RowConfirm:void 0,RowStatus:void 0,RowDelete:void 0},this.userPerm=[],this.settings=this.appSettings.settings}ngOnInit(){if(this.userSUb=this.global.user.subscribe(e=>{this.account=e}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let e=0;e<this.curUserPermissions.length;e++)this.userPerm[e]=this.curUserPermissions[e].codename;this.prepareMsgLanguage(),this.sub=this.activatedRoute.params.subscribe(e=>{e.id?(this.id=+e.id,this.getInstallmentsPerContract(this.curCOMId,this.account.periorty,this.id),this._contractService.getOneContract(this.id).subscribe(a=>{this.contract_KeyField=a.id,this.branch_KeyField=a.branch_KeyField,this.owner_KeyField=a.owner_KeyField,this.build_KeyField=a.build_KeyField,this.unit_KeyField=a.unit_KeyField,this.customer_KeyField=a.customer_KeyField})):this.Insta=new We})}else this.router.navigate(["/sign-in"])}can(e){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(e))}onPageChanged(e){this.page=e,window.scrollTo(0,0)}openCategoryDialog(e){this.dialog.open(Y,{data:{cttRow:e,contract:this.contract_KeyField,branch:this.branch_KeyField,owner:this.owner_KeyField,build:this.build_KeyField,unit:this.unit_KeyField,customer:this.customer_KeyField},panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr"}).afterClosed().subscribe(o=>{console.log("=====result.event:: "+o.event),"Cancel"==o.event||("Patch"==o.event?(this.mapFormvalue_to_InstallmentClass(o.data),this.updateInstallment(this.installmentForDisplay)):"Post"==o.event&&(this.mapFormvalue_to_InstallmentClass(o.data),this.addInstallment(this.installmentForDisplay)))})}addInstallment(e){console.log("====inside addInstallment== ==="),this._contractService.addInstallments(e).subscribe(a=>this.getInstallmentsPerContract(this.curCOMId,this.account.periorty,this.id))}updateInstallment(e){console.log("====inside updateInstallment====="),this._contractService.editInstallments(e).subscribe(a=>this.getInstallmentsPerContract(this.curCOMId,this.account.periorty,this.id))}mapFormvalue_to_InstallmentClass(e){if(console.log("====formValue.dueDate:: "+e.dueDate),null!=e.dueDate){const n=new c.uU("en-GB").transform(e.dueDate,"dd/MM/yyyy");new Date(new c.uU("en-GB").transform(new Date(e.dueDate),"yyyy/MM/dd")),this.installmentForDisplay.INSDueDate=n}if(null!=e.payDate){const n=new c.uU("en-GB").transform(e.payDate,"dd/MM/yyyy");new Date(new c.uU("en-GB").transform(new Date(e.payDate),"yyyy/MM/dd")),this.installmentForDisplay.INSPayDate=n}this.installmentForDisplay.id=e.id,this.installmentForDisplay.INSCode=e.INSCode,this.installmentForDisplay.INSContractTyps=e.INSContractTyps,this.installmentForDisplay.INSStatus=e.INSStatus,this.installmentForDisplay.INSValue=e.INSValue,this.installmentForDisplay.INSPayedValue=e.INSPayedValue,this.installmentForDisplay.INSDueDate=e.dueDate,this.installmentForDisplay.INSPayDate=e.payDate,this.installmentForDisplay.INSPersonPayName=e.INSPersonPayName,this.installmentForDisplay.INSNotes=e.INSNotes,this.installmentForDisplay.RowConfirm=e.RowConfirm,this.installmentForDisplay.RowDelete=e.RowDelete,this.installmentForDisplay.RowStatus=e.RowStatus,this.installmentForDisplay.contract_KeyField=e.contract_KeyField,this.installmentForDisplay.branch_KeyField=e.branch_KeyField,this.installmentForDisplay.owner_KeyField=e.owner_KeyField,this.installmentForDisplay.build_KeyField=e.build_KeyField,this.installmentForDisplay.unit_KeyField=e.unit_KeyField,this.installmentForDisplay.customer_KeyField=e.customer_KeyField}getInstallmentsPerContract(e,a,o){this._contractService.getInstallmentsPerContract(e,a,o).subscribe(n=>{this.contractInstallmentsArray=n},n=>{this.snackBar.open(this.errorRetrieveMsg,"\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}remove(e){this.dialog.open(P.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(o=>{o&&this._contractService.deleteInstallment(e).subscribe(()=>{this.snackBar.open(this.deletedMsg,"\xd7",{panelClass:"success",verticalPosition:"top",duration:3e3}),this.getInstallmentsPerContract(this.curCOMId,this.account.periorty,e)})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(e=>{this.errorRetrieveMsg=e}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(e=>{this.askToDeletedMsg=e}),this.translateService.get("MESSAGE.DELETED").subscribe(e=>{this.deletedMsg=e}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(e=>{this.deletedTitleMsg=e})}}Q.\u0275fac=function(e){return new(e||Q)(t.Y36(b.C),t.Y36(F.U),t.Y36(T.F0),t.Y36(T.gz),t.Y36(tt.W),t.Y36(U.ux),t.Y36(f.sK),t.Y36(s.qu),t.Y36(m.uw),t.Y36(k.d))},Q.\u0275cmp=t.Xpm({type:Q,selectors:[["app-installment"]],decls:34,vars:27,consts:[[1,"p-2"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","warn","class","mx-1",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"matTooltip","click"],["mat-mini-fab","","color","warn",1,"mx-1",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100"],[1,"p-0","text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"mat-card")(2,"div",1)(3,"h2"),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.YNc(6,Xe,3,3,"button",2),t.qZA(),t._UZ(7,"mat-divider"),t.TgZ(8,"div",3)(9,"div",4)(10,"div",5)(11,"h2"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"div",5)(15,"h2"),t._uU(16),t.ALo(17,"translate"),t.qZA()(),t.TgZ(18,"div",5)(19,"h2"),t._uU(20),t.ALo(21,"translate"),t.qZA()(),t.TgZ(22,"div",5)(23,"h2"),t._uU(24),t.ALo(25,"translate"),t.qZA()(),t.TgZ(26,"div",5)(27,"h2"),t._uU(28),t.ALo(29,"translate"),t.qZA()(),t._UZ(30,"div",5),t.qZA(),t.YNc(31,ea,16,10,"div",6),t.ALo(32,"paginate"),t.qZA()(),t.YNc(33,aa,4,0,"div",7),t.qZA()),2&e&&(t.xp6(4),t.Oqu(t.lcZ(5,9,"BTN.INSTALLMENT")),t.xp6(2),t.Q6J("ngIf",a.can("add_installment")),t.xp6(6),t.hij(" ",t.lcZ(13,11,"HTML.CODE")," "),t.xp6(4),t.hij(" ",t.lcZ(17,13,"HTML.InstallmentValue")," "),t.xp6(4),t.hij(" ",t.lcZ(21,15,"HTML.DueDate")," "),t.xp6(4),t.hij(" ",t.lcZ(25,17,"HTML.InstallmentStatus")," "),t.xp6(4),t.hij(" ",t.lcZ(29,19,"HTML.PayedValue")," "),t.xp6(3),t.Q6J("ngForOf",t.xi3(32,21,a.contractInstallmentsArray,t.WLB(24,ia,a.count,a.page))),t.xp6(2),t.Q6J("ngIf",a.contractInstallmentsArray.length>0))},dependencies:[A.LS,c.sg,c.O5,u.xw,u.Wh,u.yH,_.lW,_.nh,K.a8,B.Hw,x.d,z.gM,A._s,c.uU,f.X$],styles:[".user-form[_ngcontent-%COMP%]   .form-field-outer[_ngcontent-%COMP%]{width:480px}.user-form[_ngcontent-%COMP%]   .mat-mdc-radio-button[_ngcontent-%COMP%]{margin-right:12px}"]});var oa=l(6166),na=l(4159),ra=l.n(na);function sa(i,e){if(1&i&&(t.TgZ(0,"div",8)(1,"div",9),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"div",9),t._uU(5),t.qZA(),t.TgZ(6,"div",9),t._uU(7),t.qZA(),t.TgZ(8,"div",9),t._uU(9),t.qZA()()),2&i){const a=e.$implicit;t.xp6(2),t.Oqu(t.xi3(3,4,a.TSTDate,"yyyy-MM-dd")),t.xp6(3),t.Oqu(a.TSTDebitValue),t.xp6(2),t.Oqu(a.TSTCreditValue),t.xp6(2),t.Oqu(a.current_balance_perline)}}function la(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"div",10)(1,"div",11)(2,"mat-card",12)(3,"pagination-controls",13),t.NdJ("pageChange",function(n){t.CHM(a);const r=t.oxw();return t.KtG(r.onPageChanged(n))}),t.qZA()()()()}}const ca=function(i,e){return{itemsPerPage:i,currentPage:e}};class G{constructor(e,a,o,n,r,d,p,g){this.localStore=e,this.global=a,this.router=o,this.activatedRoute=n,this.tenantsService=r,this.snackBar=d,this.translateService=p,this.appSettings=g,this.tenantStatementArray=[],this.count=6,this.curCOMId=S.N.comid,this.account=new R.n,this.settings=this.appSettings.settings}ngOnInit(){this.userSUb=this.global.user.subscribe(e=>{this.account=e}),this.localStore.getItem("token")&&this.localStore.getItem("account")?(this.global.me=JSON.parse(this.localStore.getItem("account")),this.prepareMsgLanguage(),this.sub=this.activatedRoute.params.subscribe(e=>{e.id&&(this.id=+e.id,this.getStatementsPerCustomer(this.curCOMId,this.account.periorty,this.id))})):this.router.navigate(["/sign-in"])}downloadPDF(){var e=document.getElementById("contentToConvert");ra()(e).then(a=>{var r=208*a.height/a.width;const p=a.toDataURL("image/png");let g=new oa.ZP("p","mm","a4");g.addImage(p,"PNG",0,0,208,r),g.save("MYPdf.pdf")})}onPageChanged(e){this.page=e,window.scrollTo(0,0)}getStatementsPerCustomer(e,a,o){this.tenantsService.getStatementsPerCustomers(e,a,o).subscribe(n=>{this.tenantStatementArray=n},n=>{this.snackBar.open(this.errorRetrieveMsg,"\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(e=>{this.errorRetrieveMsg=e})}}G.\u0275fac=function(e){return new(e||G)(t.Y36(b.C),t.Y36(F.U),t.Y36(T.F0),t.Y36(T.gz),t.Y36(L.v),t.Y36(U.ux),t.Y36(f.sK),t.Y36(k.d))},G.\u0275cmp=t.Xpm({type:G,selectors:[["app-tenant-statements"]],decls:32,vars:26,consts:[[1,"p-2"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],["mat-raised-button","","color","primary",3,"click"],["id","contentToConvert",1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],["fxLayout","row wrap"],["fxFlex","100"],[1,"p-0","text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"mat-card")(2,"div",1)(3,"h2"),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){return a.downloadPDF()}),t._uU(7),t.ALo(8,"translate"),t.qZA()(),t._UZ(9,"mat-divider"),t.TgZ(10,"div",3)(11,"div",4)(12,"div",5)(13,"h2"),t._uU(14),t.ALo(15,"translate"),t.qZA()(),t.TgZ(16,"div",5)(17,"h2"),t._uU(18),t.ALo(19,"translate"),t.qZA()(),t.TgZ(20,"div",5)(21,"h2"),t._uU(22),t.ALo(23,"translate"),t.qZA()(),t.TgZ(24,"div",5)(25,"h2"),t._uU(26),t.ALo(27,"translate"),t.qZA()(),t._UZ(28,"div",5),t.qZA(),t.YNc(29,sa,10,7,"div",6),t.ALo(30,"paginate"),t.qZA()(),t.YNc(31,la,4,0,"div",7),t.qZA()),2&e&&(t.xp6(4),t.Oqu(t.lcZ(5,8,"BTN.Statements")),t.xp6(3),t.Oqu(t.lcZ(8,10,"BTN.DownloadPDF")),t.xp6(7),t.hij(" ",t.lcZ(15,12,"HTML.Date")," "),t.xp6(4),t.hij(" ",t.lcZ(19,14,"HTML.Debit")," "),t.xp6(4),t.hij(" ",t.lcZ(23,16,"HTML.Credit")," "),t.xp6(4),t.hij(" ",t.lcZ(27,18,"HTML.Balance")," "),t.xp6(3),t.Q6J("ngForOf",t.xi3(30,20,a.tenantStatementArray,t.WLB(23,ca,a.count,a.page))),t.xp6(2),t.Q6J("ngIf",a.tenantStatementArray.length>0))},dependencies:[A.LS,c.sg,c.O5,u.xw,u.Wh,u.yH,_.lW,K.a8,x.d,A._s,c.uU,f.X$],styles:[".user-form[_ngcontent-%COMP%]   .form-field-outer[_ngcontent-%COMP%]{width:480px}.user-form[_ngcontent-%COMP%]   .mat-mdc-radio-button[_ngcontent-%COMP%]{margin-right:12px}"]});const pt=[{path:"",redirectTo:"tenant-list",pathMatch:"full"},{path:"tenant-list",component:H,data:{breadcrumb:"Tenants"}},{path:"tenant-add",component:M,data:{breadcrumb:"AddTenant"}},{path:"tenant-add/:id",component:M,data:{breadcrumb:"EditTenant"}},{path:"contract-list",component:J,data:{breadcrumb:"RentContracts"}},{path:"contract-add",component:I,data:{breadcrumb:"AddContract"}},{path:"contract-add/:id",component:I,data:{breadcrumb:"EditContract"}},{path:"contract-add/renew/:id",component:I,data:{breadcrumb:"RenewContract",parentID:"T"}},{path:"installment-list/:id",component:Q,data:{breadcrumb:"ContractInstallments"}},{path:"statements-list/:id",component:G,data:{breadcrumb:"TenantStatements"}}];class q{}q.\u0275fac=function(e){return new(e||q)},q.\u0275mod=t.oAB({type:q}),q.\u0275inj=t.cJS({imports:[Te.JF,s.u5,A.JX,ve.D,c.ez,T.Bz.forChild(pt),s.UX,Ze.m,A.JX,je.kz,it.Y$,ot.A0]})}}]);