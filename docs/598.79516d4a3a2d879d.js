"use strict";(self.webpackChunkemporium=self.webpackChunkemporium||[]).push([[598],{3598:(j,A,a)=>{a.r(A),a.d(A,{BankDepositModule:()=>v,routes:()=>V});var m=a(6895),p=a(9132),l=a(5783),Z=a(8910),D=a(2887),N=a(4459),t=a(4650),K=a(7298),O=a(1182),P=a(5412),q=a(7465),H=a(5298),G=a(4165),W=a(8959),B=a(3081),I=a(7009),r=a(4006),b=a(4859),w=a(7392),S=a(4144),h=a(9549),E=a(1572),J=a(266),M=a(811),k=a(1576),$=a(3546),X=a(4850),L=a(4333),z=a(1419);function tt(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"mat-button-toggle",21),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.gotoNewDocument())}),t.TgZ(1,"mat-icon"),t._uU(2,"note_add"),t.qZA()()}}const et=function(n){return["/payments/receivable-add/",n]};function ot(n,e){if(1&n&&(t.TgZ(0,"a",27),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()()),2&n){const o=t.oxw().$implicit;t.s9C("matTooltip",t.lcZ(1,2,"BTN.VIEW")),t.Q6J("routerLink",t.VKq(4,et,o.id))}}function nt(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(o);const s=t.oxw().$implicit,u=t.oxw();return t.KtG(u.removeDocument(s.id))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()}2&n&&t.s9C("matTooltip",t.lcZ(1,1,"BTN.REMOVE"))}function it(n,e){if(1&n&&(t.TgZ(0,"div",22)(1,"div",23),t._uU(2),t._UZ(3,"br"),t._uU(4),t.qZA(),t.TgZ(5,"div",23),t._uU(6),t.qZA(),t.TgZ(7,"div",23),t._uU(8),t.qZA(),t.TgZ(9,"div",23),t._uU(10),t.qZA(),t.TgZ(11,"div",23),t._uU(12),t.qZA(),t.TgZ(13,"div",23),t._uU(14),t.qZA(),t.TgZ(15,"div",23),t._uU(16),t.qZA(),t.TgZ(17,"div",23),t._uU(18),t.qZA(),t.TgZ(19,"div",23)(20,"div",24),t.YNc(21,ot,4,6,"a",25),t.YNc(22,nt,4,3,"button",26),t.qZA()()()),2&n){const o=e.$implicit,i=t.oxw();t.Tol(i.statusColor[o.PDOValueInAccount]),t.xp6(2),t.Oqu(o.build_Name),t.xp6(2),t.Oqu(o.branch_ArbName),t.xp6(2),t.Oqu(o.unit_UnitNumber),t.xp6(2),t.hij(" ",o.customer_Name," "),t.xp6(2),t.hij(" ",o.PDODocDate," "),t.xp6(2),t.hij(" ",o.PDOValue," "),t.xp6(2),t.hij(" ",o.PDOPrintedCode," "),t.xp6(2),t.hij(" ",o.PDODocClassTypeDisplay," "),t.xp6(2),t.hij(" ",o.PDOEjarCode," "),t.xp6(3),t.Q6J("ngIf",i.can("view_onereceivable")),t.xp6(1),t.Q6J("ngIf",i.can("delete_onereceivable"))}}function at(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"div",29)(1,"div",30)(2,"mat-card",31)(3,"pagination-controls",32),t.NdJ("pageChange",function(s){t.CHM(o);const u=t.oxw();return t.KtG(u.onPageChanged(s))}),t.qZA()()()()}}function st(n,e){1&n&&(t.TgZ(0,"div",33),t._UZ(1,"mat-spinner",34),t.qZA())}const rt=function(n,e){return{itemsPerPage:n,currentPage:e}};class _{constructor(e,o,i,s,u,g,c,C,U,y,F){this.transferService=e,this.appSettings=o,this.dialog=i,this.paymentService=s,this.router=u,this.global=g,this.localStore=c,this.settingService=C,this.contractService=U,this.translateService=y,this.snackBar=F,this.statusColor={T:"make-white",F:"make-gold"},this.account=new l.n,this.count=4,this.userPerm=[],this.editReceivableDocCodeStatus=(new N.$).getEditReceivableDocCodeStatus(),this.editCode=!0,this.settings=this.appSettings.settings}ngOnDestroy(){this.userSUb&&this.userSUb.unsubscribe()}ngOnInit(){if(this.securityForApp=(new N.$).getSecurityType(),this.userSUb=this.global.user.subscribe(e=>{this.account=e}),this.localStore.getItem("token")&&this.localStore.getItem("account")){this.curUserData=JSON.parse(this.localStore.getItem("account")),this.curCOMId=this.curUserData.COMId,this.appSetup=JSON.parse(this.localStore.getItem("appsetup")),this.recievableVoucherWithoutInvoice=this.appSetup.APSRecievableVoucherWithoutInvoice,this.curUserPermissions=JSON.parse(this.localStore.getItem("permissions"));for(let e=0;e<this.curUserPermissions.length;e++)this.userPerm[e]=this.curUserPermissions[e].codename;this.getParamValue(this.curCOMId,this.account.periorty,this.editReceivableDocCodeStatus),this.prepareMsgLanguage(),this.getDocuments()}}getParamValue(e,o,i){this.settingService.getValueForCode(e,o,i).subscribe(s=>{i==this.editReceivableDocCodeStatus&&(this.editReceivableDocCodeValue=s[0].APAValue)},s=>{this.snackBar.open("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u062e\u064a\u0627\u0631\u0627\u062a \u0627\u0644\u0646\u0638\u0627\u0645","\xd7",{panelClass:"error",verticalPosition:"top",duration:3e3})})}can(e){return!(!this.curUserData.is_superuser&&!this.userPerm.includes(e))}getDocuments(){this.documentsAll=null,this.curUserData.is_superuser?this.paymentService.getAllReceivableDocuments(this.curCOMId,this.account.periorty).subscribe(e=>this.documentsAll=e):1==this.curUserData.periorty&&("N"==this.securityForApp&&this.paymentService.getAllReceivableDocumentsPerBranch(this.curCOMId,this.account.periorty,this.curUserData.branch_KeyField).subscribe(e=>this.documentsAll=e),"D"==this.securityForApp&&this.paymentService.getAllReceivableDocumentsPerEmp(this.curCOMId,this.account.periorty,this.curUserData.id).subscribe(e=>this.documentsAll=e))}removeDocument(e){this.dialog.open(D.$,{maxWidth:"400px",data:{title:this.deletedTitleMsg,message:this.askToDeletedMsg}}).afterClosed().subscribe(i=>{i&&(this.paymentService.getOneDocs(e).subscribe(s=>{null!=s.installment_KeyField&&(this.oneDocValue=s.PDOValue,this.contractService.getOneInstallment(s.installment_KeyField).subscribe(u=>{this.curInstallmentValue=u.INSValue,this.curInstallmentPayedValue=u.INSPayedValue,null==this.curInstallmentValue&&(this.curInstallmentValue=0),null==this.curInstallmentPayedValue&&(this.curInstallmentPayedValue=0),this.manageInstallmetPayedValue(s.installment_KeyField,this.curInstallmentValue,this.curInstallmentPayedValue,this.oneDocValue)}))}),this.paymentService.deleteDocument(e).subscribe(s=>this.getDocuments()))})}manageInstallmetPayedValue(e,o,i,s){null==i&&(i=0),null==s&&(s=0),null==o&&(o=0);let u=+i-+s;u<=0&&(u=0),this.insStatus=0==u?"N":"T";let g={id:e,INSStatus:this.insStatus,INSPayedValue:u};console.log("===installData:: "+g),this.contractService.editInstallments(g).subscribe(c=>{console.log("==installment after Update:: "+c)},c=>{console.log(c)})}onPageChanged(e){this.page=e,this.getDocuments(),window.scrollTo(0,0)}gotoNewDocument(){this.transferService.setMessage({editReceivableDocCode:this.editReceivableDocCodeValue}),this.router.navigate(["/payments/receivable-add/"])}prepareMsgLanguage(){this.translateService.get("MESSAGE.RETRIEVE_ERROR").subscribe(e=>{this.errorRetrieveMsg=e}),this.translateService.get("MESSAGE.SURE_DELETE").subscribe(e=>{this.askToDeletedMsg=e}),this.translateService.get("MESSAGE.DELETED").subscribe(e=>{this.deletedMsg=e}),this.translateService.get("MESSAGE.ConfirmAction").subscribe(e=>{this.deletedTitleMsg=e})}}_.\u0275fac=function(e){return new(e||_)(t.Y36(K.y),t.Y36(O.d),t.Y36(P.uw),t.Y36(Z.c),t.Y36(p.F0),t.Y36(q.U),t.Y36(H.C),t.Y36(G.g),t.Y36(W.W),t.Y36(B.sK),t.Y36(I.ux))},_.\u0275cmp=t.Xpm({type:_,selectors:[["app-bank-deposit-list"]],features:[t._Bn([Z.c])],decls:68,vars:46,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"p-2"],["fxLayout","row"],["appearance","legacy"],["controls","matButtonToggleGroup"],["value","add",3,"click",4,"ngIf"],["value","search"],[1,"user-search"],[1,"user-search-input"],["matInput","","name","search","autocomplete","off",3,"placeholder","ngModel","ngModelChange"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","legacy","value","list"],["viewType","matButtonToggleGroup"],["value","list"],["value","grid"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-3"],[1,"mat-mdc-table","admin-table"],[1,"mat-mdc-header-row"],[1,"mat-mdc-header-cell"],["class","mat-mdc-row",3,"class",4,"ngFor","ngForOf"],["fxLayout","row wrap",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","class","user-spinner",4,"ngIf"],["value","add",3,"click"],[1,"mat-mdc-row"],[1,"mat-mdc-cell"],[1,"p-2","actions"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip",4,"ngIf"],["mat-mini-fab","","color","warn",3,"matTooltip","click",4,"ngIf"],["mat-mini-fab","","color","primary",3,"routerLink","matTooltip"],["mat-mini-fab","","color","warn",3,"matTooltip","click"],["fxLayout","row wrap"],["fxFlex","100",1,"p-2"],[1,"text-center"],["autoHide","true","maxSize","5",1,"product-pagination",3,"pageChange"],["fxLayout","column","fxLayoutAlign","center center",1,"user-spinner"],["color","primary"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-button-toggle-group",2,3),t.YNc(4,tt,3,0,"mat-button-toggle",4),t.TgZ(5,"mat-button-toggle",5)(6,"mat-icon"),t._uU(7,"search"),t.qZA()()()(),t.TgZ(8,"form",6)(9,"mat-form-field",7)(10,"input",8),t.NdJ("ngModelChange",function(s){return o.searchText=s}),t.ALo(11,"translate"),t.qZA()()(),t.TgZ(12,"div",9)(13,"mat-button-toggle-group",10,11)(15,"mat-button-toggle",12)(16,"mat-icon"),t._uU(17,"view_list"),t.qZA()(),t.TgZ(18,"mat-button-toggle",13)(19,"mat-icon"),t._uU(20,"view_module"),t.qZA()()()()(),t._UZ(21,"mat-divider"),t.TgZ(22,"mat-card")(23,"div",14)(24,"h2"),t._uU(25),t.ALo(26,"translate"),t.qZA()(),t._UZ(27,"mat-divider"),t.TgZ(28,"div",15)(29,"div",16)(30,"div",17)(31,"h3"),t._uU(32),t.ALo(33,"translate"),t.qZA()(),t.TgZ(34,"div",17)(35,"h3"),t._uU(36),t.ALo(37,"translate"),t.qZA()(),t.TgZ(38,"div",17)(39,"h3"),t._uU(40),t.ALo(41,"translate"),t.qZA()(),t.TgZ(42,"div",17)(43,"h3"),t._uU(44),t.ALo(45,"translate"),t.qZA()(),t.TgZ(46,"div",17)(47,"h3"),t._uU(48),t.ALo(49,"translate"),t.qZA()(),t.TgZ(50,"div",17)(51,"h3"),t._uU(52),t.ALo(53,"translate"),t.qZA()(),t.TgZ(54,"div",17)(55,"h3"),t._uU(56),t.ALo(57,"translate"),t.qZA()(),t.TgZ(58,"div",17)(59,"h3"),t._uU(60),t.ALo(61,"translate"),t.qZA()(),t._UZ(62,"div",17),t.qZA(),t.YNc(63,it,23,13,"div",18),t.ALo(64,"paginate"),t.ALo(65,"PayDocumentsSearchPipe"),t.qZA()(),t.YNc(66,at,4,0,"div",19),t.YNc(67,st,2,0,"div",20)),2&e){const i=t.MAs(3);t.xp6(4),t.Q6J("ngIf",o.can("add_onereceivable")),t.xp6(4),t.ekj("show","search"==i.value),t.xp6(2),t.s9C("placeholder",t.lcZ(11,17,"HTML.SEARCH_PayDocument")),t.Q6J("ngModel",o.searchText),t.xp6(15),t.Oqu(t.lcZ(26,19,"HTML.ReceivableDoc_List")),t.xp6(7),t.hij(" ",t.lcZ(33,21,"HTML.BUILDING")," "),t.xp6(4),t.hij(" ",t.lcZ(37,23,"HTML.UnitNumber")," "),t.xp6(4),t.hij(" ",t.lcZ(41,25,"HTML.TENANT")," "),t.xp6(4),t.hij(" ",t.lcZ(45,27,"HTML.DocDate")," "),t.xp6(4),t.hij(" ",t.lcZ(49,29,"HTML.DocValue")," "),t.xp6(4),t.hij(" ",t.lcZ(53,31,"HTML.DocPrintedNo")," "),t.xp6(4),t.hij(" ",t.lcZ(57,33,"HTML.DocClassType")," "),t.xp6(4),t.hij(" ",t.lcZ(61,35,"HTML.PayDocEjarCode")," "),t.xp6(3),t.Q6J("ngForOf",t.xi3(64,37,t.xi3(65,40,o.documentsAll,o.searchText),t.WLB(43,rt,o.count,o.page))),t.xp6(3),t.Q6J("ngIf",o.documentsAll),t.xp6(1),t.Q6J("ngIf",!o.documentsAll)}},dependencies:[m.sg,m.O5,p.rH,r._Y,r.Fj,r.JJ,r.JL,r.On,r.F,b.Tq,b.nh,w.Hw,S.Nt,h.KE,E.Ou,J.gM,M.A9,M.Yi,k.xw,k.Wh,k.yH,$.a8,X.d,L.LS,B.X$,z.dg,L._s],styles:[".user-name{padding:0 12px;font-weight:400}.user-content{padding:10px}.user-content .user-img{position:relative}.user-content .user-img img{border-radius:50%;width:80px;height:80px}.user-content .user-img img.blocked{opacity:.5}.user-content .user-img .mat-icon{position:absolute;top:-8px;left:-8px;font-size:96px;height:96px;width:96px}.user-content .mat-mdc-slide-toggle{margin-top:15px}.user-content .user-details span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.user-content .user-details .mat-icon{padding:2px 10px}.user-content .user-details.blocked{opacity:.5}.user-search{flex:1;width:0;overflow:hidden;transition:.3s}.user-search .mat-mdc-form-field{width:100%!important;text-align:center!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-infix{min-height:36px;padding:8px 0!important}.user-search .mat-mdc-form-field .mat-mdc-form-field-subscript-wrapper{display:none}.user-search .mat-mdc-input-element{text-align:center}.user-search.show{width:100%;overflow:visible}.user-search.show{flex:1;overflow:visible}.user-spinner{position:absolute;inset:0}.mat-mdc-card{overflow:hidden}table{width:100%}.make-gold{background-color:#fbea96}.make-white{background-color:#fff}\n"],encapsulation:2});var x=a(529),ut=a(5521);class f{constructor(e,o,i){this.appSettings=e,this.http=o,this.globalServ=i,this.baseUrl=this.appSettings.settings.url,this.secondPartUrl=new ut.P(this.baseUrl).api_constant}getAllDeposits(e,o=0){let i=(new x.LE).set("M",e.toString()).set("C",o.toString());return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/bankDeposit/allBankDeposits/",{params:i})}getDepositsByFilters(e){let o=(new x.LE).set("M",e.companyId.toString()).set("C",e.confirm?e.confirm.toString():"0");return e.branch&&(o=o.set("br",e.branch)),e.owner&&(o=o.set("owner",e.owner)),e.bankAccount&&(o=o.set("account",e.bankAccount)),e.depositedBy&&(o=o.set("by",e.depositedBy)),e.status&&(o=o.set("status",e.status)),this.http.get(this.baseUrl+this.secondPartUrl+"contracts/bankDeposit/BankDepositPerSpec/",{params:o})}getDepositById(e){return this.http.get(this.baseUrl+this.secondPartUrl+"contracts/bankDeposit/"+e+"/")}createDeposit(e){return this.http.post(this.baseUrl+this.secondPartUrl+"contracts/bankDeposit/",e)}updateDeposit(e,o){return this.http.put(this.baseUrl+this.secondPartUrl+"contracts/bankDeposit/"+e+"/",o)}deleteDeposit(e){return this.http.delete(this.baseUrl+this.secondPartUrl+"contracts/bankDeposit/"+e+"/")}}f.\u0275fac=function(e){return new(e||f)(t.LFG(O.d),t.LFG(x.eN),t.LFG(q.U))},f.\u0275prov=t.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"});var Y=a(4385),Q=a(3238),T=a(9602);function lt(n,e){if(1&n&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&n){const o=e.$implicit;t.Q6J("value",o.id),t.xp6(1),t.hij(" ",o.name," ")}}function ct(n,e){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," \u0627\u0644\u0641\u0631\u0639 \u0645\u0637\u0644\u0648\u0628 "),t.qZA())}function mt(n,e){if(1&n&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&n){const o=e.$implicit;t.Q6J("value",o.id),t.xp6(1),t.hij(" ",o.name," ")}}function pt(n,e){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," \u0627\u0644\u0645\u0627\u0644\u0643 \u0645\u0637\u0644\u0648\u0628 "),t.qZA())}function dt(n,e){if(1&n&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&n){const o=e.$implicit;t.Q6J("value",o.id),t.xp6(1),t.AsE(" ",o.BACAccountNumber," - ",o.BACIBan," ")}}function gt(n,e){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," \u0627\u0644\u062d\u0633\u0627\u0628 \u0627\u0644\u0628\u0646\u0643\u064a \u0645\u0637\u0644\u0648\u0628 "),t.qZA())}function ht(n,e){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," \u0627\u0644\u062a\u0627\u0631\u064a\u062e \u0645\u0637\u0644\u0648\u0628 "),t.qZA())}function ft(n,e){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," \u0627\u0644\u0645\u0628\u0644\u063a \u0645\u0637\u0644\u0648\u0628 "),t.qZA())}function vt(n,e){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," \u0627\u0644\u0645\u0628\u0644\u063a \u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0623\u0643\u0628\u0631 \u0645\u0646 \u0635\u0641\u0631 "),t.qZA())}function Dt(n,e){if(1&n&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&n){const o=e.$implicit;t.Q6J("value",o.id),t.xp6(1),t.lnq(" ",o.username," - ",o.first_name," ",o.last_name," ")}}function _t(n,e){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," \u0627\u0644\u0645\u0648\u062f\u0639 \u0645\u0637\u0644\u0648\u0628 "),t.qZA())}function At(n,e){if(1&n&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&n){const o=e.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ",o.label," ")}}function Zt(n,e){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," \u0627\u0644\u062d\u0627\u0644\u0629 \u0645\u0637\u0644\u0648\u0628\u0629 "),t.qZA())}function bt(n,e){1&n&&(t.TgZ(0,"small"),t._uU(1,"\u0645\u0644\u0641 \u0645\u0631\u0641\u0642"),t.qZA())}function xt(n,e){1&n&&t._UZ(0,"mat-spinner",27)}function Tt(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"form",4),t.NdJ("ngSubmit",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.onSubmit())}),t.TgZ(1,"div",5)(2,"mat-form-field")(3,"mat-label"),t._uU(4,"\u0627\u0644\u0641\u0631\u0639 *"),t.qZA(),t.TgZ(5,"mat-select",6),t.YNc(6,lt,2,2,"mat-option",7),t.qZA(),t.YNc(7,ct,2,0,"mat-error",8),t.qZA(),t.TgZ(8,"mat-form-field")(9,"mat-label"),t._uU(10,"\u0627\u0644\u0645\u0627\u0644\u0643 *"),t.qZA(),t.TgZ(11,"mat-select",9),t.YNc(12,mt,2,2,"mat-option",7),t.qZA(),t.YNc(13,pt,2,0,"mat-error",8),t.qZA()(),t.TgZ(14,"div",5)(15,"mat-form-field")(16,"mat-label"),t._uU(17,"\u0627\u0644\u062d\u0633\u0627\u0628 \u0627\u0644\u0628\u0646\u0643\u064a *"),t.qZA(),t.TgZ(18,"mat-select",10),t.YNc(19,dt,2,3,"mat-option",7),t.qZA(),t.YNc(20,gt,2,0,"mat-error",8),t.qZA(),t.TgZ(21,"mat-form-field")(22,"mat-label"),t._uU(23,"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0625\u064a\u062f\u0627\u0639 *"),t.qZA(),t._UZ(24,"input",11)(25,"mat-datepicker-toggle",12)(26,"mat-datepicker",null,13),t.YNc(28,ht,2,0,"mat-error",8),t.qZA()(),t.TgZ(29,"div",5)(30,"mat-form-field")(31,"mat-label"),t._uU(32,"\u0631\u0642\u0645 \u0627\u0644\u0645\u0631\u062c\u0639 \u0627\u0644\u0628\u0646\u0643\u064a"),t.qZA(),t._UZ(33,"input",14),t.qZA(),t.TgZ(34,"mat-form-field")(35,"mat-label"),t._uU(36,"\u0627\u0644\u0645\u0628\u0644\u063a *"),t.qZA(),t._UZ(37,"input",15),t.YNc(38,ft,2,0,"mat-error",8),t.YNc(39,vt,2,0,"mat-error",8),t.qZA()(),t.TgZ(40,"div",5)(41,"mat-form-field")(42,"mat-label"),t._uU(43,"\u0627\u0644\u0645\u0648\u062f\u0639 *"),t.qZA(),t.TgZ(44,"mat-select",16),t.YNc(45,Dt,2,4,"mat-option",7),t.qZA(),t.YNc(46,_t,2,0,"mat-error",8),t.qZA(),t.TgZ(47,"mat-form-field")(48,"mat-label"),t._uU(49,"\u0627\u0644\u062d\u0627\u0644\u0629 *"),t.qZA(),t.TgZ(50,"mat-select",17),t.YNc(51,At,2,2,"mat-option",7),t.qZA(),t.YNc(52,Zt,2,0,"mat-error",8),t.qZA()(),t.TgZ(53,"mat-form-field",18)(54,"mat-label"),t._uU(55,"\u0645\u0644\u0627\u062d\u0638\u0627\u062a"),t.qZA(),t._UZ(56,"textarea",19),t.qZA(),t.TgZ(57,"div",5)(58,"div",20)(59,"label"),t._uU(60,"\u0635\u0648\u0631\u0629 \u0642\u0633\u064a\u0645\u0629 \u0627\u0644\u0625\u064a\u062f\u0627\u0639 (\u0625\u0644\u0632\u0627\u0645\u064a\u0629)"),t.qZA(),t.TgZ(61,"input",21),t.NdJ("change",function(s){t.CHM(o);const u=t.oxw();return t.KtG(u.onFileChange(s))}),t.qZA(),t.YNc(62,bt,2,0,"small",8),t.qZA()(),t.TgZ(63,"div",22)(64,"button",23),t.YNc(65,xt,1,0,"mat-spinner",24),t._uU(66),t.qZA(),t.TgZ(67,"button",25),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.onCancel())}),t._uU(68,"\u0625\u0644\u063a\u0627\u0621"),t.qZA()()()}if(2&n){const o=t.MAs(27),i=t.oxw();let s,u,g,c,C,U,y,F,R;t.Q6J("formGroup",i.depositForm),t.xp6(6),t.Q6J("ngForOf",i.branches),t.xp6(1),t.Q6J("ngIf",null==(s=i.depositForm.get("branch_KeyField"))?null:s.hasError("required")),t.xp6(5),t.Q6J("ngForOf",i.owners),t.xp6(1),t.Q6J("ngIf",null==(u=i.depositForm.get("owner_KeyField"))?null:u.hasError("required")),t.xp6(6),t.Q6J("ngForOf",i.bankAccounts),t.xp6(1),t.Q6J("ngIf",null==(g=i.depositForm.get("bank_account"))?null:g.hasError("required")),t.xp6(4),t.Q6J("matDatepicker",o),t.xp6(1),t.Q6J("for",o),t.xp6(3),t.Q6J("ngIf",null==(c=i.depositForm.get("BDEDepositDate"))?null:c.hasError("required")),t.xp6(10),t.Q6J("ngIf",null==(C=i.depositForm.get("BDEDepositAmount"))?null:C.hasError("required")),t.xp6(1),t.Q6J("ngIf",null==(U=i.depositForm.get("BDEDepositAmount"))?null:U.hasError("min")),t.xp6(6),t.Q6J("ngForOf",i.employees),t.xp6(1),t.Q6J("ngIf",null==(y=i.depositForm.get("BDEDepositedBy"))?null:y.hasError("required")),t.xp6(5),t.Q6J("ngForOf",i.statusOptions),t.xp6(1),t.Q6J("ngIf",null==(F=i.depositForm.get("BDEStatus"))?null:F.hasError("required")),t.xp6(10),t.Q6J("ngIf",null==(R=i.depositForm.get("BDEDepositImage"))?null:R.value),t.xp6(2),t.Q6J("disabled",i.submitting),t.xp6(1),t.Q6J("ngIf",i.submitting),t.xp6(1),t.hij(" ",i.isEditMode?"\u062a\u062d\u062f\u064a\u062b":"\u062d\u0641\u0638"," ")}}function Ct(n,e){1&n&&(t.TgZ(0,"div",28),t._UZ(1,"mat-spinner",29),t.TgZ(2,"p"),t._uU(3,"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."),t.qZA()())}class d{constructor(e,o,i,s,u){this.fb=e,this.route=o,this.router=i,this.bankDepositService=s,this.snackBar=u,this.depositId=null,this.isEditMode=!1,this.loading=!1,this.submitting=!1,this.statusOptions=[{value:"N",label:"\u062c\u062f\u064a\u062f"},{value:"C",label:"\u0645\u0643\u062a\u0645\u0644"},{value:"X",label:"\u0645\u0644\u063a\u064a"}],this.branches=[],this.owners=[],this.bankAccounts=[],this.employees=[],this.depositForm=this.fb.group({branch_KeyField:[null,r.kI.required],owner_KeyField:[null,r.kI.required],bank_account:[null,r.kI.required],BDEDepositDate:[null,r.kI.required],BDEBankReferenceNumber:[""],BDEDepositAmount:[null,[r.kI.required,r.kI.min(.01)]],BDEDepositedBy:[null,r.kI.required],BDEStatus:["N",r.kI.required],BDENotes:[""],BDEDepositImage:[null]})}ngOnInit(){this.depositId=Number(this.route.snapshot.paramMap.get("id")),this.isEditMode=this.route.snapshot.url.some(e=>"edit"===e.path),this.depositId&&this.loadDeposit(),this.loadLookupData()}loadDeposit(){this.loading=!0,this.bankDepositService.getDepositById(this.depositId).subscribe({next:e=>{this.depositForm.patchValue(e),this.loading=!1},error:()=>{this.snackBar.open("\u0641\u0634\u0644 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a","\u0625\u063a\u0644\u0627\u0642",{duration:3e3}),this.loading=!1}})}loadLookupData(){}onFileChange(e){e.target.files.length>0&&this.depositForm.patchValue({BDEDepositImage:e.target.files[0]})}onSubmit(){if(this.depositForm.invalid)return void this.snackBar.open("\u064a\u0631\u062c\u0649 \u062a\u0635\u062d\u064a\u062d \u0627\u0644\u0623\u062e\u0637\u0627\u0621","\u0625\u063a\u0644\u0627\u0642",{duration:3e3});this.submitting=!0;const e=new FormData;let o;Object.keys(this.depositForm.controls).forEach(i=>{const s=this.depositForm.get(i)?.value;e.append(i,"BDEDepositImage"===i&&s?s:s??"")}),o=this.isEditMode&&this.depositId?this.bankDepositService.updateDeposit(this.depositId,e):this.bankDepositService.createDeposit(e),o.subscribe({next:()=>{this.snackBar.open(this.isEditMode?"\u062a\u0645 \u0627\u0644\u062a\u062d\u062f\u064a\u062b":"\u062a\u0645 \u0627\u0644\u0625\u0636\u0627\u0641\u0629","\u0625\u063a\u0644\u0627\u0642",{duration:2e3}),this.router.navigate(["/bank-deposits"])},error:()=>{this.snackBar.open("\u0641\u0634\u0644 \u0627\u0644\u062d\u0641\u0638","\u0625\u063a\u0644\u0627\u0642",{duration:3e3}),this.submitting=!1}})}onCancel(){this.router.navigate(["/bank-deposits"])}}d.\u0275fac=function(e){return new(e||d)(t.Y36(r.qu),t.Y36(p.gz),t.Y36(p.F0),t.Y36(f),t.Y36(I.ux))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-bank-deposit-form"]],decls:7,vars:3,consts:[[1,"form-container","mat-elevation-z8"],[1,"form-header"],[3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],["loadingTemplate",""],[3,"formGroup","ngSubmit"],[1,"form-row"],["formControlName","branch_KeyField","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","owner_KeyField","required",""],["formControlName","bank_account","required",""],["matInput","","formControlName","BDEDepositDate","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","formControlName","BDEBankReferenceNumber"],["matInput","","type","number","step","0.01","formControlName","BDEDepositAmount","required",""],["formControlName","BDEDepositedBy","required",""],["formControlName","BDEStatus","required",""],[1,"full-width"],["matInput","","formControlName","BDENotes","rows","3"],[1,"file-upload"],["type","file","accept","image/*,.pdf",3,"change"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","20",4,"ngIf"],["mat-stroked-button","","type","button",3,"click"],[3,"value"],["diameter","20"],[1,"loading-center"],["diameter","50"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2"),t._uU(3),t.qZA()(),t.YNc(4,Tt,69,20,"form",2),t.YNc(5,Ct,4,0,"ng-template",null,3,t.W1O),t.qZA()),2&e){const i=t.MAs(6);t.xp6(3),t.Oqu(o.isEditMode?"\u062a\u0639\u062f\u064a\u0644 \u0625\u064a\u062f\u0627\u0639 \u0628\u0646\u0643\u064a":"\u0625\u0636\u0627\u0641\u0629 \u0625\u064a\u062f\u0627\u0639 \u0628\u0646\u0643\u064a \u062c\u062f\u064a\u062f"),t.xp6(1),t.Q6J("ngIf",!o.loading)("ngIfElse",i)}},dependencies:[m.sg,m.O5,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.Q7,r.sg,r.u,b.lW,S.Nt,h.KE,h.hX,h.TO,h.R9,Y.gD,Q.ey,T.Mq,T.hl,T.nW,E.Ou],styles:[".form-container[_ngcontent-%COMP%]{max-width:900px;margin:30px auto;padding:30px}.form-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.form-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#333}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap;margin-bottom:16px}.form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1 1 300px}.full-width[_ngcontent-%COMP%]{width:100%}.file-upload[_ngcontent-%COMP%]{margin-top:16px}.file-upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{margin-top:8px}.file-upload[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:green;display:block;margin-top:4px}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:16px;margin-top:30px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:120px}.loading-center[_ngcontent-%COMP%]{text-align:center;padding:50px}.loading-center[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:20px;font-size:18px;color:#555}"]});var Ut=a(671),yt=a(4508),Ft=a(9045),Bt=a(8796);const V=[{path:"deposit-list",component:_,data:{breadcrumb:"Deposit"}},{path:"new",component:d,data:{breadcrumb:"Deposit-add"}},{path:":id",component:d,data:{breadcrumb:"Deposit-view"}},{path:":id/edit",component:d,data:{breadcrumb:"Deposit-edit"}}];class v{}v.\u0275fac=function(e){return new(e||v)},v.\u0275mod=t.oAB({type:v}),v.\u0275inj=t.cJS({imports:[m.ez,p.Bz.forChild(V),r.u5,r.UX,x.JF,b.ot,w.Ps,S.c,Y.LD,T.FA,Q.XK,Ut.p0,E.Cq,h.lN,J.AV,P.Is,I.ZX,M.vV,B.aw,Ft.D,yt.m,L.JX,Bt.A0]})},7298:(j,A,a)=>{a.d(A,{y:()=>l});var m=a(1135),p=a(4650);class l{constructor(){this.inivalue={},this.msg=new m.X(this.inivalue),this.getMessage=this.msg.asObservable()}setMessage(D){this.msg.next(D)}}l.\u0275fac=function(D){return new(D||l)},l.\u0275prov=p.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}}]);